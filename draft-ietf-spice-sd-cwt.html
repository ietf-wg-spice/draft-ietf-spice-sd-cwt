<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>SPICE SD-CWT</title>
<meta content="Michael Prorock" name="author">
<meta content="Orie Steele" name="author">
<meta content="Henk Birkholz" name="author">
<meta content="Rohan Mahy" name="author">
<meta content="
       This document describes a data minimization technique for use with CBOR Web Token (CWT).
The approach is based on Selective Disclosure JSON Web Token (SD-JWT), with changes to align with CBOR Object Signing and Encryption (COSE). 
    " name="description">
<meta content="xml2rfc 3.24.0" name="generator">
<meta content="cose" name="keyword">
<meta content="cwt" name="keyword">
<meta content="selective disclosure" name="keyword">
<meta content="draft-ietf-spice-sd-cwt-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.24.0
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-spice-sd-cwt.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SPICE SD-CWT</td>
<td class="right">November 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Prorock, et al.</td>
<td class="center">Expires 23 May 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Secure Patterns for Internet CrEdentials</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-spice-sd-cwt-latest</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfcRFC8392" class="eref">RFC8392</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-11-19" class="published">19 November 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-05-23">23 May 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Prorock</div>
<div class="org">mesur.io</div>
</div>
<div class="author">
      <div class="author-name">O. Steele</div>
<div class="org">Transmute</div>
</div>
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">R. Mahy</div>
<div class="org">Rohan Mahy Consulting Services</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">SPICE SD-CWT</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a data minimization technique for use with CBOR Web Token (CWT).
The approach is based on Selective Disclosure JSON Web Token (SD-JWT), with changes to align with CBOR Object Signing and Encryption (COSE).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://ietf-wg-spice.github.io/draft-ietf-spice-sd-cwt/draft-ietf-spice-sd-cwt.html">https://ietf-wg-spice.github.io/draft-ietf-spice-sd-cwt/draft-ietf-spice-sd-cwt.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-spice-sd-cwt/">https://datatracker.ietf.org/doc/draft-ietf-spice-sd-cwt/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Secure Patterns for Internet CrEdentials Working Group mailing list (<span><a href="mailto:spice@ietf.org">mailto:spice@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/spice/">https://mailarchive.ietf.org/arch/browse/spice/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/spice/">https://www.ietf.org/mailman/listinfo/spice/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ietf-wg-spice/draft-ietf-spice-sd-cwt">https://github.com/ietf-wg-spice/draft-ietf-spice-sd-cwt</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 23 May 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-high-level-flow" class="internal xref">High level flow</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-overview-of-selective-discl" class="internal xref">Overview of Selective Disclosure CWT</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-a-cwt-without-selective-dis" class="internal xref">A CWT without Selective Disclosure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-holder-gets-an-sd-cwt-from-" class="internal xref">Holder gets an SD-CWT from the Issuer</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-holder-prepares-an-sd-cwt-f" class="internal xref">Holder prepares an SD-CWT for a Verifier</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-sd-cwt-definition" class="internal xref">SD-CWT definition</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-types-of-blinded-claims" class="internal xref">Types of blinded claims</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-sd-cwt-issuance" class="internal xref">SD-CWT Issuance</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-issuer-generation" class="internal xref">Issuer generation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-holder-validation" class="internal xref">Holder validation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-sd-cwt-presentation" class="internal xref">SD-CWT Presentation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-creating-a-key-binding-toke" class="internal xref">Creating a Key Binding Token</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-sd-cwt-validation" class="internal xref">SD-CWT Validation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-decoy-digests" class="internal xref">Decoy Digests</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-credential-types" class="internal xref">Credential Types</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-minimal-spanning-example" class="internal xref">Minimal spanning example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-nested-example" class="internal xref">Nested example</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-transmute-prototype" class="internal xref">Transmute Prototype</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-random-numbers" class="internal xref">Random Numbers</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-cose-header-parameters" class="internal xref">COSE Header Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1.2.1">
                    <p id="section-toc.1-1.14.2.1.2.1.1"><a href="#section-14.1.1" class="auto internal xref">14.1.1</a>.  <a href="#name-sd_claims" class="internal xref">sd_claims</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1.2.2">
                    <p id="section-toc.1-1.14.2.1.2.2.1"><a href="#section-14.1.2" class="auto internal xref">14.1.2</a>.  <a href="#name-sd_kbt" class="internal xref">sd_kbt</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-cbor-tags" class="internal xref">CBOR Tags</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.1">
                    <p id="section-toc.1-1.14.2.2.2.1.1"><a href="#section-14.2.1" class="auto internal xref">14.2.1</a>.  <a href="#name-redacted-claim-element-tag" class="internal xref">Redacted claim element tag</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.2">
                    <p id="section-toc.1-1.14.2.2.2.2.1"><a href="#section-14.2.2" class="auto internal xref">14.2.2</a>.  <a href="#name-to-be-redacted-tag" class="internal xref">To be redacted tag</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-14.3" class="auto internal xref">14.3</a>.  <a href="#name-cbor-web-token-cwt-claims" class="internal xref">CBOR Web Token (CWT) Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3.2.1">
                    <p id="section-toc.1-1.14.2.3.2.1.1"><a href="#section-14.3.1" class="auto internal xref">14.3.1</a>.  <a href="#name-redacted_claim_keys" class="internal xref">redacted_claim_keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3.2.2">
                    <p id="section-toc.1-1.14.2.3.2.2.1"><a href="#section-14.3.2" class="auto internal xref">14.3.2</a>.  <a href="#name-sd_alg" class="internal xref">sd_alg</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3.2.3">
                    <p id="section-toc.1-1.14.2.3.2.3.1"><a href="#section-14.3.3" class="auto internal xref">14.3.3</a>.  <a href="#name-sd_hash" class="internal xref">sd_hash</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3.2.4">
                    <p id="section-toc.1-1.14.2.3.2.4.1"><a href="#section-14.3.4" class="auto internal xref">14.3.4</a>.  <a href="#name-vct" class="internal xref">vct</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#section-14.4" class="auto internal xref">14.4</a>.  <a href="#name-media-types" class="internal xref">Media Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4.2.1">
                    <p id="section-toc.1-1.14.2.4.2.1.1"><a href="#section-14.4.1" class="auto internal xref">14.4.1</a>.  <a href="#name-application-sdcwt" class="internal xref">application/sd+cwt</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4.2.2">
                    <p id="section-toc.1-1.14.2.4.2.2.1"><a href="#section-14.4.2" class="auto internal xref">14.4.2</a>.  <a href="#name-application-kbcwt" class="internal xref">application/kb+cwt</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-complete-cddl-schema" class="internal xref">Complete CDDL Schema</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-comparison-to-sd-jwt" class="internal xref">Comparison to SD-JWT</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-media-types-2" class="internal xref">Media Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-redaction-claims" class="internal xref">Redaction Claims</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3">
                <p id="section-toc.1-1.17.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-issuance" class="internal xref">Issuance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.4">
                <p id="section-toc.1-1.17.2.4.1"><a href="#appendix-B.4" class="auto internal xref">B.4</a>.  <a href="#name-presentation" class="internal xref">Presentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.5">
                <p id="section-toc.1-1.17.2.5.1"><a href="#appendix-B.5" class="auto internal xref">B.5</a>.  <a href="#name-validation" class="internal xref">Validation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-keys-used-in-the-examples" class="internal xref">Keys used in the examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-subject-holder" class="internal xref">Subject / Holder</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-issuer" class="internal xref">Issuer</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document updates the CBOR Web Token (CWT) specification <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, enabling the holder of a CWT to disclose or redact special claims marked disclosable by the issuer of a CWT.
The approach is modeled after SD-JWT <span>[<a href="#I-D.draft-ietf-oauth-selective-disclosure-jwt" class="cite xref">I-D.draft-ietf-oauth-selective-disclosure-jwt</a>]</span>, with changes to align with conventions from CBOR Object Signing and Encryption (COSE) <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span>.
This specification enables Holders of CWT based credentials to prove the integrity and authenticity of selected attributes asserted by an Issuer about a Subject to a Verifier.
Although techniques such as one time use and batch issuance can improve the confidentiality and security characteristics of CWT based credential protocols, CWTs remain traceable.
Selective Disclosure CBOR Web Tokens (SD-CWTs) are CWTs and can be deployed in protocols that are already using CWTs, even if they contain no optional to disclose claims.
Credential types are distinguished by their attributes, for example a license to operate a vehicle and a license to import a product will contain different attributes.
The specification of credential types is out of scope for this document, and the examples used in this document are informative.
SD-CWT operates on CWT Claims Sets as described in <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.
CWT Claims Sets contain Claim Keys and Claim Values.
SD-CWT enables Issuers to mark certain Claim Keys or Claim Values mandatory or optional for a holder of a CWT to disclose.
A verifier who does not understand optional to disclose Claims in an SD-CWT can still process the mandatory to disclose attributes.
Claim Keys and Claim Values which are not understood remain ignored as described in <span><a href="https://rfc-editor.org/rfc/rfc8392#section-3" class="relref">Section 3</a> of [<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<div id="high-level-flow">
<section id="section-1.1">
        <h3 id="name-high-level-flow">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-high-level-flow" class="section-name selfRef">High level flow</a>
        </h3>
<p id="section-1.1-1">Figure 1: High level SD-CWT Issuance and Presentation Flow<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<div id="section-1.1-2">
          <div class="alignLeft art-svg artwork" id="section-1.1-2.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="400" width="584" viewBox="0 0 584 400" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 24,48 L 24,384" fill="none" stroke="black"></path>
              <path d="M 288,48 L 288,384" fill="none" stroke="black"></path>
              <path d="M 320,64 L 320,96" fill="none" stroke="black"></path>
              <path d="M 320,224 L 320,256" fill="none" stroke="black"></path>
              <path d="M 320,288 L 320,320" fill="none" stroke="black"></path>
              <path d="M 560,48 L 560,384" fill="none" stroke="black"></path>
              <path d="M 288,64 L 320,64" fill="none" stroke="black"></path>
              <path d="M 296,96 L 320,96" fill="none" stroke="black"></path>
              <path d="M 32,112 L 280,112" fill="none" stroke="black"></path>
              <path d="M 24,144 L 280,144" fill="none" stroke="black"></path>
              <path d="M 288,160 L 552,160" fill="none" stroke="black"></path>
              <path d="M 296,192 L 560,192" fill="none" stroke="black"></path>
              <path d="M 288,224 L 320,224" fill="none" stroke="black"></path>
              <path d="M 296,256 L 320,256" fill="none" stroke="black"></path>
              <path d="M 288,288 L 320,288" fill="none" stroke="black"></path>
              <path d="M 296,320 L 320,320" fill="none" stroke="black"></path>
              <path d="M 288,368 L 552,368" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="560,368 548,362.4 548,373.6" fill="black" transform="rotate(0,552,368)"></polygon>
              <polygon class="arrowhead" points="560,160 548,154.4 548,165.6" fill="black" transform="rotate(0,552,160)"></polygon>
              <polygon class="arrowhead" points="304,320 292,314.4 292,325.6" fill="black" transform="rotate(180,296,320)"></polygon>
              <polygon class="arrowhead" points="304,256 292,250.4 292,261.6" fill="black" transform="rotate(180,296,256)"></polygon>
              <polygon class="arrowhead" points="304,192 292,186.4 292,197.6" fill="black" transform="rotate(180,296,192)"></polygon>
              <polygon class="arrowhead" points="304,96 292,90.4 292,101.6" fill="black" transform="rotate(180,296,96)"></polygon>
              <polygon class="arrowhead" points="288,144 276,138.4 276,149.6" fill="black" transform="rotate(0,280,144)"></polygon>
              <polygon class="arrowhead" points="40,112 28,106.4 28,117.6" fill="black" transform="rotate(180,32,112)"></polygon>
              <g class="text">
                <text x="28" y="36">Issuer</text>
                <text x="292" y="36">Holder</text>
                <text x="548" y="36">Verifier</text>
                <text x="344" y="84">Key</text>
                <text x="376" y="84">Gen</text>
                <text x="120" y="100">Request</text>
                <text x="180" y="100">SD-CWT</text>
                <text x="424" y="148">Request</text>
                <text x="480" y="148">Nonce</text>
                <text x="120" y="164">Receive</text>
                <text x="180" y="164">SD-CWT</text>
                <text x="424" y="212">Receive</text>
                <text x="480" y="212">Nonce</text>
                <text x="356" y="244">Redact</text>
                <text x="412" y="244">Claims</text>
                <text x="376" y="308">Demonstrate</text>
                <text x="368" y="324">Posession</text>
                <text x="424" y="356">Present</text>
                <text x="484" y="356">SD-CWT</text>
              </g>
            </svg><a href="#section-1.1-2.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-1.1-3">This diagram captures the essential details necessary to issue and present an SD-CWT.
The parameters necessary to support these processes can be obtained using transports or protocols which are out of scope for this specification.
However the following guidance is generally recommended, regardless of protocol or transport.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1-4">
<li id="section-1.1-4.1">
            <p id="section-1.1-4.1.1">The issuer <span class="bcp14">SHOULD</span> confirm the holder controls all confirmation material before issuing credentials using the <code>cnf</code> claim.<a href="#section-1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.1-4.2">
            <p id="section-1.1-4.2.1">To protect against replay attacks, the verifier <span class="bcp14">SHOULD</span> provide a nonce, and reject requests that do not include an acceptable an nonce (cnonce). This guidance can be ignored in cases where replay attacks are mitigated at another layer.<a href="#section-1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document uses terms from CWT <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, and COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span>
        <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The terms Claim Name, Claim Key and Claim Value are defined in <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">This document defines the following new terms:<a href="#section-2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-5">
        <dt id="section-2-5.1">Selective Disclosure CBOR Web Token (SD-CWT):</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.2">
          <p id="section-2-5.2.1">A CWT with claims enabling selective disclosure with key binding.<a href="#section-2-5.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.3">Selective Disclosure Key Binding Token (SD-CWT-KBT):</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.4">
          <p id="section-2-5.4.1">A CWT used to demonstrate possession of a confirmation method, associated to an SD-CWT.<a href="#section-2-5.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.5">Issuer:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.6">
          <p id="section-2-5.6.1">An entity that produces a Selective Disclosure CBOR Web Token.<a href="#section-2-5.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.7">Holder:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.8">
          <p id="section-2-5.8.1">An entity that presents a Selective Disclosure CBOR Web Token which includes a Selective Disclosure Key Binding Token.<a href="#section-2-5.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.9">Verifier:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.10">
          <p id="section-2-5.10.1">An entity that validates a Partial or Full Disclosure by a holder.<a href="#section-2-5.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.11">Partial Disclosure:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.12">
          <p id="section-2-5.12.1">When a subset of the original claims protected by the Issuer, are disclosed by the Holder.<a href="#section-2-5.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.13">Full Disclosure:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.14">
          <p id="section-2-5.14.1">When the full set of claims protected by the Issuer, is disclosed by the Holder. An SD-CWT with no blinded claims (all claims are marked mandatory to disclose by the Issuer) is considered a Full Disclosure.<a href="#section-2-5.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.15">Salted Disclosed Claim:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.16">
          <p id="section-2-5.16.1">A salted claim disclosed in the unprotected header of an SD-CWT.<a href="#section-2-5.16.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.17">Digested Salted Disclosed Claim / Blinded Claim Hash:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.18">
          <p id="section-2-5.18.1">A hash digest of a Salted Disclosed Claim.<a href="#section-2-5.18.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.19">Blinded Claim:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.20">
          <p id="section-2-5.20.1">Any Redacted Claim Key or Redacted Claim Element which has been replaced in the
CWT payload by a Blinded Claim Hash.<a href="#section-2-5.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.21">Redacted Claim Key:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.22">
          <p id="section-2-5.22.1">The hash of a claim redacted from a map data structure.<a href="#section-2-5.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.23">Redacted Claim Element:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.24">
          <p id="section-2-5.24.1">The hash of an element redacted from an array data structure.<a href="#section-2-5.24.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.25">Presented Disclosed Claims Set:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.26">
          <p id="section-2-5.26.1">The CBOR map containing zero or more Redacted Claim Keys or Redacted Claim Elements.<a href="#section-2-5.26.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.27">Validated Disclosed Claims Set:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.28">
          <p id="section-2-5.28.1">The CBOR map containing all mandatory to disclose claims signed by the issuer, all selectively disclosed claims presented by the holder, and omitting all undisclosed instances of Redacted Claim Keys and Redacted Claim Element claims that are present in the original SD-CWT.<a href="#section-2-5.28.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="overview-of-selective-disclosure-cwt">
<section id="section-3">
      <h2 id="name-overview-of-selective-discl">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview-of-selective-discl" class="section-name selfRef">Overview of Selective Disclosure CWT</a>
      </h2>
<div id="a-cwt-without-selective-disclosure">
<section id="section-3.1">
        <h3 id="name-a-cwt-without-selective-dis">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-a-cwt-without-selective-dis" class="section-name selfRef">A CWT without Selective Disclosure</a>
        </h3>
<p id="section-3.1-1">Below is the payload of a standard CWT without selective disclosure.
It consists of standard CWT claims, the holder confirmation key, and five specific custom claims. The payload is shown below in CBOR Extended Diagnostic
Notation (EDN) <span>[<a href="#I-D.ietf-cbor-edn-literals" class="cite xref">I-D.ietf-cbor-edn-literals</a>]</span>. Note that some of the CWT claim map keys shown in the examples have been invented for this example and do not have registered integer keys.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-3.1-2">
<pre>
{
    / iss / 1  : "https://issuer.example",
    / sub / 2  : "WRQ2RbY5RYJCIxfDQL9agl9fFSCYVu4Xocqb6zerc1M",
    / exp / 4  : 1725330600, /2024-09-02T19:30:00Z/
    / nbf / 5  : 1725243840, /2024-09-01T19:25:00Z/
    / iat / 6  : 1725244200, /2024-09-01T19:30:00Z/
    / cnf / 8  : {
      / cose key / 1 : {
        / alg: ES256 /  3: -7,
        / kty: EC2   /  1: 2,
        / crv: P-256 / -1: 1,
        / x / -2: b64'hVTrJ13Nb70cesZBqiyQ2SAi_Q0wJLWvGMfMYa1Sei0',
        / y / -3: b64'TceuLGd-ltDMgll2Vc6S1VA_VCk9h4ddHnnOR3AZQ0M'
      }
    },
    / name /  170 : "Alice Smith",
    / age_at_least_18 /  500 : true,
    / age_at_least_21 /  501 : false,
    / swversion / 271 : [
      "3.5.5",
      "4.1.7"
    ],
    / address /  187 : {
        "country"   : "us",          / United States /
        "region"    : "ca",          / California /
        "locality"  : "San Francisco",
        "postal_code" : "94188"
    }
}
</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1-3">The custom claims consist of the Holder's name (Alice Smith), that she is at least 18 years old but not yet 21, that her client supports software versions 3.5.5 and 4.1.7, and her address is in San Francisco.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="holder-gets-an-sd-cwt-from-the-issuer">
<section id="section-3.2">
        <h3 id="name-holder-gets-an-sd-cwt-from-">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-holder-gets-an-sd-cwt-from-" class="section-name selfRef">Holder gets an SD-CWT from the Issuer</a>
        </h3>
<p id="section-3.2-1">Alice would like to selectively disclose some of these (custom) claims to different verifiers.
(For brevity, we will leave out the name and locality claims.) Note that some of the claims may not be selectively disclosable
(Alice's country and her oldest supported software version in this example).
First she requests an SD-CWT from her issuer. The issuer generates an SD-CWT as follows:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div class="breakable lang-cbor-diag sourcecode" id="section-3.2-2">
<pre>
/ cose-sign1 / 18([
  / protected / &lt;&lt; {
    / alg / 1  : -35, / ES384 /
    / typ / 16 : "application/sd+cwt",
    / kid / 4  : 'https://issuer.example/cwk3.cbor'
  } &gt;&gt;,
  / unprotected / {
    / sd_claims / 17 : / these are all the disclosures /
    &lt;&lt;[
        &lt;&lt;[
            /salt/   h'8d5c15fa86265d8ff77a0e92720ca837',
            /claim/  500,  / age_at_least_18 /
            /value/  true
        ]&gt;&gt;,
        &lt;&lt;[
            /salt/   h'd84c364fad31e0075213141ca7d1408f',
            /claim/  501,  / age_at_least_21 /
            /value/  false
        ]&gt;&gt;,
        &lt;&lt;[
            /salt/   h'30eef86edeaa197df7bd3d17dd89cd87',
            /claim/  "region",
            /value/  "ca" /California/
        ]&gt;&gt;,
        &lt;&lt;[
            /salt/   h'284538c4a1881fac49b2edc550c1913e',
            /claim/  "postal_code",
            /value/  "94188"
        ]&gt;&gt;,
        &lt;&lt;[
            /salt/   h'86c84b9c3614ba27073c7e5a475a2a13',
            /value/  "4.1.7"
        ]&gt;&gt;
    ]&gt;&gt;
  },
  / payload / &lt;&lt; {
    / iss / 1  : "https://issuer.example",
    / sub / 2  : "WRQ2RbY5RYJCIxfDQL9agl9fFSCYVu4Xocqb6zerc1M",
    / exp / 4  : 1725330600, /2024-09-02T19:30:00Z/
    / nbf / 5  : 1725243840, /2024-09-01T19:25:00Z/
    / iat / 6  : 1725244200, /2024-09-01T19:30:00Z/
    / cnf / 8  : {
      / cose key / 1 : {
        / alg: ES256 /  3: -7,
        / kty: EC2   /  1: 2,
        / crv: P-256 / -1: 1,
        / x / -2: h'hVTrJ13Nb70cesZBqiyQ2SAi_Q0wJLWvGMfMYa1Sei0',
        / y / -3: h'TceuLGd-ltDMgll2Vc6S1VA_VCk9h4ddHnnOR3AZQ0M'
      }
    },
    / sd_alg /  12       : -16, / SHA-256 /
    / redacted_claim_keys / -65536 : [
        / redacted age_at_least_18 /
        h'7e6e350907d0ba3aa7ae114f8da5b360' +
        h'601c0bb7995cd40049b98e4f58fb6ec0',
        / redacted age_at_least_21 /
        h'1e7275bcda9bc183079cd4515c5c0282' +
        h'a2a0e9105b660933e2e68f9a3f40974b'
    ],
    / swversion / 271 : [
      "3.5.5",
      / redacted version "4.1.7" /
      60(h'a0f74264a8c97655c958aff3687f1390' +
         h'ed0ab6f64cd78ba43c3fefee0de7b835')
    ],
    "address": {
        "country" : "us",            / United States /
        / redacted_claim_keys / -65536 : [
            / redacted region /
            h'c47e3b047c1cd6d9d1e1e01514bc2ec9' +
            h'ed010ac9ae1c93403ec72572bb1e00e7',
            / redacted postal_code /
            h'0b616e522a05d8d134a834979710120d' +
            h'41ac1522b056d5f9509cf7e850047302'
        ]
    }
  } &gt;&gt;,
  / signature / h'3337af2e66959614' /TODO: fix /
])
</pre><a href="#section-3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2-3">Some of the claims are <em>redacted</em> in the payload. The corresponding <em>disclosure</em> is communicated in the unprotected header in the <code>sd_claims</code> key.
For example, the <code>age_at_least_18</code> claim is a Salted Disclosed Claim, consisting of a per-disclosure random salt, the claim name, and claim value.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-3.2-4">
<pre>
&lt;&lt;[
    /salt/   h'8d5c15fa86265d8ff77a0e92720ca837',
    /claim/  500,  / age_at_least_18 /
    /value/  true
]&gt;&gt;,
</pre><a href="#section-3.2-4" class="pilcrow">¶</a>
</div>
<p id="section-3.2-5">The SHA-256 hash (the hash algorithm identified in the <code>sd_hash</code> field in the payload) of that bytes string is the Digested Salted Disclosed Claim (in hex).
The digest value is included in the payload in a <code>redacted_claim_keys</code> field for a Redacted Claim Key (in this example), or in a named array for a Redacted Claim Element (ex: for a redacted claim element of <code>swversion</code>).<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-6">
<pre>
7e6e350907d0ba3aa7ae114f8da5b360601c0bb7995cd40049b98e4f58fb6ec0
</pre><a href="#section-3.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="holder-prepares-an-sd-cwt-for-a-verifier">
<section id="section-4">
      <h2 id="name-holder-prepares-an-sd-cwt-f">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-holder-prepares-an-sd-cwt-f" class="section-name selfRef">Holder prepares an SD-CWT for a Verifier</a>
      </h2>
<p id="section-4-1">When the Holder wants to send an SD-CWT and disclose none, some, or all of the redacted values, it makes a list of the values to disclose and puts them in <code>sd_claims</code> in the unprotected header.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">For example, Alice decides to disclosure to a verifier the <code>age_at_least_18</code> claim (true), the <code>region</code> claim (California), and the other element in the <code>swversion</code> array (4.1.7).<a href="#section-4-2" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-4-3">
<pre>
/ sd_claims / 17 : /just the disclosures chosen by the Holder/
&lt;&lt;[
        &lt;&lt;[
                /salt/   h'8d5c15fa86265d8ff77a0e92720ca837',
                /claim/  500,  / age_at_least_18 /
                /value/  true
        ]&gt;&gt;,
        &lt;&lt;[
                /salt/   h'30eef86edeaa197df7bd3d17dd89cd87',
                /claim/  "region",
                /value/  "ca" /California/
        ]&gt;&gt;,
        &lt;&lt;[
                /salt/   h'86c84b9c3614ba27073c7e5a475a2a13',
                /value/  "4.1.7"
        ]&gt;&gt;
]&gt;&gt;
</pre><a href="#section-4-3" class="pilcrow">¶</a>
</div>
<p id="section-4-4">The Holder <span class="bcp14">MAY</span> fetch a nonce from the Verifier to prevent replay, or obtain a nonce acceptable to the verifier through a process similar to the method described in draft-ietf-httpbis-unprompted-auth-12.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">Finally, the Holder generates a Selective Disclosure Key Binding Token (SD-KBT) that ties together any disclosures, the Verifier nonce and target audience, and proof of possession of the Holder's private key.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-6">
<pre>
/ sd_kbt    / 18 : &lt;&lt; 18([
  / protected / &lt;&lt; {
          / alg / 1 : -7 / ES256 /,
          / typ / 16 : "application/kb+cwt"
  } &gt;&gt;,
  / unprotected / {},
  / payload / &lt;&lt; {
        / cnonce / 39    : h'8c0f5f523b95bea44a9a48c649240803',
        / aud     / 3    : "https://verifier.example/app",
        / iat     / 6    : 1725283443, / 2024-09-02T06:24:03Z /
        / sd_alg  / 12 : -16,  /SHA-256/
        / sd_hash / 11 :
        /hash of sd_claims in target SD-CWT using hash in sd_alg/
    h'4287237578266d07a3a2909fab6579ce9b4ab8f61b67afa00f6724b9b952557b'
  } &gt;&gt;,
  / signature / h'1237af2e678945'  / TODO: fix /
]) &gt;&gt;
</pre><a href="#section-4-6" class="pilcrow">¶</a>
</div>
<p id="section-4-7">Finally, the unprotected part of the SD-CWT received from the Holder is replaced with the <code>sd_claims</code> and <code>sd_kbt</code> fields generated by the Holder.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">Together the digests in protected parts of the issued SD-CWT, and the disclosures hashed in the SW-KBT are used by the Verifier to confirm the disclosed claims.<a href="#section-4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sd-cwt-definition">
<section id="section-5">
      <h2 id="name-sd-cwt-definition">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-sd-cwt-definition" class="section-name selfRef">SD-CWT definition</a>
      </h2>
<p id="section-5-1">SD-CWT is modeled after SD-JWT, with adjustments to align with conventions in CBOR and COSE. An SD-CWT <span class="bcp14">MUST</span> include the protected header parameter <code>typ</code> <span>[<a href="#RFC9596" class="cite xref">RFC9596</a>]</span> with the value "application/sd-cwt" in the SD-CWT.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">An SD-CWT is a CWT containing the "blinded claim hash" of at least one blinded claim in the CWT payload.
Optionally the salted claim values (and often claim names) for the corresponding Blinded Claim Hash are actually disclosed in the <code>sd_claims</code> claim in the unprotected header of the CWT (the disclosures).<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Any party with a Salted Disclosed Claim can generate its hash, find that hash in the CWT payload, and unblind the content.
However a Verifier with the hash cannot reconstruct the corresponding blinded claim without disclosure of the Salted Disclosed Claim.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="types-of-blinded-claims">
<section id="section-5.1">
        <h3 id="name-types-of-blinded-claims">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-types-of-blinded-claims" class="section-name selfRef">Types of blinded claims</a>
        </h3>
<p id="section-5.1-1">Salted Disclosed Claims for named claims are structured as a 128-bit salt, the name of the redacted element, and the disclosed value.
For Salted Disclosed Claims of items in an array, the name is omitted.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1-2">
<pre>
salted = salted-claim / salted-element / decoy
salted-claim = [
  bstr .size 16,     ; 128-bit salt
  (int / text),      ; claim name
  any                ; claim value
]
salted-element = [
  bstr .size 16,     ; 128-bit salt
  any                ; claim value
]
decoy = [
  bstr .size 16,     ; 128-bit salt
]

; a collection of Salted Disclosed Claims
salted-array = [ +bstr .cbor salted ]
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1-3">When a blinded claim is a key in a map, its blinded claim hash is added to a <code>redacted_claim_keys</code> array claim in the CWT payload that is at the same level of hierarchy as the key being blinded.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">When blinding an individual item in an array, the value of the item is replaced with the digested salted hash as a CBOR binary string, wrapped with a CBOR tag (requested tag number 60).<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.1-5">
<pre>
redacted_claim_element = #6.60( bstr .size 16 )
</pre><a href="#section-5.1-5" class="pilcrow">¶</a>
</div>
<p id="section-5.1-6">Blinded claims can be nested. For example, both individual keys in the <code>address</code> claim, and the entire <code>address</code> element can be separately blinded.
An example nested claim is shown in <strong>TODO iref</strong>.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">Finally, an issuer may create "decoy digests" which look like a blinded claim hash but have only a salt.
Decoy digests are discussed in <strong>TODO iref</strong>.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sd-cwt-issuance">
<section id="section-6">
      <h2 id="name-sd-cwt-issuance">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-sd-cwt-issuance" class="section-name selfRef">SD-CWT Issuance</a>
      </h2>
<p id="section-6-1">How the Holder communicates to the Issuer to request a CWT or an SD-CWT is out-of-scope of this specification.
Likewise, how the Holder determines which claims to blind or to always disclose is a policy matter which is not discussed in this specification.
This specification defines the format of an SD-CWT communicated between an Issuer and a Holder in this section, and describes the format of an SD-CWT communicated between a Holder and a Verifier in the next section.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The unprotected header <span class="bcp14">MUST</span> contain an <code>sd_claims</code> section with a Salted Disclosed Claim for <em>every</em> blinded claim hash present anywhere in the payload.
The payload <span class="bcp14">MUST</span> also include a key confirmation element (<code>cnf</code>) <span>[<a href="#RFC8747" class="cite xref">RFC8747</a>]</span> for the Holder's public key, and an <code>sd_alg</code> claim identifying the algorithm used to hash the Salted Disclosed Claims.<a href="#section-6-2" class="pilcrow">¶</a></p>
<div id="issuer-generation">
<section id="section-6.1">
        <h3 id="name-issuer-generation">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-issuer-generation" class="section-name selfRef">Issuer generation</a>
        </h3>
<p id="section-6.1-1">The Issuer follows all the requirements of generating a valid CWT.
The Issuer <span class="bcp14">MUST</span> implement COSE_Sign1 using an appropriate asymmetric signature algorithm / curve combination (for example ES256/P-256 or EdDSA/Ed25519)<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The Issuer <span class="bcp14">MUST</span> generate a unique cryptographically random salt with at least 128-bits of entropy for each Salted Disclosed Claim.
If the client communicates a client-generated nonce (<code>cnonce</code>) when requesting the SD-CWT, the Issuer <span class="bcp14">SHOULD</span> include it in the payload.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="holder-validation">
<section id="section-6.2">
        <h3 id="name-holder-validation">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-holder-validation" class="section-name selfRef">Holder validation</a>
        </h3>
<p id="section-6.2-1">Upon receiving an SD-CWT from the Issuer with the Holder as the subject, the
Holder verifies the following:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1">
            <p id="section-6.2-2.1.1">the issuer (<code>iss</code>) and subject (<code>sub</code>) are correct;<a href="#section-6.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.2">
            <p id="section-6.2-2.2.1">if an audience (<code>aud</code>) is present, it is acceptable;<a href="#section-6.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.3">
            <p id="section-6.2-2.3.1">the CWT is valid according to the <code>nbf</code> and <code>exp</code> claims;<a href="#section-6.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.4">
            <p id="section-6.2-2.4.1">a public key under the control of the Holder is present in the <code>cnf</code> claim;<a href="#section-6.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.5">
            <p id="section-6.2-2.5.1">the hash algorithm in <code>sd-alg</code> is supported by the Holder;<a href="#section-6.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.6">
            <p id="section-6.2-2.6.1">if a <code>cnonce</code> is present, it was provided by the Holder to this Issuer and is still "fresh";<a href="#section-6.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.7">
            <p id="section-6.2-2.7.1">there are no unblinded claims about the subject which violate its privacy policies;<a href="#section-6.2-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.8">
            <p id="section-6.2-2.8.1">every blinded claim hash has a corresponding Salted Disclosed Claim, and vice versa;<a href="#section-6.2-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.9">
            <p id="section-6.2-2.9.1">all the Salted Disclosed Claims are correct in their unblinded context in the payload.<a href="#section-6.2-2.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.2-3">The following informative CDDL is provided to describe the syntax for an SD-CWT issuance. A complete CDDL schema is in <a href="#cddl" class="auto internal xref">Appendix A</a>.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-6.2-4">
<pre>
sd-cwt-issued = #6.18([
   protected: bstr .cbor sd-protected,
   unprotected-issued,
   payload: bstr .cbor sd-payload,
   signature: bstr
])

sd-protected = {
   &amp;(typ: 16) ^ =&gt; "application/sd+cwt",
   &amp;(alg: 1) ^ =&gt; int,
   * key =&gt; any
}

unprotected-issued = {
   &amp;(sd_claims: 17) ^ =&gt; bstr .cbor salted-array,
   * key =&gt; any
}

sd-payload = {
    ; standard claims
      &amp;(iss: 1) ^ =&gt; tstr, ; "https://issuer.example"
      &amp;(sub: 2) ^ =&gt; tstr, ; "https://device.example"
    ? &amp;(aud: 3) ^ =&gt; tstr, ; "https://verifier.example/app"
    ? &amp;(exp: 4) ^ =&gt; int,  ; 1883000000
    ? &amp;(nbf: 5) ^ =&gt; int,  ; 1683000000
      &amp;(iat: 6) ^ =&gt; int,  ; 1683000000
      &amp;(cnf: 8) ^ =&gt; { * key =&gt; any }, ; key confirmation
    ? &amp;(cnonce: 39) ^ =&gt; bstr,
    ;
    ; sd-cwt new claims
      &amp;(sd_alg: 12) ^ =&gt; int,            ; -16 for sha-256
    ? &amp;(redacted_keys: -65536) ^ =&gt; [ * bstr ],
    * key =&gt; any
}
</pre><a href="#section-6.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sd-cwt-presentation">
<section id="section-7">
      <h2 id="name-sd-cwt-presentation">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-sd-cwt-presentation" class="section-name selfRef">SD-CWT Presentation</a>
      </h2>
<p id="section-7-1">When a Holder presents an SD-CWT to a Verifier, it can disclose none, some, or all of its blinded claims.
If the Holder wishes to disclose any claims, it includes those Salted Disclosed Claims in the <code>sd_claims</code> claim of the unprotected header.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-7-2">
<pre>
sd-cwt-presentation = #6.18([
   protected: bstr .cbor sd-protected,
   unprotected-presentation,
   payload: bstr .cbor sd-payload,
   signature: bstr
])

unprotected-presentation = {
   &amp;(sd_kbt: 18) ^ =&gt; bstr .cbor kbt-cwt,
   ? &amp;(sd_claims: TBD1) ^ =&gt; bstr .cbor salted-array,
   * key =&gt; any
}
</pre><a href="#section-7-2" class="pilcrow">¶</a>
</div>
<p id="section-7-3">As described in the CDDL above, a SD-CWT presentation to a Verifier has the same syntax as an SD-CWT issued to a Holder, except for its unprotected header.
Since the unprotected header is not included in the signature, it will contain all the Salted Disclosed Claims when sent from the Issuer to the Holder.
By comparison, the unprotected header will include a Key Binding Token and contain none, some, or all of these Claims when sent from the Holder to the Verifier.<a href="#section-7-3" class="pilcrow">¶</a></p>
<div id="kbt">
<section id="section-7.1">
        <h3 id="name-creating-a-key-binding-toke">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-creating-a-key-binding-toke" class="section-name selfRef">Creating a Key Binding Token</a>
        </h3>
<p id="section-7.1-1">Regardless if it discloses any claims, the Holder <span class="bcp14">MUST</span> include a Holder key binding (SD_KBT) <a href="#kbt" class="auto internal xref">Section 7.1</a> in a <code>sd_kbt</code> claim in the unprotected header in every presentation of an SD-CWT by a Holder to a Verifier.
(The <code>sd_kbt</code> claim is absent when the Issuer is providing the SD-CWT to the Holder.) An SD-KBT is itself a type of CWT.
The protected header of the SD-KBT <span class="bcp14">MUST</span> include the <code>typ</code> header parameter with the value <code>application/sd-kbt</code>.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">The SD-KBT provides the following assurances to the Verifier:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-3.1">
            <p id="section-7.1-3.1.1">the Holder of the SD-CWT controls the confirmation method chosen by the Issuer;<a href="#section-7.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-3.2">
            <p id="section-7.1-3.2.1">the Holder's disclosures have not been tampered with since confirmation occurred;<a href="#section-7.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-3.3">
            <p id="section-7.1-3.3.1">the Holder intended to address the SD-CWT to the Verifier specified in the audience (<code>aud</code>) claim;<a href="#section-7.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-3.4">
            <p id="section-7.1-3.4.1">the Holder's disclosure is linked to the creation time (<code>iat</code>) of the key binding.<a href="#section-7.1-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.1-4">The SD-KBT prevents an attacker from copying and pasting disclosures, or from adding or removing disclosures without detection.
Confirmation is established according to RFC 8747, using the <code>cnf</code> claim in the payload of the SD-CWT.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">Using the algorithm established in <code>sd_alg</code> in the payloads of both the SD-CWT and the SD-KBT, the Holder constructs the hash of all the Salted Disclosed Claims it will share with the Verifier.
This is the hash of the entire <code>sd_claims</code> array in the unprotected header of the SD-CWT.
This composite hash is included in the <code>sd_hash</code> claim in the payload of the SD-KBT.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">The Holder signs the SD-KBT using the key specified in the <code>cnf</code> claim in the SD-CWT. This proves possession of the Holder's private key.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-7.1-7">
<pre>
kbt-cwt = #6.18([
   protected: bstr .cbor kbt-protected,
   kbt-unprotected,
   payload: bstr .cbor kbt-payload,
   signature: bstr
])

kbt-protected = {
   &amp;(typ: 16)^ =&gt; "application/kb+cwt",
   &amp;(alg: 1)^ =&gt; int,
   * key =&gt; any
}

kbt-unprotected = {
   * key =&gt; any
}

kbt-payload = {
      &amp;(aud: 3) ^ =&gt; tstr, ; "https://verifier.example"
    ? &amp;(exp: 4) ^ =&gt; int,  ; 1883000000
    ? &amp;(nbf: 5) ^ =&gt; int,  ; 1683000000
      &amp;(iat: 6) ^ =&gt; int,  ; 1683000000
    ? &amp;(cnonce: 39) ^ =&gt; bstr,
      ; matches the hash of sd_claims in the presentation token
      &amp;(sd_hash: 11) ^ =&gt; bstr,
    * key =&gt; any
}
</pre><a href="#section-7.1-7" class="pilcrow">¶</a>
</div>
<p id="section-7.1-8">The <code>cnonce</code> is a <code>bstr</code> and <span class="bcp14">MUST</span> be treated as opaque to the Holder.<a href="#section-7.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sd-cwt-validation">
<section id="section-8">
      <h2 id="name-sd-cwt-validation">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-sd-cwt-validation" class="section-name selfRef">SD-CWT Validation</a>
      </h2>
<p id="section-8-1">The exact order of the following steps <span class="bcp14">MAY</span> be changed, as long as all checks are performed before deciding if an SD-CWT is valid.
First the Verifier must validate the SD-CWT as described in <span><a href="https://rfc-editor.org/rfc/rfc8392#section-7.2" class="relref">Section 7.2</a> of [<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.
After validation, the SD-KBT <span class="bcp14">MUST</span> be extracted from the unprotected header, and validated as described in <span><a href="https://rfc-editor.org/rfc/rfc8392#section-7.2" class="relref">Section 7.2</a> of [<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.
The Verifier <span class="bcp14">MUST</span> confirm that the <code>sd_alg</code> in the SD-KBT and the <code>sd_alg</code> in the SD-CWT are identical, and that the <code>sd_hash</code> claim of the validated SD-CWT-KBT matches the hash of the <code>sd_claims</code> member of the unprotected header, using the hash algorithm obtained from the validated <code>sd_alg</code> claim.
Next, the Verifier <span class="bcp14">MUST</span> extract and decode the disclosed claims from the <code>sd_claims</code> in the unprotected header.
The decoded <code>sd_claims</code> are converted to an intermediate data structure called a Digest To Disclosed Claim Map which is used to transform the Presented Disclosed Claimset, into a Validated Disclosed Claimset.
The Verifier <span class="bcp14">MUST</span> compute the hash of each Salted Disclosed Claim (<code>salted</code>), in order to match each disclosed value to each entry of the Presented Disclosed Claimset.
One possible concrete representation of the intermediate data structure for the Digest To Disclosed Claim Map could be:<a href="#section-8-1" class="pilcrow">¶</a></p>
<div class="lang-cddl-ish sourcecode" id="section-8-2">
<pre>
{
  &amp;(digested-salted-disclosed-claim) =&gt; salted
}
</pre><a href="#section-8-2" class="pilcrow">¶</a>
</div>
<p id="section-8-3">The Verifier constructs an empty cbor map called the Validated Disclosed Claimset, and initializes it with all mandatory to disclose claims from the verified Presented Disclosed Claimset.
Next the Verifier performs a breadth first or depth first traversal of the Presented Disclosed Claimset, Validated Disclosed Claimset, using the Digest To Disclosed Claim Map to insert claims into the Validated Disclosed Claimset when they appear in the Presented Disclosed Claimset.
By performing these steps, the recipient can cryptographically verify the integrity of the protected claims and verify they have not been tampered with.
If there remain unused Digest To Disclosed Claim Map at the end of this procedure the SD-CWT <span class="bcp14">MUST</span> be considered invalid, as if the signature had failed to verify.
Otherwise the SD-CWT is considered valid, and the Validated Disclosed Claimset is now a CWT Claimset with no claims marked for redaction.
Further validation logic can be applied to the Validated Disclosed Claimset, as it might normally be applied to a validated CWT claimset.<a href="#section-8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="decoy-digests">
<section id="section-9">
      <h2 id="name-decoy-digests">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-decoy-digests" class="section-name selfRef">Decoy Digests</a>
      </h2>
<p id="section-9-1"><strong>TODO</strong><a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-types">
<section id="section-10">
      <h2 id="name-credential-types">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-credential-types" class="section-name selfRef">Credential Types</a>
      </h2>
<p id="section-10-1">This specification defines the CWT claim vct (for verifiable credential type). The vct value <span class="bcp14">MUST</span> be a case-sensitive StringOrURI (see <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>) value serving as an identifier for the type of the SD-CWT claimset. The vct value <span class="bcp14">MUST</span> be a Collision-Resistant Name as defined in Section 2 of <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">This claim is defined for COSE based verifiable credentials, similar to the JOSE based verifiable credentials claim (<code>vct</code>) described in Section 3.2.2.1.1 of <span>[<a href="#I-D.draft-ietf-oauth-sd-jwt-vc" class="cite xref">I-D.draft-ietf-oauth-sd-jwt-vc</a>]</span>.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Profiles built on this specification are also encouraged to use more specific media types, as described in <span>[<a href="#RFC9596" class="cite xref">RFC9596</a>]</span>.<a href="#section-10-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="examples">
<section id="section-11">
      <h2 id="name-examples">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="section-11-1"><strong>TODO</strong> - Provide more examples<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="minimal-spanning-example">
<section id="section-11.1">
        <h3 id="name-minimal-spanning-example">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-minimal-spanning-example" class="section-name selfRef">Minimal spanning example</a>
        </h3>
<p id="section-11.1-1">The following example contains claims needed to demonstrate redaction of key-value pairs and array elements.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<span id="name-an-edn-example"></span><div id="example-edn">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-11.1-2.1">
<pre>
/ cose-sign1 / 18([
  / protected / &lt;&lt; {
    / alg / 1  : -35, / ES384 /
    / typ / 16 : "application/sd+cwt",
    / kid / 4  : 'https://issuer.example/cwt-key3'
  } &gt;&gt;,
  / unprotected / {
    / sd_claims / 17 : &lt;&lt;[  /these are the three disclosures/
        &lt;&lt;[
            /salt/   h'c93c7ff572c71e26',
            /claim/  "age_over_18",
            /value/  true
        ]&gt;&gt;,
        &lt;&lt;[
            /salt/   h'399c641e2aa18c1e',
            /claim/  "region",
            /value/  "ca" /California/
        ]&gt;&gt;,
        &lt;&lt;[
            /salt/   h'82501bb46c655f32',
            /value/  "4.1.7"
        ]&gt;&gt;
    ]&gt;&gt;,
    / sd_kbt    / 18 : &lt;&lt; 18([
      / protected / &lt;&lt; {
          / alg / 1 : -35 / ES384 /,
          / typ / 16 : "application/kb+cwt"
      } &gt;&gt;,
      / unprotected / {},
      / payload / &lt;&lt; {
        / cnonce / 39    : h'e0a156bb3f',
        / aud     / 3    : "https://verifier.example",
        / iat     / 6    : 1783000000,
        / sd_alg  / 12 : -16,  /SHA-256/
        / sd_hash / 11 : h'c341bb4a5f3f'  /hash of sd_claims   /
                                            /using hash in sd_alg/
      } &gt;&gt;,
      / signature / h'1237af2e678945'
    ]) &gt;&gt;
  },
  / payload / &lt;&lt; {
    / iss / 1   : "https://issuer.example",
    / sub / 2   : "https://device.example",
    / aud / 3   : "https://verifier.example",
    / exp / 4   : 1883000000,
    / iat / 6   : 1683000000,
    / cnf / 8   : {
      / cose key / 1 : {
        / alg: ES256 /  3: 35,
        / kty: EC2   /  1: 2,
        / crv: P-256 / -1: 1,
        / x / -2: h'768ed88626',
        / y / -3: h'6a48ccfd5d'
      }
    },
    / cnonce / 39 : h'12345678',
    / sd_hash / 11       : h'abcdef12',
    / sd_alg /  12       : -16, / SHA-256 /
    / redacted_claim_keys / -65536 : [
        h'abbdefef',  / redacted age_over_18 /
        h'132d75e7'  / redacted age_over_21 /
    ],
    / swversion / 271 : [
      "3.5.5",
      60(h'45dd87af') /redacted version element/ }
    ],
    "address": {
        "country" : "us",            / United States /
        /redacted_claim_keys/ -65536 : [
            h'adb7060403da225b',  / redacted region /
            h'e04bdfc44d3d40bc'   / redacted post_code /
        ]
    }
  } &gt;&gt;,
  / signature / h'3337af2e66959614'
])
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-an-edn-example" class="selfRef">An EDN Example</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="nested-example">
<section id="section-11.2">
        <h3 id="name-nested-example">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-nested-example" class="section-name selfRef">Nested example</a>
        </h3>
<p id="section-11.2-1"><strong>TODO</strong><a href="#section-11.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-status">
<section id="section-12">
      <h2 id="name-implementation-status">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-12-1">Note to RFC Editor: Please remove this section as well as references to <span>[<a href="#BCP205" class="cite xref">BCP205</a>]</span> before AUTH48.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">This section records the status of known implementations of the protocol defined by this specification at the time of posting of this Internet-Draft, and is based on a proposal described in <span>[<a href="#BCP205" class="cite xref">BCP205</a>]</span>.
The description of implementations in this section is intended to assist the IETF in its decision processes in progressing drafts to RFCs.
Please note that the listing of any individual implementation here does not imply endorsement by the IETF.
Furthermore, no effort has been spent to verify the information presented here that was supplied by IETF contributors.
This is not intended as, and must not be construed to be, a catalog of available implementations or their features.
Readers are advised to note that other implementations may exist.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">According to <span>[<a href="#BCP205" class="cite xref">BCP205</a>]</span>, "this will allow reviewers and working groups to assign due consideration to documents that have the benefit of running code, which may serve as evidence of valuable experimentation and feedback that have made the implemented protocols more mature.
It is up to the individual working groups to use this information as they see fit".<a href="#section-12-3" class="pilcrow">¶</a></p>
<div id="transmute-prototype">
<section id="section-12.1">
        <h3 id="name-transmute-prototype">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-transmute-prototype" class="section-name selfRef">Transmute Prototype</a>
        </h3>
<p id="section-12.1-1">Organization: Transmute Industries Inc<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<p id="section-12.1-2">Name: <a href="https://github.com/transmute-industries/sd-cwt">github.com/transmute-industries/sd-cwt</a><a href="#section-12.1-2" class="pilcrow">¶</a></p>
<p id="section-12.1-3">Description: An open source implementation of this draft.<a href="#section-12.1-3" class="pilcrow">¶</a></p>
<p id="section-12.1-4">Maturity: Prototype<a href="#section-12.1-4" class="pilcrow">¶</a></p>
<p id="section-12.1-5">Coverage: The current version ('main') implements functionality similar to that described in this document, and will be revised, with breaking changes to support the generation of example data to support this specification.<a href="#section-12.1-5" class="pilcrow">¶</a></p>
<p id="section-12.1-6">License: Apache-2.0<a href="#section-12.1-6" class="pilcrow">¶</a></p>
<p id="section-12.1-7">Implementation Experience: No interop testing has been done yet. The code works as proof of concept, but is not yet production ready.<a href="#section-12.1-7" class="pilcrow">¶</a></p>
<p id="section-12.1-8">Contact: Orie Steele (orie@transmute.industries)<a href="#section-12.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-13">
      <h2 id="name-security-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-13-1">Security considerations from COSE {(RFC9052)} and CWT <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> apply to this specification.<a href="#section-13-1" class="pilcrow">¶</a></p>
<div id="random-numbers">
<section id="section-13.1">
        <h3 id="name-random-numbers">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-random-numbers" class="section-name selfRef">Random Numbers</a>
        </h3>
<p id="section-13.1-1">Each salt used to protect disclosed claims <span class="bcp14">MUST</span> be generated independently from the salts of other claims. The salts <span class="bcp14">MUST</span> be generated from a source of entropy that is acceptable to the issuer.
Poor choice of salts can lead to brute force attacks that can reveal redacted claims.<a href="#section-13.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-14">
      <h2 id="name-iana-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="cose-header-parameters">
<section id="section-14.1">
        <h3 id="name-cose-header-parameters">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-cose-header-parameters" class="section-name selfRef">COSE Header Parameters</a>
        </h3>
<p id="section-14.1-1">IANA is requested to add the following entries to the CWT claims registry (https://www.iana.org/assignments/cose/cose.xhtml#header-parameters).<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<div id="sdclaims">
<section id="section-14.1.1">
          <h4 id="name-sd_claims">
<a href="#section-14.1.1" class="section-number selfRef">14.1.1. </a><a href="#name-sd_claims" class="section-name selfRef">sd_claims</a>
          </h4>
<p id="section-14.1.1-1">The following completed registration template per RFC8152 is provided:<a href="#section-14.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.1.1-2.1">
              <p id="section-14.1.1-2.1.1">Name: sd_claims<a href="#section-14.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.1.1-2.2">
              <p id="section-14.1.1-2.2.1">Label: TBD9 (requested assignment 17)<a href="#section-14.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.1.1-2.3">
              <p id="section-14.1.1-2.3.1">Value Type: bstr<a href="#section-14.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.1.1-2.4">
              <p id="section-14.1.1-2.4.1">Value Registry: (empty)<a href="#section-14.1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.1.1-2.5">
              <p id="section-14.1.1-2.5.1">Description: A list of selectively disclosed claims, which were originally redacted, then later disclosed at the discretion of the sender.<a href="#section-14.1.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.1.1-2.6">
              <p id="section-14.1.1-2.6.1">Reference: RFC XXXX<a href="#section-14.1.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sdkbt">
<section id="section-14.1.2">
          <h4 id="name-sd_kbt">
<a href="#section-14.1.2" class="section-number selfRef">14.1.2. </a><a href="#name-sd_kbt" class="section-name selfRef">sd_kbt</a>
          </h4>
<p id="section-14.1.2-1">The following completed registration template per RFC8152 is provided:<a href="#section-14.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.1.2-2.1">
              <p id="section-14.1.2-2.1.1">Name: sd_kbt<a href="#section-14.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.1.2-2.2">
              <p id="section-14.1.2-2.2.1">Label: TBD8 (requested assignment 18)<a href="#section-14.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.1.2-2.3">
              <p id="section-14.1.2-2.3.1">Value Type: bstr<a href="#section-14.1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.1.2-2.4">
              <p id="section-14.1.2-2.4.1">Value Registry: (empty)<a href="#section-14.1.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.1.2-2.5">
              <p id="section-14.1.2-2.5.1">Description: Key binding token for disclosed claims<a href="#section-14.1.2-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.1.2-2.6">
              <p id="section-14.1.2-2.6.1">Reference: RFC XXXX<a href="#section-14.1.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="cbor-tags">
<section id="section-14.2">
        <h3 id="name-cbor-tags">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-cbor-tags" class="section-name selfRef">CBOR Tags</a>
        </h3>
<div id="redacted-claim-element-tag">
<section id="section-14.2.1">
          <h4 id="name-redacted-claim-element-tag">
<a href="#section-14.2.1" class="section-number selfRef">14.2.1. </a><a href="#name-redacted-claim-element-tag" class="section-name selfRef">Redacted claim element tag</a>
          </h4>
<p id="section-14.2.1-1">The binary string inside the tag is a selective disclosure redacted claim element of an array.<a href="#section-14.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.2.1-2.1">
              <p id="section-14.2.1-2.1.1">Tag: TBD9 (requested assignment 60)<a href="#section-14.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.2.1-2.2">
              <p id="section-14.2.1-2.2.1">Data Item: byte string<a href="#section-14.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.2.1-2.3">
              <p id="section-14.2.1-2.3.1">Semantics: A selective disclosure redacted (array) claim element.<a href="#section-14.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.2.1-2.4">
              <p id="section-14.2.1-2.4.1">Specification Document(s): RFC XXXX<a href="#section-14.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="to-be-redacted-tag">
<section id="section-14.2.2">
          <h4 id="name-to-be-redacted-tag">
<a href="#section-14.2.2" class="section-number selfRef">14.2.2. </a><a href="#name-to-be-redacted-tag" class="section-name selfRef">To be redacted tag</a>
          </h4>
<p id="section-14.2.2-1">The array claim element, or map key and value inside the "To be redacted" tag is intended to be redacted using selective disclosure.<a href="#section-14.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.2.2-2.1">
              <p id="section-14.2.2-2.1.1">Tag: TBD10 (requested assignment 58)<a href="#section-14.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.2.2-2.2">
              <p id="section-14.2.2-2.2.1">Data Item: (any)<a href="#section-14.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.2.2-2.3">
              <p id="section-14.2.2-2.3.1">Semantics: An array claim element, or map key and value intended to be redacted.<a href="#section-14.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.2.2-2.4">
              <p id="section-14.2.2-2.4.1">Specification Document(s): RFC XXXX<a href="#section-14.2.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="cbor-web-token-cwt-claims">
<section id="section-14.3">
        <h3 id="name-cbor-web-token-cwt-claims">
<a href="#section-14.3" class="section-number selfRef">14.3. </a><a href="#name-cbor-web-token-cwt-claims" class="section-name selfRef">CBOR Web Token (CWT) Claims</a>
        </h3>
<p id="section-14.3-1">IANA is requested to add the following entries to the CWT claims registry (https://www.iana.org/assignments/cwt/cwt.xhtml).<a href="#section-14.3-1" class="pilcrow">¶</a></p>
<div id="redactedclaimkeys">
<section id="section-14.3.1">
          <h4 id="name-redacted_claim_keys">
<a href="#section-14.3.1" class="section-number selfRef">14.3.1. </a><a href="#name-redacted_claim_keys" class="section-name selfRef">redacted_claim_keys</a>
          </h4>
<p id="section-14.3.1-1">The following completed registration template per RFC8392 is provided:<a href="#section-14.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.3.1-2.1">
              <p id="section-14.3.1-2.1.1">Claim Name: redacted_claim_keys<a href="#section-14.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.1-2.2">
              <p id="section-14.3.1-2.2.1">Claim Description: Redacted Claim Keys in a map.<a href="#section-14.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.1-2.3">
              <p id="section-14.3.1-2.3.1">JWT Claim Name: _sd<a href="#section-14.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.1-2.4">
              <p id="section-14.3.1-2.4.1">Claim Key: TBD5 (request assignment -65536)<a href="#section-14.3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.1-2.5">
              <p id="section-14.3.1-2.5.1">Claim Value Type(s): array of bstr<a href="#section-14.3.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.1-2.6">
              <p id="section-14.3.1-2.6.1">Change Controller: IETF<a href="#section-14.3.1-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.1-2.7">
              <p id="section-14.3.1-2.7.1">Specification Document(s): RFC XXXX<a href="#section-14.3.1-2.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sdalg">
<section id="section-14.3.2">
          <h4 id="name-sd_alg">
<a href="#section-14.3.2" class="section-number selfRef">14.3.2. </a><a href="#name-sd_alg" class="section-name selfRef">sd_alg</a>
          </h4>
<p id="section-14.3.2-1">The following completed registration template per RFC8392 is provided:<a href="#section-14.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.3.2-2.1">
              <p id="section-14.3.2-2.1.1">Claim Name: sd_alg<a href="#section-14.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.2-2.2">
              <p id="section-14.3.2-2.2.1">Claim Description: Hash algorithm used for selective disclosure<a href="#section-14.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.2-2.3">
              <p id="section-14.3.2-2.3.1">JWT Claim Name: _sd_alg<a href="#section-14.3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.2-2.4">
              <p id="section-14.3.2-2.4.1">Claim Key: TBD4 (request assignment 12)<a href="#section-14.3.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.2-2.5">
              <p id="section-14.3.2-2.5.1">Claim Value Type(s): integer<a href="#section-14.3.2-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.2-2.6">
              <p id="section-14.3.2-2.6.1">Change Controller: IETF<a href="#section-14.3.2-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.2-2.7">
              <p id="section-14.3.2-2.7.1">Specification Document(s): RFC XXXX<a href="#section-14.3.2-2.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sdhash">
<section id="section-14.3.3">
          <h4 id="name-sd_hash">
<a href="#section-14.3.3" class="section-number selfRef">14.3.3. </a><a href="#name-sd_hash" class="section-name selfRef">sd_hash</a>
          </h4>
<p id="section-14.3.3-1">The following completed registration template per RFC8392 is provided:<a href="#section-14.3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.3.3-2.1">
              <p id="section-14.3.3-2.1.1">Claim Name: sd_hash<a href="#section-14.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.3-2.2">
              <p id="section-14.3.3-2.2.1">Claim Description: Hash of encoded disclosed claims<a href="#section-14.3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.3-2.3">
              <p id="section-14.3.3-2.3.1">JWT Claim Name: sd_hash<a href="#section-14.3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.3-2.4">
              <p id="section-14.3.3-2.4.1">Claim Key: TBD3 (request assignment 11)<a href="#section-14.3.3-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.3-2.5">
              <p id="section-14.3.3-2.5.1">Claim Value Type(s): bstr<a href="#section-14.3.3-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.3-2.6">
              <p id="section-14.3.3-2.6.1">Change Controller: IETF<a href="#section-14.3.3-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.3-2.7">
              <p id="section-14.3.3-2.7.1">Specification Document(s): RFC XXXX<a href="#section-14.3.3-2.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="vct">
<section id="section-14.3.4">
          <h4 id="name-vct">
<a href="#section-14.3.4" class="section-number selfRef">14.3.4. </a><a href="#name-vct" class="section-name selfRef">vct</a>
          </h4>
<p id="section-14.3.4-1">The following completed registration template per RFC8392 is provided:<a href="#section-14.3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.3.4-2.1">
              <p id="section-14.3.4-2.1.1">Claim Name: vct<a href="#section-14.3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.4-2.2">
              <p id="section-14.3.4-2.2.1">Claim Description: Verifiable credential type<a href="#section-14.3.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.4-2.3">
              <p id="section-14.3.4-2.3.1">JWT Claim Name: vct<a href="#section-14.3.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.4-2.4">
              <p id="section-14.3.4-2.4.1">Claim Key: TBD7 (request assignment 15)<a href="#section-14.3.4-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.4-2.5">
              <p id="section-14.3.4-2.5.1">Claim Value Type(s): bstr<a href="#section-14.3.4-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.4-2.6">
              <p id="section-14.3.4-2.6.1">Change Controller: IETF<a href="#section-14.3.4-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.3.4-2.7">
              <p id="section-14.3.4-2.7.1">Specification Document(s): RFC XXXX<a href="#section-14.3.4-2.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="media-types">
<section id="section-14.4">
        <h3 id="name-media-types">
<a href="#section-14.4" class="section-number selfRef">14.4. </a><a href="#name-media-types" class="section-name selfRef">Media Types</a>
        </h3>
<p id="section-14.4-1">This section requests the registration of new media types in https://www.iana.org/assignments/media-types/media-types.xhtml.<a href="#section-14.4-1" class="pilcrow">¶</a></p>
<div id="applicationsdcwt">
<section id="section-14.4.1">
          <h4 id="name-application-sdcwt">
<a href="#section-14.4.1" class="section-number selfRef">14.4.1. </a><a href="#name-application-sdcwt" class="section-name selfRef">application/sd+cwt</a>
          </h4>
<p id="section-14.4.1-1">IANA is requested to add the following entry to the media types registry in accordance with RFC6838, RFC4289, and RFC6657.<a href="#section-14.4.1-1" class="pilcrow">¶</a></p>
<p id="section-14.4.1-2">The following completed registration template is provided:<a href="#section-14.4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.4.1-3.1">
              <p id="section-14.4.1-3.1.1">Type name: application<a href="#section-14.4.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.2">
              <p id="section-14.4.1-3.2.1">Subtype name: sd+cwt<a href="#section-14.4.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.3">
              <p id="section-14.4.1-3.3.1">Required parameters: n/a<a href="#section-14.4.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.4">
              <p id="section-14.4.1-3.4.1">Optional parameters: n/a<a href="#section-14.4.1-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.5">
              <p id="section-14.4.1-3.5.1">Encoding considerations: binary<a href="#section-14.4.1-3.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.6">
              <p id="section-14.4.1-3.6.1">Security considerations: See the Security Considerations section
of RFC XXXX, and <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span><a href="#section-14.4.1-3.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.7">
              <p id="section-14.4.1-3.7.1">Interoperability considerations: n/a<a href="#section-14.4.1-3.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.8">
              <p id="section-14.4.1-3.8.1">Published specification: RFC XXXX<a href="#section-14.4.1-3.8.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.9">
              <p id="section-14.4.1-3.9.1">Applications that use this media type: TBD<a href="#section-14.4.1-3.9.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.10">
              <p id="section-14.4.1-3.10.1">Fragment identifier considerations: n/a<a href="#section-14.4.1-3.10.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.11">
              <p id="section-14.4.1-3.11.1">Additional information:<a href="#section-14.4.1-3.11.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.4.1-3.11.2.1">
                  <p id="section-14.4.1-3.11.2.1.1">Magic number(s): n/a<a href="#section-14.4.1-3.11.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-14.4.1-3.11.2.2">
                  <p id="section-14.4.1-3.11.2.2.1">File extension(s): n/a<a href="#section-14.4.1-3.11.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-14.4.1-3.11.2.3">
                  <p id="section-14.4.1-3.11.2.3.1">Macintosh file type code(s): n/a<a href="#section-14.4.1-3.11.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-14.4.1-3.12">
              <p id="section-14.4.1-3.12.1">Person &amp; email address to contact for further information:
Michael Prorock, mprorock@mesur.io<a href="#section-14.4.1-3.12.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.13">
              <p id="section-14.4.1-3.13.1">Intended usage: COMMON<a href="#section-14.4.1-3.13.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.14">
              <p id="section-14.4.1-3.14.1">Restrictions on usage: none<a href="#section-14.4.1-3.14.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.15">
              <p id="section-14.4.1-3.15.1">Author: Michael Prorock, mprorock@mesur.io<a href="#section-14.4.1-3.15.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.16">
              <p id="section-14.4.1-3.16.1">Change controller: IETF<a href="#section-14.4.1-3.16.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.1-3.17">
              <p id="section-14.4.1-3.17.1">Provisional registration?  No<a href="#section-14.4.1-3.17.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="applicationkbcwt">
<section id="section-14.4.2">
          <h4 id="name-application-kbcwt">
<a href="#section-14.4.2" class="section-number selfRef">14.4.2. </a><a href="#name-application-kbcwt" class="section-name selfRef">application/kb+cwt</a>
          </h4>
<p id="section-14.4.2-1">IANA is requested to add the following entry to the media types registry in accordance with RFC6838, RFC4289, and RFC6657.<a href="#section-14.4.2-1" class="pilcrow">¶</a></p>
<p id="section-14.4.2-2">The following completed registration template is provided:<a href="#section-14.4.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.4.2-3.1">
              <p id="section-14.4.2-3.1.1">Type name: application<a href="#section-14.4.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.2">
              <p id="section-14.4.2-3.2.1">Subtype name: kb+cwt<a href="#section-14.4.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.3">
              <p id="section-14.4.2-3.3.1">Required parameters: n/a<a href="#section-14.4.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.4">
              <p id="section-14.4.2-3.4.1">Optional parameters: n/a<a href="#section-14.4.2-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.5">
              <p id="section-14.4.2-3.5.1">Encoding considerations: binary<a href="#section-14.4.2-3.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.6">
              <p id="section-14.4.2-3.6.1">Security considerations: See the Security Considerations section
of RFC XXXX, and <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span><a href="#section-14.4.2-3.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.7">
              <p id="section-14.4.2-3.7.1">Interoperability considerations: n/a<a href="#section-14.4.2-3.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.8">
              <p id="section-14.4.2-3.8.1">Published specification: RFC XXXX<a href="#section-14.4.2-3.8.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.9">
              <p id="section-14.4.2-3.9.1">Applications that use this media type: TBD<a href="#section-14.4.2-3.9.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.10">
              <p id="section-14.4.2-3.10.1">Fragment identifier considerations: n/a<a href="#section-14.4.2-3.10.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.11">
              <p id="section-14.4.2-3.11.1">Additional information:<a href="#section-14.4.2-3.11.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.4.2-3.11.2.1">
                  <p id="section-14.4.2-3.11.2.1.1">Magic number(s): n/a<a href="#section-14.4.2-3.11.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-14.4.2-3.11.2.2">
                  <p id="section-14.4.2-3.11.2.2.1">File extension(s): n/a<a href="#section-14.4.2-3.11.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-14.4.2-3.11.2.3">
                  <p id="section-14.4.2-3.11.2.3.1">Macintosh file type code(s): n/a<a href="#section-14.4.2-3.11.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-14.4.2-3.12">
              <p id="section-14.4.2-3.12.1">Person &amp; email address to contact for further information:
Orie Steele, orie@transmute.industries<a href="#section-14.4.2-3.12.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.13">
              <p id="section-14.4.2-3.13.1">Intended usage: COMMON<a href="#section-14.4.2-3.13.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.14">
              <p id="section-14.4.2-3.14.1">Restrictions on usage: none<a href="#section-14.4.2-3.14.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.15">
              <p id="section-14.4.2-3.15.1">Author: Orie Steele, orie@transmute.industries<a href="#section-14.4.2-3.15.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.16">
              <p id="section-14.4.2-3.16.1">Change controller: IETF<a href="#section-14.4.2-3.16.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.4.2-3.17">
              <p id="section-14.4.2-3.17.1">Provisional registration?  No<a href="#section-14.4.2-3.17.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-15">
      <h2 id="name-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-15.1">
        <h3 id="name-normative-references">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BCP205">[BCP205]</dt>
        <dd>
<div class="refInstance">Best Current Practice 205, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp205">https://www.rfc-editor.org/info/bcp205</a>&gt;</span>.<br><span>At the time of writing, this BCP comprises the following:</span>
</div>
<div class="refInstance" id="RFC7942">
            <span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7942">https://www.rfc-editor.org/info/rfc7942</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cbor-edn-literals">[I-D.ietf-cbor-edn-literals]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"CBOR Extended Diagnostic Notation (EDN)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cbor-edn-literals-13</span>, <time datetime="2024-11-03" class="refDate">3 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-literals-13">https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-literals-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8747">https://www.rfc-editor.org/rfc/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9053">https://www.rfc-editor.org/rfc/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9596">[RFC9596]</dt>
      <dd>
<span class="refAuthor">Jones, M.B.</span> and <span class="refAuthor">O. Steele</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE) "typ" (type) Header Parameter"</span>, <span class="seriesInfo">RFC 9596</span>, <span class="seriesInfo">DOI 10.17487/RFC9596</span>, <time datetime="2024-06" class="refDate">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9596">https://www.rfc-editor.org/rfc/rfc9596</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-15.2">
        <h3 id="name-informative-references">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.draft-ietf-oauth-sd-jwt-vc">[I-D.draft-ietf-oauth-sd-jwt-vc]</dt>
        <dd>
<span class="refAuthor">Terbu, O.</span>, <span class="refAuthor">Fett, D.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"SD-JWT-based Verifiable Credentials (SD-JWT VC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-sd-jwt-vc-06</span>, <time datetime="2024-11-13" class="refDate">13 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-sd-jwt-vc-06">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-sd-jwt-vc-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-oauth-selective-disclosure-jwt">[I-D.draft-ietf-oauth-selective-disclosure-jwt]</dt>
      <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Yasuda, K.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"Selective Disclosure for JWTs (SD-JWT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-selective-disclosure-jwt-14</span>, <time datetime="2024-11-15" class="refDate">15 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-14">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="cddl">
<section id="appendix-A">
      <h2 id="name-complete-cddl-schema">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-complete-cddl-schema" class="section-name selfRef">Complete CDDL Schema</a>
      </h2>
<span id="name-a-complete-cddl-description"></span><div id="cddl-schema">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="appendix-A-1.1">
<pre>
sd-cwt-types = sd-cwt-presentation / sd-cwt-issued / kbt-cwt

sd-cwt-presentation = #6.18([
   protected: bstr .cbor sd-protected,
   unprotected-presentation,
   payload: bstr .cbor sd-payload,
   signature: bstr
])

sd-cwt-issued = #6.18([
   protected: bstr .cbor sd-protected,
   unprotected-issued,
   payload: bstr .cbor sd-payload,
   signature: bstr
])

kbt-cwt = #6.18([
   protected: bstr .cbor kbt-protected,
   kbt-unprotected,
   payload: bstr .cbor kbt-payload,
   signature: bstr
])

sd-protected = {
   &amp;(typ: 16) ^ =&gt; "application/sd+cwt",
   &amp;(alg: 1) ^ =&gt; int,
   * key =&gt; any
}

kbt-protected = {
   &amp;(typ: 16)^ =&gt; "application/kb+cwt",
   &amp;(alg: 1)^ =&gt; int,
   * key =&gt; any
}

salted-array = [ +bstr .cbor salted ]

unprotected-presentation = {
   &amp;(sd_kbt: TBD2) ^ =&gt; bstr .cbor kbt-cwt,
   ? &amp;(sd_claims: TBD1) ^ =&gt; bstr .cbor salted-array,
   * key =&gt; any
}

unprotected-issued = {
   ? &amp;(sd_claims: TBD1) ^ =&gt; bstr .cbor salted-array,
   * key =&gt; any
}

kbt-unprotected = {
   * key =&gt; any
}

sd-payload = {
    ; standard claims
      &amp;(iss: 1) ^ =&gt; tstr, ; "https://issuer.example"
      &amp;(sub: 2) ^ =&gt; tstr, ; "https://device.example"
      &amp;(aud: 3) ^ =&gt; tstr, ; "https://verifier.example"
    ? &amp;(exp: 4) ^ =&gt; int,  ; 1883000000
    ? &amp;(nbf: 5) ^ =&gt; int,  ; 1683000000
      &amp;(iat: 6) ^ =&gt; int,  ; 1683000000
      &amp;(cnf: 8) ^ =&gt; { * key =&gt; any }, ; key confirmation
    ? &amp;(cnonce: 39) ^ =&gt; bstr,
    ;
    ; sd-cwt new claims
      &amp;(sd_hash: TBD3) ^ =&gt; bstr,
      &amp;(sd_alg: TBD4) ^ =&gt; int,            ; -16 for sha-256
    ? &amp;(redacted_claim_keys: TBD5) ^ =&gt; [ * bstr ],
    * key =&gt; any
}

kbt-payload = {
      &amp;(aud: 3) ^ =&gt; tstr, ; "https://verifier.example"
    ? &amp;(exp: 4) ^ =&gt; int,  ; 1883000000
    ? &amp;(nbf: 5) ^ =&gt; int,  ; 1683000000
      &amp;(iat: 6) ^ =&gt; int,  ; 1683000000
      &amp;(cnonce: 39) ^ =&gt; bstr,
      &amp;(sd_hash: TBD3) ^ =&gt; bstr,
    * key =&gt; any
}

;redacted_claim_element = #6.60( bstr .size 16 )
salted = salted-claim / salted-element
salted-claim = [
  bstr ;.size 16,     ; 128-bit salt
  (int / text),      ; claim name
  any                ; claim value
]
salted-element = [
  bstr ;.size 16,     ; 128-bit salt
  any                ; claim value
]

key = int / text
TBD1 = 17
TBD2 = 18
TBD3 = 11
TBD4 = 12
TBD5 = -65536
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-a-complete-cddl-description" class="selfRef">A complete CDDL description of SD-CWT</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="comparison-to-sd-jwt">
<section id="appendix-B">
      <h2 id="name-comparison-to-sd-jwt">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-comparison-to-sd-jwt" class="section-name selfRef">Comparison to SD-JWT</a>
      </h2>
<p id="appendix-B-1">SD-CWT is modeled after SD-JWT, with adjustments to align with conventions in CBOR and COSE.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="media-types-1">
<section id="appendix-B.1">
        <h3 id="name-media-types-2">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-media-types-2" class="section-name selfRef">Media Types</a>
        </h3>
<p id="appendix-B.1-1">The COSE equivalent of <code>application/sd-jwt</code> is <code>application/sd+cwt</code>.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">THe COSE equivalent of <code>application/kb+jwt</code> is <code>application/kb+cwt</code>.<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redaction-claims">
<section id="appendix-B.2">
        <h3 id="name-redaction-claims">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-redaction-claims" class="section-name selfRef">Redaction Claims</a>
        </h3>
<p id="appendix-B.2-1">The COSE equivalent of <code>_sd</code> is TBD5 (requested assignment -65536).<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">The COSE equivalent of <code>...</code> is a CBOR tag (requested assignment 60) of the digested salted claim.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuance">
<section id="appendix-B.3">
        <h3 id="name-issuance">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-issuance" class="section-name selfRef">Issuance</a>
        </h3>
<p id="appendix-B.3-1">The issuance process for SD-CWT is similar to SD-JWT, with the exception that a confirmation claim is <span class="bcp14">REQUIRED</span>.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation">
<section id="appendix-B.4">
        <h3 id="name-presentation">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-presentation" class="section-name selfRef">Presentation</a>
        </h3>
<p id="appendix-B.4-1">The presentation process for SD-CWT is similar to SD-JWT, with the exception that a Key Binding Token is <span class="bcp14">REQUIRED</span>.<a href="#appendix-B.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validation">
<section id="appendix-B.5">
        <h3 id="name-validation">
<a href="#appendix-B.5" class="section-number selfRef">B.5. </a><a href="#name-validation" class="section-name selfRef">Validation</a>
        </h3>
<p id="appendix-B.5-1">The validation process for SD-JWT is similar to SD-JWT, however, JSON Objects are replaced with CBOR Maps which can contain integer keys and CBOR Tags.<a href="#appendix-B.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="keys-used-in-the-examples">
<section id="appendix-C">
      <h2 id="name-keys-used-in-the-examples">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-keys-used-in-the-examples" class="section-name selfRef">Keys used in the examples</a>
      </h2>
<div id="subject-holder">
<section id="appendix-C.1">
        <h3 id="name-subject-holder">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-subject-holder" class="section-name selfRef">Subject / Holder</a>
        </h3>
<p id="appendix-C.1-1">Holder key pair in JWK format<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-2">
<pre>
{
  "kty": "EC",
  "alg": "ES256",
  "kid": "WRQ2RbY5RYJCIxfDQL9agl9fFSCYVu4Xocqb6zerc1M",
  "crv": "P-256",
  "x": "hVTrJ13Nb70cesZBqiyQ2SAi_Q0wJLWvGMfMYa1Sei0",
  "y": "TceuLGd-ltDMgll2Vc6S1VA_VCk9h4ddHnnOR3AZQ0M",
  "d": "V1moblm7OwAt3kZ9pLUvPQbmws1DlFbPBIW5uGQpTOU"
}
</pre><a href="#appendix-C.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-3">Input to Holder public JWK thumbprint (ignore line breaks)<a href="#appendix-C.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-4">
<pre>
{"crv":"P-256","kty":"EC","x":"hVTrJ13Nb70cesZBqiyQ2SAi_Q0wJLWvGMfMYa1S
ei0","y":"TceuLGd-ltDMgll2Vc6S1VA_VCk9h4ddHnnOR3AZQ0M"}
</pre><a href="#appendix-C.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-5">SHA-256 of the Holder public JWK input string (in hex)<a href="#appendix-C.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-6">
<pre>
59143645b6394582422317c340bf5a825f5f15209856ee17a1ca9beb37ab7353
</pre><a href="#appendix-C.1-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-7">Holder public JWK thumbprint<a href="#appendix-C.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-8">
<pre>
WRQ2RbY5RYJCIxfDQL9agl9fFSCYVu4Xocqb6zerc1M
</pre><a href="#appendix-C.1-8" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-9">Holder public key in PEM format<a href="#appendix-C.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-10">
<pre>
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhVTrJ13Nb70cesZBqiyQ2SAi/Q0w
JLWvGMfMYa1Sei1Nx64sZ36W0MyCWXZVzpLVUD9UKT2Hh10eec5HcBlDQw==
-----END PUBLIC KEY-----
</pre><a href="#appendix-C.1-10" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-11">Hodler private key in PEM format<a href="#appendix-C.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-12">
<pre>
-----BEGIN PRIVATE KEY-----
MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgV1moblm7OwAt3kZ9
pLUvPQbmws1DlFbPBIW5uGQpTOWhRANCAASFVOsnXc1vvRx6xkGqLJDZICL9DTAk
ta8Yx8xhrVJ6LU3HrixnfpbQzIJZdlXOktVQP1QpPYeHXR55zkdwGUND
-----END PRIVATE KEY-----
</pre><a href="#appendix-C.1-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="issuer">
<section id="appendix-C.2">
        <h3 id="name-issuer">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-issuer" class="section-name selfRef">Issuer</a>
        </h3>
<p id="appendix-C.2-1">Issuer key pair in JWK format<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-2">
<pre>
{
"kty": "EC",
"alg": "ES384",
"kid": "https://issuer.example/cwk3.cbor",
"crv": "P-384",
"x":"wxeYsMeIX6NSj7-HfltMOm3GelpdxrMHtyjDclkm8qvl-0lkzZHjlIpUk_brtsu_",
"y":"j2x-x2FpHK03TE2qk4dFPxgFjs5Y6wqOhKBVox-3-SFLJ1CVIsFZ52T4cR4RYJVU",
"d":"ccVNIiGTfqYS2xIh8NPd93HJOBxOO-QdWqConWhfCc_vdMS78QR4P9V-h6sifQdM"
}
</pre><a href="#appendix-C.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-3">Input to Issuer JWK thumbprint (ignore line breaks)<a href="#appendix-C.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-4">
<pre>
{"crv":"P-384","kty":"EC","x":"wxeYsMeIX6NSj7-HfltMOm3GelpdxrMHtyjDclkm
8qvl-0lkzZHjlIpUk_brtsu_","y":"j2x-x2FpHK03TE2qk4dFPxgFjs5Y6wqOhKBVox-3
-SFLJ1CVIsFZ52T4cR4RYJVU"}
</pre><a href="#appendix-C.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-5">SHA-256 of the Issuer JWK input string (in hex)<a href="#appendix-C.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-6">
<pre>
18d4ddb7065d945357e3972dee76af4eddc7c285fb42efcfa900c6a4f8437850
</pre><a href="#appendix-C.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-7">Issuer JWK thumbprint<a href="#appendix-C.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-8">
<pre>
GNTdtwZdlFNX45ct7navTt3HwoX7Qu_PqQDGpPhDeFA
</pre><a href="#appendix-C.2-8" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-9">Issuer public key in PEM format<a href="#appendix-C.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-10">
<pre>
-----BEGIN PUBLIC KEY-----
MHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEwxeYsMeIX6NSj7+HfltMOm3GelpdxrMH
tyjDclkm8qvl+0lkzZHjlIpUk/brtsu/j2x+x2FpHK03TE2qk4dFPxgFjs5Y6wqO
hKBVox+3+SFLJ1CVIsFZ52T4cR4RYJVU
-----END PUBLIC KEY-----
</pre><a href="#appendix-C.2-10" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-11">Issuer private key in PEM format<a href="#appendix-C.2-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-12">
<pre>
-----BEGIN PRIVATE KEY-----
MIG2AgEAMBAGByqGSM49AgEGBSuBBAAiBIGeMIGbAgEBBDBxxU0iIZN+phLbEiHw
0933cck4HE475B1aoKidaF8Jz+90xLvxBHg/1X6HqyJ9B0yhZANiAATDF5iwx4hf
o1KPv4d+W0w6bcZ6Wl3Gswe3KMNyWSbyq+X7SWTNkeOUilST9uu2y7+PbH7HYWkc
rTdMTaqTh0U/GAWOzljrCo6EoFWjH7f5IUsnUJUiwVnnZPhxHhFglVQ=
-----END PRIVATE KEY-----
</pre><a href="#appendix-C.2-12" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="document-history">
<section id="appendix-D">
      <h2 id="name-document-history">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-D-1">-00<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-2.1">
          <p id="appendix-D-2.1.1">Initial working group version based on draft-prorock-spice-cose-sd-cwt-01.<a href="#appendix-D-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-E">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-E-1">The authors would like to thank those that have worked on similar items for
providing selective disclosure mechanisms in JSON, especially:
Brent Zundel, Roy Williams, Tobias Looker, Kristina Yasuda, Daniel Fett,
Brian Campbell, Oliver Terbu, and Michael Jones.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Prorock</span></div>
<div dir="auto" class="left"><span class="org">mesur.io</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mprorock@mesur.io" class="email">mprorock@mesur.io</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Orie Steele</span></div>
<div dir="auto" class="left"><span class="org">Transmute</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:orie@transmute.industries" class="email">orie@transmute.industries</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div dir="auto" class="left"><span class="street-address">Rheinstrasse 75</span></div>
<div dir="auto" class="left">
<span class="postal-code">64295</span> <span class="locality">Darmstadt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@ietf.contact" class="email">henk.birkholz@ietf.contact</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rohan Mahy</span></div>
<div dir="auto" class="left"><span class="org">Rohan Mahy Consulting Services</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rohan.ietf@gmail.com" class="email">rohan.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
