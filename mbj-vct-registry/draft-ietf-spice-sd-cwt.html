<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>SPICE SD-CWT</title>
<meta content="Michael Prorock" name="author">
<meta content="Orie Steele" name="author">
<meta content="Henk Birkholz" name="author">
<meta content="Rohan Mahy" name="author">
<meta content="
       This specification describes a data minimization technique for use with CBOR Web Tokens (CWTs).
The approach is based on the Selective Disclosure JSON Web Token (SD-JWT), with changes to align with CBOR Object Signing and Encryption (COSE) and CWTs. 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="cose" name="keyword">
<meta content="cwt" name="keyword">
<meta content="selective disclosure" name="keyword">
<meta content="draft-ietf-spice-sd-cwt-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.12.10
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-spice-sd-cwt.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SPICE SD-CWT</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Prorock, et al.</td>
<td class="center">Expires 17 December 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Secure Patterns for Internet CrEdentials</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-spice-sd-cwt-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06-15" class="published">15 June 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-12-17">17 December 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Prorock</div>
<div class="org">mesur.io</div>
</div>
<div class="author">
      <div class="author-name">O. Steele</div>
<div class="org">Transmute</div>
</div>
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">R. Mahy</div>
<div class="org">Rohan Mahy Consulting Services</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">SPICE SD-CWT</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification describes a data minimization technique for use with CBOR Web Tokens (CWTs).
The approach is based on the Selective Disclosure JSON Web Token (SD-JWT), with changes to align with CBOR Object Signing and Encryption (COSE) and CWTs.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://ietf-wg-spice.github.io/draft-ietf-spice-sd-cwt/draft-ietf-spice-sd-cwt.html">https://ietf-wg-spice.github.io/draft-ietf-spice-sd-cwt/draft-ietf-spice-sd-cwt.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-spice-sd-cwt/">https://datatracker.ietf.org/doc/draft-ietf-spice-sd-cwt/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Secure Patterns for Internet CrEdentials Working Group mailing list (<span><a href="mailto:spice@ietf.org">mailto:spice@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/spice/">https://mailarchive.ietf.org/arch/browse/spice/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/spice/">https://www.ietf.org/mailman/listinfo/spice/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ietf-wg-spice/draft-ietf-spice-sd-cwt">https://github.com/ietf-wg-spice/draft-ietf-spice-sd-cwt</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 17 December 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-high-level-flow" class="internal xref">High-Level Flow</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-overview-of-selective-discl" class="internal xref">Overview of Selective Disclosure CWT</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-a-cwt-without-selective-dis" class="internal xref">A CWT without Selective Disclosure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-holder-gets-an-sd-cwt-from-" class="internal xref">Holder gets an SD-CWT from the Issuer</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-holder-prepares-an-sd-cwt-f" class="internal xref">Holder prepares an SD-CWT for a Verifier</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-differences-from-the-cbor-w" class="internal xref">Differences from the CBOR Web Token Specification</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-sd-cwt-definition" class="internal xref">SD-CWT Definition</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-types-of-blinded-claims" class="internal xref">Types of Blinded Claims</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-sd-cwt-issuance" class="internal xref">SD-CWT Issuance</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-issuer-generation" class="internal xref">Issuer Generation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-holder-validation" class="internal xref">Holder Validation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-sd-cwt-presentation" class="internal xref">SD-CWT Presentation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-creating-a-key-binding-toke" class="internal xref">Creating a Key Binding Token</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-sd-kbt-and-sd-cwt-verifier-" class="internal xref">SD-KBT and SD-CWT Verifier Validation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-decoy-digests" class="internal xref">Decoy Digests</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-encrypted-disclosures" class="internal xref">Encrypted Disclosures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-aead-encrypted-disclosures" class="internal xref">AEAD Encrypted Disclosures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-cose-encrypted-disclosures" class="internal xref">COSE Encrypted Disclosures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-credential-types" class="internal xref">Credential Types</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-minimal-spanning-example" class="internal xref">Minimal Spanning Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-nested-example" class="internal xref">Nested Example</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-transparency" class="internal xref">Transparency</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-correlation" class="internal xref">Correlation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-14.3" class="auto internal xref">14.3</a>.  <a href="#name-credential-types-2" class="internal xref">Credential Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#section-14.4" class="auto internal xref">14.4</a>.  <a href="#name-determinism-augmentation" class="internal xref">Determinism &amp; Augmentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#section-14.5" class="auto internal xref">14.5</a>.  <a href="#name-threat-model" class="internal xref">Threat Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#section-14.6" class="auto internal xref">14.6</a>.  <a href="#name-random-numbers" class="internal xref">Random Numbers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.7">
                <p id="section-toc.1-1.14.2.7.1"><a href="#section-14.7" class="auto internal xref">14.7</a>.  <a href="#name-binding-the-kbt-and-the-cwt" class="internal xref">Binding the KBT and the CWT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.8">
                <p id="section-toc.1-1.14.2.8.1"><a href="#section-14.8" class="auto internal xref">14.8</a>.  <a href="#name-covert-channels" class="internal xref">Covert Channels</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.9">
                <p id="section-toc.1-1.14.2.9.1"><a href="#section-14.9" class="auto internal xref">14.9</a>.  <a href="#name-nested-disclosure-ordering" class="internal xref">Nested Disclosure Ordering</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.10">
                <p id="section-toc.1-1.14.2.10.1"><a href="#section-14.10" class="auto internal xref">14.10</a>. <a href="#name-audience" class="internal xref">Audience</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-cose-header-parameters" class="internal xref">COSE Header Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1.2.1">
                    <p id="section-toc.1-1.15.2.1.2.1.1"><a href="#section-15.1.1" class="auto internal xref">15.1.1</a>.  <a href="#name-sd_claims" class="internal xref">sd_claims</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1.2.2">
                    <p id="section-toc.1-1.15.2.1.2.2.1"><a href="#section-15.1.2" class="auto internal xref">15.1.2</a>.  <a href="#name-sd_alg" class="internal xref">sd_alg</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1.2.3">
                    <p id="section-toc.1-1.15.2.1.2.3.1"><a href="#section-15.1.3" class="auto internal xref">15.1.3</a>.  <a href="#name-sd_encrypted_claims" class="internal xref">sd_encrypted_claims</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1.2.4">
                    <p id="section-toc.1-1.15.2.1.2.4.1"><a href="#section-15.1.4" class="auto internal xref">15.1.4</a>.  <a href="#name-sd_aead" class="internal xref">sd_aead</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1.2.5">
                    <p id="section-toc.1-1.15.2.1.2.5.1"><a href="#section-15.1.5" class="auto internal xref">15.1.5</a>.  <a href="#name-sd_cose_encrypted_claims" class="internal xref">sd_cose_encrypted_claims</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-cbor-simple-values" class="internal xref">CBOR Simple Values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#section-15.3" class="auto internal xref">15.3</a>.  <a href="#name-cbor-tags" class="internal xref">CBOR Tags</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3.2.1">
                    <p id="section-toc.1-1.15.2.3.2.1.1"><a href="#section-15.3.1" class="auto internal xref">15.3.1</a>.  <a href="#name-to-be-redacted-tag" class="internal xref">To Be Redacted Tag</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3.2.2">
                    <p id="section-toc.1-1.15.2.3.2.2.1"><a href="#section-15.3.2" class="auto internal xref">15.3.2</a>.  <a href="#name-redacted-claim-element-tag" class="internal xref">Redacted Claim Element Tag</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#section-15.4" class="auto internal xref">15.4</a>.  <a href="#name-cbor-web-token-cwt-claims" class="internal xref">CBOR Web Token (CWT) Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4.2.1">
                    <p id="section-toc.1-1.15.2.4.2.1.1"><a href="#section-15.4.1" class="auto internal xref">15.4.1</a>.  <a href="#name-vct" class="internal xref">vct</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a href="#section-15.5" class="auto internal xref">15.5</a>.  <a href="#name-media-types" class="internal xref">Media Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5.2.1">
                    <p id="section-toc.1-1.15.2.5.2.1.1"><a href="#section-15.5.1" class="auto internal xref">15.5.1</a>.  <a href="#name-application-sdcwt" class="internal xref">application/sd+cwt</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5.2.2">
                    <p id="section-toc.1-1.15.2.5.2.2.1"><a href="#section-15.5.2" class="auto internal xref">15.5.2</a>.  <a href="#name-application-kbcwt" class="internal xref">application/kb+cwt</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6">
                <p id="section-toc.1-1.15.2.6.1"><a href="#section-15.6" class="auto internal xref">15.6</a>.  <a href="#name-content-formats" class="internal xref">Content-Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.7">
                <p id="section-toc.1-1.15.2.7.1"><a href="#section-15.7" class="auto internal xref">15.7</a>.  <a href="#name-verifiable-credential-type-" class="internal xref">Verifiable Credential Type Identifiers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.7.2.1">
                    <p id="section-toc.1-1.15.2.7.2.1.1"><a href="#section-15.7.1" class="auto internal xref">15.7.1</a>.  <a href="#name-registration-template" class="internal xref">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.7.2.2">
                    <p id="section-toc.1-1.15.2.7.2.2.1"><a href="#section-15.7.2" class="auto internal xref">15.7.2</a>.  <a href="#name-initial-registry-contents" class="internal xref">Initial Registry Contents</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref">16</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#section-16.1" class="auto internal xref">16.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#section-16.2" class="auto internal xref">16.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-complete-cddl-schema" class="internal xref">Complete CDDL Schema</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-comparison-to-sd-jwt" class="internal xref">Comparison to SD-JWT</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-media-types-2" class="internal xref">Media Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-redaction-claims" class="internal xref">Redaction Claims</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3">
                <p id="section-toc.1-1.18.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-issuance" class="internal xref">Issuance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.4">
                <p id="section-toc.1-1.18.2.4.1"><a href="#appendix-B.4" class="auto internal xref">B.4</a>.  <a href="#name-presentation" class="internal xref">Presentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.5">
                <p id="section-toc.1-1.18.2.5.1"><a href="#appendix-B.5" class="auto internal xref">B.5</a>.  <a href="#name-validation" class="internal xref">Validation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-keys-used-in-the-examples" class="internal xref">Keys Used in the Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-subject-holder" class="internal xref">Subject / Holder</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-issuer" class="internal xref">Issuer</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1">
                <p id="section-toc.1-1.20.2.1.1"><a href="#appendix-D.1" class="auto internal xref">D.1</a>.  <a href="#name-transmute-prototype" class="internal xref">Transmute Prototype</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2">
                <p id="section-toc.1-1.20.2.2.1"><a href="#appendix-D.2" class="auto internal xref">D.2</a>.  <a href="#name-rust-prototype" class="internal xref">Rust Prototype</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.1">
                <p id="section-toc.1-1.21.2.1.1"><a href="#appendix-E.1" class="auto internal xref">E.1</a>.  <a href="#name-draft-ietf-spice-sd-cwt-04" class="internal xref">draft-ietf-spice-sd-cwt-04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.2">
                <p id="section-toc.1-1.21.2.2.1"><a href="#appendix-E.2" class="auto internal xref">E.2</a>.  <a href="#name-draft-ietf-spice-sd-cwt-03" class="internal xref">draft-ietf-spice-sd-cwt-03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.3">
                <p id="section-toc.1-1.21.2.3.1"><a href="#appendix-E.3" class="auto internal xref">E.3</a>.  <a href="#name-draft-ietf-spice-sd-cwt-02" class="internal xref">draft-ietf-spice-sd-cwt-02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.4">
                <p id="section-toc.1-1.21.2.4.1"><a href="#appendix-E.4" class="auto internal xref">E.4</a>.  <a href="#name-draft-ietf-spice-sd-cwt-01" class="internal xref">draft-ietf-spice-sd-cwt-01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.5">
                <p id="section-toc.1-1.21.2.5.1"><a href="#appendix-E.5" class="auto internal xref">E.5</a>.  <a href="#name-draft-ietf-spice-sd-cwt-00" class="internal xref">draft-ietf-spice-sd-cwt-00</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#appendix-G" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This specification creates a new format based on the CBOR Web Token (CWT) specification <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, enabling the holder of a CWT to disclose or redact special claims marked as selectively disclosable by the issuer of a CWT.
The approach is modeled after SD-JWT <span>[<a href="#I-D.draft-ietf-oauth-selective-disclosure-jwt" class="cite xref">I-D.draft-ietf-oauth-selective-disclosure-jwt</a>]</span>, with changes to align with conventions from CBOR Object Signing and Encryption (COSE) <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span> and CWT.
This specification enables Holders of CWT-based credentials to prove the integrity and authenticity of selected attributes asserted by an Issuer about a Subject to a Verifier.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Although techniques such as one time use and batch issuance can improve the confidentiality and security characteristics of CWT-based credential protocols, SD-CWTs remain traceable.
Selective Disclosure CBOR Web Tokens (SD-CWTs) can be deployed in protocols that are already using CWTs with minor changes, even if they contain no optional to disclose claims.
Credential types are distinguished by their attributes, for example, a license to operate a vehicle and a license to import a product will contain different attributes.
The specification of credential types is out of scope for this specification, and the examples used in this specification are informative.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">SD-CWT operates on CWT Claims Sets as described in <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.
CWT Claims Sets contain Claim Keys and Claim Values.
SD-CWT enables Issuers to mark certain Claim Keys or Claim Values mandatory or optional for a holder of a CWT to disclose.
A verifier that does not understand selective disclosure at all cannot process redacted Claim Keys sent by the Holder.
However, Claim Keys and Claim Values that are not understood remain ignored, as described in <span><a href="https://rfc-editor.org/rfc/rfc8392#section-3" class="relref">Section 3</a> of [<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="high-level-flow">
<section id="section-1.1">
        <h3 id="name-high-level-flow">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-high-level-flow" class="section-name selfRef">High-Level Flow</a>
        </h3>
<p id="section-1.1-1">Figure 1: High-level SD-CWT Issuance and Presentation Flow<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<div id="section-1.1-2">
          <div class="alignLeft art-svg artwork" id="section-1.1-2.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="400" width="584" viewBox="0 0 584 400" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 24,48 L 24,384" fill="none" stroke="black"></path>
              <path d="M 288,48 L 288,384" fill="none" stroke="black"></path>
              <path d="M 320,64 L 320,96" fill="none" stroke="black"></path>
              <path d="M 320,224 L 320,256" fill="none" stroke="black"></path>
              <path d="M 320,288 L 320,320" fill="none" stroke="black"></path>
              <path d="M 560,48 L 560,384" fill="none" stroke="black"></path>
              <path d="M 288,64 L 320,64" fill="none" stroke="black"></path>
              <path d="M 296,96 L 320,96" fill="none" stroke="black"></path>
              <path d="M 32,112 L 280,112" fill="none" stroke="black"></path>
              <path d="M 24,144 L 280,144" fill="none" stroke="black"></path>
              <path d="M 288,160 L 552,160" fill="none" stroke="black"></path>
              <path d="M 296,192 L 560,192" fill="none" stroke="black"></path>
              <path d="M 288,224 L 320,224" fill="none" stroke="black"></path>
              <path d="M 296,256 L 320,256" fill="none" stroke="black"></path>
              <path d="M 288,288 L 320,288" fill="none" stroke="black"></path>
              <path d="M 296,320 L 320,320" fill="none" stroke="black"></path>
              <path d="M 288,368 L 552,368" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="560,368 548,362.4 548,373.6" fill="black" transform="rotate(0,552,368)"></polygon>
              <polygon class="arrowhead" points="560,160 548,154.4 548,165.6" fill="black" transform="rotate(0,552,160)"></polygon>
              <polygon class="arrowhead" points="304,320 292,314.4 292,325.6" fill="black" transform="rotate(180,296,320)"></polygon>
              <polygon class="arrowhead" points="304,256 292,250.4 292,261.6" fill="black" transform="rotate(180,296,256)"></polygon>
              <polygon class="arrowhead" points="304,192 292,186.4 292,197.6" fill="black" transform="rotate(180,296,192)"></polygon>
              <polygon class="arrowhead" points="304,96 292,90.4 292,101.6" fill="black" transform="rotate(180,296,96)"></polygon>
              <polygon class="arrowhead" points="288,144 276,138.4 276,149.6" fill="black" transform="rotate(0,280,144)"></polygon>
              <polygon class="arrowhead" points="40,112 28,106.4 28,117.6" fill="black" transform="rotate(180,32,112)"></polygon>
              <g class="text">
                <text x="28" y="36">Issuer</text>
                <text x="292" y="36">Holder</text>
                <text x="548" y="36">Verifier</text>
                <text x="344" y="84">Key</text>
                <text x="376" y="84">Gen</text>
                <text x="120" y="100">Request</text>
                <text x="180" y="100">SD-CWT</text>
                <text x="424" y="148">Request</text>
                <text x="480" y="148">Nonce</text>
                <text x="120" y="164">Receive</text>
                <text x="180" y="164">SD-CWT</text>
                <text x="424" y="212">Receive</text>
                <text x="480" y="212">Nonce</text>
                <text x="356" y="244">Redact</text>
                <text x="412" y="244">Claims</text>
                <text x="376" y="308">Demonstrate</text>
                <text x="368" y="324">Posession</text>
                <text x="424" y="356">Present</text>
                <text x="484" y="356">SD-CWT</text>
              </g>
            </svg><a href="#section-1.1-2.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-1.1-3">This diagram captures the essential details necessary to issue and present an SD-CWT.
The parameters necessary to support these processes can be obtained using transports or protocols that are out of scope for this specification.
However, the following guidance is generally recommended, regardless of protocol or transport.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1-4">
<li id="section-1.1-4.1">
            <p id="section-1.1-4.1.1">The issuer <span class="bcp14">SHOULD</span> confirm the holder controls all confirmation material before issuing credentials using the <code>cnf</code> claim.<a href="#section-1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.1-4.2">
            <p id="section-1.1-4.2.1">To protect against replay attacks, the verifier <span class="bcp14">SHOULD</span> provide a nonce, and reject requests that do not include an acceptable nonce (cnonce). This guidance can be ignored in cases where replay attacks are mitigated at another layer.<a href="#section-1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This specification uses terms from CWT <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span> <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>
and JWT <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The terms Claim Name, Claim Key, and Claim Value are defined in <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">This specification defines the following new terms:<a href="#section-2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-5">
        <dt id="section-2-5.1">Selective Disclosure CBOR Web Token (SD-CWT):</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.2">
          <p id="section-2-5.2.1">A CWT with claims enabling selective disclosure with key binding.<a href="#section-2-5.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.3">Selective Disclosure Key Binding Token (SD-CWT-KBT):</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.4">
          <p id="section-2-5.4.1">A CWT used to demonstrate possession of a confirmation method, associated with an SD-CWT.<a href="#section-2-5.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.5">Issuer:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.6">
          <p id="section-2-5.6.1">An entity that produces a Selective Disclosure CBOR Web Token.<a href="#section-2-5.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.7">Holder:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.8">
          <p id="section-2-5.8.1">An entity that presents a Selective Disclosure CBOR Web Token that includes a Selective Disclosure Key Binding Token.<a href="#section-2-5.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.9">Verifier:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.10">
          <p id="section-2-5.10.1">An entity that validates a Partial or Full Disclosure by a Holder.<a href="#section-2-5.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.11">Partial Disclosure:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.12">
          <p id="section-2-5.12.1">When a subset of the original claims, protected by the Issuer, are disclosed by the Holder.<a href="#section-2-5.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.13">Full Disclosure:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.14">
          <p id="section-2-5.14.1">When the full set of claims protected by the Issuer is disclosed by the Holder. An SD-CWT with no blinded claims (when all claims are marked as mandatory to disclose by the Issuer) is considered a Full Disclosure.<a href="#section-2-5.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.15">Salted Disclosed Claim:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.16">
          <p id="section-2-5.16.1">A salted claim disclosed in the unprotected header of an SD-CWT.<a href="#section-2-5.16.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.17">Digested Salted Disclosed Claim / Blinded Claim Hash:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.18">
          <p id="section-2-5.18.1">A hash digest of a Salted Disclosed Claim.<a href="#section-2-5.18.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.19">Blinded Claim:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.20">
          <p id="section-2-5.20.1">Any Redacted Claim Key or Redacted Claim Element that has been replaced in the
CWT payload by a Blinded Claim Hash.<a href="#section-2-5.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.21">Redacted Claim Key:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.22">
          <p id="section-2-5.22.1">The hash of a claim redacted from a map data structure.<a href="#section-2-5.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.23">Redacted Claim Element:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.24">
          <p id="section-2-5.24.1">The hash of an element redacted from an array data structure.<a href="#section-2-5.24.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.25">Presented Disclosed Claims Set:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.26">
          <p id="section-2-5.26.1">The CBOR map containing zero or more Redacted Claim Keys or Redacted Claim Elements.<a href="#section-2-5.26.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-5.27">Validated Disclosed Claims Set:</dt>
        <dd style="margin-left: 1.5em" id="section-2-5.28">
          <p id="section-2-5.28.1">The CBOR map containing all mandatory to disclose claims signed by the issuer, all selectively disclosed claims presented by the holder, and omitting all undisclosed instances of Redacted Claim Keys and Redacted Claim Element claims that are present in the original SD-CWT.<a href="#section-2-5.28.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="overview-of-selective-disclosure-cwt">
<section id="section-3">
      <h2 id="name-overview-of-selective-discl">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview-of-selective-discl" class="section-name selfRef">Overview of Selective Disclosure CWT</a>
      </h2>
<div id="a-cwt-without-selective-disclosure">
<section id="section-3.1">
        <h3 id="name-a-cwt-without-selective-dis">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-a-cwt-without-selective-dis" class="section-name selfRef">A CWT without Selective Disclosure</a>
        </h3>
<p id="section-3.1-1">Below is the payload of a standard CWT not using selective disclosure.
It consists of standard CWT claims, the holder confirmation key, and five specific custom claims. The payload is shown below in CBOR Extended Diagnostic
Notation (EDN) <span>[<a href="#I-D.ietf-cbor-edn-literals" class="cite xref">I-D.ietf-cbor-edn-literals</a>]</span>. Note that some of the CWT claim map keys shown in the examples have been invented for this example and do not have registered integer keys.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-3.1-2">
<pre>
{
    / iss / 1  : "https://issuer.example",
    / sub / 2  : "https://device.example",
    / exp / 4  : 1725330600, /2024-09-02T19:30:00Z/
    / nbf / 5  : 1725243840, /2024-09-01T19:25:00Z/
    / iat / 6  : 1725244200, /2024-09-01T19:30:00Z/
    / cnf / 8  : {
      / cose key / 1 : {
        / kty /  1: 2,  / EC2   /
        / crv / -1: 1,  / P-256 /
        / x /   -2: h'8554eb275dcd6fbd1c7ac641aa2c90d9
                      2022fd0d3024b5af18c7cc61ad527a2d',
        / y /   -3: h'4dc7ae2c677e96d0cc82597655ce92d5
                      503f54293d87875d1e79ce4770194343'
      }
    },
    /most_recent_inspection_passed/ 500: true,
    /inspector_license_number/ 501: "ABCD-123456",
    /inspection_dates/ 502 : [
        1549560720,   / 2019-02-07T17:32:00 /
        1612498440,   / 2021-02-04T20:14:00 /
        1674004740,   / 2023-01-17T17:19:00 /
    ],
    /inspection_location/ 503: {
        "country": "us",            / United States /
        "region": "ca",             / California /
        "postal_code": "94188"
    }
}
</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1-3">The custom claims deal with attributes of an inspection of the subject: the pass/fail result, the inspection location, the license number of the inspector, and a list of dates when the subject was inspected.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="holder-gets-an-sd-cwt-from-the-issuer">
<section id="section-3.2">
        <h3 id="name-holder-gets-an-sd-cwt-from-">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-holder-gets-an-sd-cwt-from-" class="section-name selfRef">Holder gets an SD-CWT from the Issuer</a>
        </h3>
<p id="section-3.2-1">Alice would like to selectively disclose some of these (custom) claims to different verifiers.
Note that some of the claims may not be selectively disclosable.
In our next example, the pass/fail status of the inspection, the most recent inspection date, and the country of the inspection will be claims that are always present in the SD-CWT.
After the Holder requests an SD-CWT from the issuer, the issuer generates the following SD-CWT:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span id="name-issued-sd-cwt-with-all-disc"></span><div id="basic-issuer-cwt">
<figure id="figure-1">
          <div class="breakable lang-cbor-diag sourcecode" id="section-3.2-2.1">
<pre>
/ cose-sign1 / 18([  / issuer SD-CWT /
  / CWT protected / &lt;&lt; {
    / alg /    1  : -35, / ES384 /
    / typ /    16 : "application/sd+cwt",
    / kid /    4  : 'https://issuer.example/cwt-key3',
    / sd_alg / 18 : -16  / SHA256 /
  } &gt;&gt;,
  / CWT unprotected / {
    / sd_claims / 17 : [ / these are all the disclosures /
        &lt;&lt;[
            /salt/   h'bae611067bb823486797da1ebbb52f83',
            /value/  "ABCD-123456",
            /claim/  501   / inspector_license_number /
        ]&gt;&gt;,
        &lt;&lt;[
            /salt/   h'8de86a012b3043ae6e4457b9e1aaab80',
            /value/  1549560720   / inspected 7-Feb-2019 /
        ]&gt;&gt;,
        &lt;&lt;[
            /salt/   h'7af7084b50badeb57d49ea34627c7a52',
            /value/  1612560720   / inspected 4-Feb-2021 /
        ]&gt;&gt;,
        &lt;&lt;[
            /salt/   h'ec615c3035d5a4ff2f5ae29ded683c8e',
            /value/  "ca",
            /claim/  "region"   / region=California /
        ]&gt;&gt;,
        &lt;&lt;[
            /salt/   h'37c23d4ec4db0806601e6b6dc6670df9',
            /value/  "94188",
            /claim/  "postal_code"
        ]&gt;&gt;,
    ]
  }
  / CWT payload / &lt;&lt; {
    / iss / 1   : "https://issuer.example",
    / sub / 2   : "https://device.example",
    / exp / 4   : 1725330600,  /2024-09-03T02:30:00+00:00Z/
    / nbf / 5   : 1725243900,  /2024-09-02T02:25:00+00:00Z/
    / iat / 6   : 1725244200,  /2024-09-02T02:30:00+00:00Z/
    / cnf / 8   : {
      / cose key / 1 : {
        / kty /  1: 2,  / EC2   /
        / crv / -1: 1,  / P-256 /
        / x /   -2: h'8554eb275dcd6fbd1c7ac641aa2c90d9
                      2022fd0d3024b5af18c7cc61ad527a2d',
        / y /   -3: h'4dc7ae2c677e96d0cc82597655ce92d5
                      503f54293d87875d1e79ce4770194343'
      }
    },
    /most_recent_inspection_passed/ 500: true,
    / redacted_claim_keys / simple(59) : [
        / redacted inspector_license_number /
        h'3fc9748e00684e6442641e58ea965468
          085024da253ed46b507ae56d4c204434'
    ],
    /inspection_dates/ 502 : [
        / redacted inspection date 7-Feb-2019 /
        60(h'f468b68dd7432030d7f33a8783acb3a4
             d6afc215bbc184dce8831c64b539f335'),
        / redacted inspection date 4-Feb-2021 /
        60(h'0839dcbdd9ed55c8aac3e573ccf59c81
             0fa8d9f6ec551cb9737621faf3584e1f'),
        1674004740,   / 2023-01-17T17:19:00 /
    ],
    / inspection_location / 503 : {
        "country" : "us",            / United States /
        / redacted_claim_keys / simple(59) : [
            / redacted region /
            h'2ff24f519a1bdfc66292263de2415a36
              6b9a4302d2a9f36b9791f8eab1867513'
            / redacted postal_code /
            h'f907645d118184af56331cb07b7b8c31
              826ac7d18d051bcec37a3a8afb8581c3'
      ]
    }
  } &gt;&gt;,
  / CWT signature / h'9280a520b8686183bf72cd07c714e603
                      ff0975b357975a1391de51a248d554e1
                      b93d0d101edb6bf11a4a98aa9714d823
                      c84d1d6c438e5d733a4f67c16e1ff030
                      ae3f4b1c546ecc9e9add168da97e32e1
                      c5b8de5b873c9572ecb9f219399c5a9f'
])
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-issued-sd-cwt-with-all-disc" class="selfRef">Issued SD-CWT with all disclosures</a>
          </figcaption></figure>
</div>
<p id="section-3.2-3">Some of the claims are <em>redacted</em> in the payload. The corresponding <em>disclosure</em> is communicated in the unprotected header in the <code>sd_claims</code> header parameter.
For example, the <code>inspector_license_number</code> claim is a Salted Disclosed Claim, consisting of a per-disclosure random salt, the claim name, and claim value.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<span id="name-cbor-extended-diagnostic-no"></span><figure id="figure-2">
          <div class="lang-cbor-diag sourcecode" id="section-3.2-4.1">
<pre>
        &lt;&lt;[
            /salt/   h'bae611067bb823486797da1ebbb52f83',
            /value/  "ABCD-123456",
            /claim/  501   / inspector_license_number /
        ]&gt;&gt;,
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-cbor-extended-diagnostic-no" class="selfRef">CBOR extended diagnostic notation representation of inspector_license_number disclosure</a>
          </figcaption></figure>
<p id="section-3.2-5">This is represented in CBOR pretty-printed format as follows (with end-of-line comments and spaces inserted for clarity):<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<span id="name-cbor-encoding-of-inspector_"></span><figure id="figure-3">
          <div class="lang-cbor-pretty sourcecode" id="section-3.2-6.1">
<pre>
83                                     # array(3)
   50                                  # bytes(16)
      bae611067bb823486797da1ebbb52f83 # 16-byte salt
   6b                                  # text(11)
      414243442d313233343536           # "ABCD-123456"
   19 01f5                             # unsigned(501)
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-cbor-encoding-of-inspector_" class="selfRef">CBOR encoding of inspector_license_number disclosure</a>
          </figcaption></figure>
<p id="section-3.2-7">The SHA-256 hash (the hash algorithm identified in the <code>sd_alg</code> header parameter of the protected headers) of that byte string is the Digested Salted Disclosed Claim (in hex).
The digest value is included in the payload in a <code>redacted_claim_keys</code> field for a Redacted Claim Key (in this example), or in a named array for a Redacted Claim Element (for example, for the redacted claim element of <code>inspection_dates</code>).<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<span id="name-sha-256-hash-of-inspector_l"></span><figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-3.2-8.1">
<pre>
d9df03da474fcb3c65771748e2e0608cf437504ecc24f450aaeacd40dd552b3f
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-sha-256-hash-of-inspector_l" class="selfRef">SHA-256 hash of inspector_license_number disclosure</a>
          </figcaption></figure>
<p id="section-3.2-9">Finally, since this redacted claim is a map key and value, the Digested Salted Disclosed Claim is placed in a <code>redacted_claim_keys</code> array in the SD-CWT payload at the same level of hierarchy as the original claim.
Redacted claims that are array elements are handled slightly differently, as described in <a href="#blinded-claims" class="auto internal xref">Section 6.1</a>.<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<span id="name-redacted-inspector_license_"></span><figure id="figure-5">
          <div class="lang-cbor-diag sourcecode" id="section-3.2-10.1">
<pre>
  / redacted_claim_keys / simple(59) : [
      / redacted inspector_license_number /
      h'd9df03da474fcb3c65771748e2e0608c
        f437504ecc24f450aaeacd40dd552b3f',
      / ... next redacted claim at the same level would go here /  ],
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-redacted-inspector_license_" class="selfRef">redacted inspector_license_number claim in the issued CWT payload</a>
          </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="sd-cwt-preparation">
<section id="section-4">
      <h2 id="name-holder-prepares-an-sd-cwt-f">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-holder-prepares-an-sd-cwt-f" class="section-name selfRef">Holder prepares an SD-CWT for a Verifier</a>
      </h2>
<p id="section-4-1">When the Holder wants to send an SD-CWT and disclose none, some, or all of the redacted values, it makes a list of the values to disclose and puts them in <code>sd_claims</code> header parameter in the unprotected header.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">For example, Alice decides to disclose to a verifier the <code>inspector_license_number</code> claim (ABCD-123456), the <code>region</code> claim (California), and the earliest date element in the <code>inspection_dates</code> array (7-Feb-2019).<a href="#section-4-2" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-4-3">
<pre>
    / sd_claims / 17 : [ / these are the disclosures /
        &lt;&lt;[
            /salt/   h'bae611067bb823486797da1ebbb52f83',
            /value/  "ABCD-123456",
            /claim/  501   / inspector_license_number /
        ]&gt;&gt;,
        &lt;&lt;[
            /salt/   h'8de86a012b3043ae6e4457b9e1aaab80',
            /value/  1549560720   / inspected 7-Feb-2019 /
        ]&gt;&gt;,
        &lt;&lt;[
            /salt/   h'ec615c3035d5a4ff2f5ae29ded683c8e',
            /value/  "ca",
            /claim/  "region"   / region=California /
        ]&gt;&gt;,
    ]
</pre><a href="#section-4-3" class="pilcrow">¶</a>
</div>
<p id="section-4-4">The Holder <span class="bcp14">MAY</span> fetch a nonce from the Verifier to prevent replay, or obtain a nonce acceptable to the verifier through a process similar to the method described in <span>[<a href="#I-D.ietf-httpbis-unprompted-auth" class="cite xref">I-D.ietf-httpbis-unprompted-auth</a>]</span>.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">Finally, the Holder generates a Selective Disclosure Key Binding Token (SD-KBT) that ties together the SD-CWT generated by the Issuer (with the disclosures the Holder chose for the Verifier in its unprotected header), the Verifier target audience and optional nonces, and proof of possession of the Holder's private key.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">The issued SD-CWT is placed in the <code>kcwt</code> (Confirmation Key CWT) protected header field (defined in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>).<a href="#section-4-6" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-4-7">
<pre>
/ cose-sign1 / 18( / sd_kbt / [
  / KBT protected / &lt;&lt; {
    / alg /    1:  -7, / ES256 /
    / typ /   16:  "application/kb+cwt",
    / kcwt /  13:  ...
           /  *** SD-CWT from Issuer goes here      /
           /  with Holder's choice of disclosures   /
           /  in the SD-CWT unprotected header  *** /
     / end of issuer SD-CWT /
  } &gt;&gt;,     / end of KBT protected header /
  / KBT unprotected / {},
  / KBT payload / &lt;&lt; {
    / cnonce / 39    : h'8c0f5f523b95bea44a9a48c649240803',
    / aud    /  3    : "https://verifier.example/app",
    / iat    /  6    : 1725244237, / 2024-09-02T02:30:37+00:00Z /
  } &gt;&gt;,      / end of KBT payload /
  / KBT signature / h'18889767bd8f2faf18dc6a99571724d7
                      b1051ff1c1b694d3bb2e304891b3b8bd
                      a36b133e9ab920fe8a8a45b7d41deba0
                      44c226f87d8b663c5f049d445594aec5'
])   / end of kbt /
</pre><a href="#section-4-7" class="pilcrow">¶</a>
</div>
<p id="section-4-8">The digests in protected parts of the issued SD-CWT and the disclosures hashed in unprotected header of the <code>issuer_sd_cwt</code> are used together by the Verifier to confirm the disclosed claims.
Since the unprotected header of the included SD-CWT is covered by the signature in the SW-KBT, the Verifier has assurance that the Holder included the sent list of disclosures.<a href="#section-4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cwt-diffs">
<section id="section-5">
      <h2 id="name-differences-from-the-cbor-w">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-differences-from-the-cbor-w" class="section-name selfRef">Differences from the CBOR Web Token Specification</a>
      </h2>
<p id="section-5-1">The CBOR Web Token Specification (Section 1.1 of <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>), uses text strings, negative integers, and unsigned integers as map keys.
This specification also allows the CBOR simple value registered in this specification in <a href="#simple59" class="auto internal xref">Section 15.2</a>, and CBOR tagged integers and text strings as map keys.
As in CWTs, CBOR maps used in an SD-CWT or SD-KBT also cannot have duplicate keys.
(An integer or text string map key is a distinct key from a tagged map key that wraps the corresponding integer or text string value).<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5-2.1">
          <p id="section-5-2.1.1">When sorted, map keys in CBOR are arranged in bytewise lexicographic order of the key's deterministic encodings (see Section 4.2.1 of <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>).
So, an integer key of 3 is represented in hex as <code>03</code>, an integer key of -2 is represented in hex as <code>21</code>, and a tag of 60 wrapping a 3 is represented in hex as <code>D8 3C 03</code><a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-3">Note that holders presenting to a verifier that does not support this specification would need to present a CWT without tagged map keys or simple value map keys.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Tagged keys are not registered in the CBOR Web Token Claims IANA registry.
Instead, the tag provides additional information about the tagged claim key and the corresponding (untagged) value.
Multiple levels of tags in a key are not permitted.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">Variability in serialization requirements impacts privacy.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">See <a href="#security" class="auto internal xref">Section 14</a> for more details on the privacy impact of serialization and profiling.<a href="#section-5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sd-cwt-definition">
<section id="section-6">
      <h2 id="name-sd-cwt-definition">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-sd-cwt-definition" class="section-name selfRef">SD-CWT Definition</a>
      </h2>
<p id="section-6-1">SD-CWT is modeled after SD-JWT, with adjustments to align with conventions in CBOR, COSE, and CWT. An SD-CWT <span class="bcp14">MUST</span> include the protected header parameter <code>typ</code> <span>[<a href="#RFC9596" class="cite xref">RFC9596</a>]</span> with either the text value "application/sd+cwt" or an uint value of TBD11 in the SD-CWT.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">An SD-CWT is a CWT that can contain blinded claims (each expressed as a Blinded Claim Hash) in the CWT payload, at the root level or in any arrays or maps inside that payload.
It is not required to contain any blinded claims.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Optionally the salted claim values (and often claim names) for the corresponding Blinded Claim Hash are disclosed in the <code>sd_claims</code> header parameter in the unprotected header of the CWT (the disclosures).
If there are no disclosures (and when no Blinded Claims Hash is present in the payload) the <code>sd_claims</code> header parameter in the unprotected header is an empty array.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Any party with a Salted Disclosed Claim can generate its hash, find that hash in the CWT payload, and unblind the content.
However, a Verifier with the hash cannot reconstruct the corresponding blinded claim without disclosure of the Salted Disclosed Claim.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="blinded-claims">
<section id="section-6.1">
        <h3 id="name-types-of-blinded-claims">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-types-of-blinded-claims" class="section-name selfRef">Types of Blinded Claims</a>
        </h3>
<p id="section-6.1-1">Salted Disclosed Claims for named claims are structured as a 128-bit salt, the disclosed value, and the name of the redacted element.
For Salted Disclosed Claims of items in an array, the name is omitted.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-6.1-2">
<pre>
salted = salted-claim / salted-element / decoy
salted-claim = [
  bstr .size 16,     ; 128-bit salt
  any,               ; claim value
  (int / text)       ; claim name
]
salted-element = [
  bstr .size 16,     ; 128-bit salt
  any                ; claim value
]
decoy = [
  bstr .size 16      ; 128-bit salt
]

; a collection of Salted Disclosed Claims
salted-array = [ +bstr .cbor salted ]
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1-3">When a blinded claim is a key in a map, its blinded claim hash is added to a <code>redacted_claim_keys</code> array claim in the CWT payload that is at the same level of hierarchy as the key being blinded.
The <code>redacted_claim_keys</code> key is the CBOR simple type TBD4 registered for that purpose (with the requested value of 59).<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">When blinding an individual item in an array, the value of the item is replaced with the digested salted hash as a CBOR byte string, wrapped with the CBOR tag TBD5 (requested tag number 60).<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-6.1-5">
<pre>
; redacted_claim_element = #6.&lt;TBD5&gt;( bstr .size 16 ) -- RFC 9682 syntax
redacted_claim_element = #6.60( bstr .size 16 )
</pre><a href="#section-6.1-5" class="pilcrow">¶</a>
</div>
<p id="section-6.1-6">Blinded claims can be nested. For example, both individual keys in the <code>inspection_location</code> claim, and the entire <code>inspection_location</code> element can be separately blinded.
An example nested claim is shown in <a href="#nesting" class="auto internal xref">Section 13.2</a>.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">Finally, an issuer <span class="bcp14">MAY</span> create decoy digests, which look like blinded claim hashes but have only a salt.
Decoy digests are discussed in <a href="#decoys" class="auto internal xref">Section 10</a>.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sd-cwt-issuance">
<section id="section-7">
      <h2 id="name-sd-cwt-issuance">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-sd-cwt-issuance" class="section-name selfRef">SD-CWT Issuance</a>
      </h2>
<p id="section-7-1">How the Holder communicates to the Issuer to request a CWT or an SD-CWT is out of scope for this specification.
Likewise, how the Holder determines which claims to blind or to always disclose is a policy matter, which is not discussed in this specification.
This specification defines the format of an SD-CWT communicated between an Issuer and a Holder in this section, and describes the format of a Key Binding Token containing that SD-CWT communicated between a Holder and a Verifier in <a href="#sd-cwt-presentation" class="auto internal xref">Section 8</a>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The protected header <span class="bcp14">MUST</span> contain the <code>sd_alg</code> header parameter identifying the algorithm (from the COSE Algorithms registry) used to hash the Salted Disclosed Claims.
The unprotected header <span class="bcp14">MUST</span> contain the <code>sd_claims</code> header parameter with a Salted Disclosed Claim for every blinded claim hash present anywhere in the payload, and any decoys (see <a href="#decoys" class="auto internal xref">Section 10</a>).
If there are no disclosures, the <code>sd_claims</code> header parameter value is an empty array.
The payload also <span class="bcp14">MUST</span> include a key confirmation element (<code>cnf</code>) <span>[<a href="#RFC8747" class="cite xref">RFC8747</a>]</span> for the Holder's public key.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">In an SD-CWT, either the subject <code>sub</code> / 2 claim <span class="bcp14">MUST</span> be present, or the redacted form of the subject <span class="bcp14">MUST</span> be present.
The issuer <code>iss</code> / 1 claim <span class="bcp14">SHOULD</span> be present unless the protected header contains a certificate or certificate-like entity that fully identifies the issuer.
All other standard CWT claims (<code>aud</code> / 3, <code>exp</code> / 4, <code>nbf</code> / 5, <code>iat</code> / 6, and <code>cti</code> / 7) are <span class="bcp14">OPTIONAL</span>.
The <code>cnonce</code> / 39 claim is <span class="bcp14">OPTIONAL</span>.
The <code>cnf</code> / 8 claim, the <code>cnonce</code> / 39 claim, and the standard claims other than the subject <span class="bcp14">MUST NOT</span> be redacted.
Any other claims are <span class="bcp14">OPTIONAL</span> and <span class="bcp14">MAY</span> be redacted.
Profiles of this specification <span class="bcp14">MAY</span> specify additional claims that <span class="bcp14">MUST</span>, <span class="bcp14">MUST NOT</span>, and <span class="bcp14">MAY</span> be redacted.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">To further reduce the size of the SD-CWT, a COSE Key Thumbprint (ckt) <span>[<a href="#RFC9679" class="cite xref">RFC9679</a>]</span> <span class="bcp14">MAY</span> be used in the <code>cnf</code> claim.<a href="#section-7-4" class="pilcrow">¶</a></p>
<div id="issuer-generation">
<section id="section-7.1">
        <h3 id="name-issuer-generation">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-issuer-generation" class="section-name selfRef">Issuer Generation</a>
        </h3>
<p id="section-7.1-1">The Issuer follows all the requirements of generating a valid SD-CWT, largely a CWT extended by <a href="#cwt-diffs" class="auto internal xref">Section 5</a>.
The Issuer <span class="bcp14">MUST</span> implement COSE_Sign1 using an appropriate fully-specified asymmetric signature algorithm (for example, ESP256 or Ed25519).<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">The Issuer <span class="bcp14">MUST</span> generate a unique cryptographically random salt with at least 128-bits of entropy for each Salted Disclosed Claim.
If the client communicates a client-generated nonce (<code>cnonce</code>) when requesting the SD-CWT, the Issuer <span class="bcp14">MUST</span> include it in the payload.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="holder-validation">
<section id="section-7.2">
        <h3 id="name-holder-validation">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-holder-validation" class="section-name selfRef">Holder Validation</a>
        </h3>
<p id="section-7.2-1">Upon receiving an SD-CWT from the Issuer with the Holder as the subject, the
Holder verifies the following:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">
            <p id="section-7.2-2.1.1">the issuer (<code>iss</code>) and subject (<code>sub</code>) are correct;<a href="#section-7.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.2">
            <p id="section-7.2-2.2.1">if an audience (<code>aud</code>) is present, it is acceptable;<a href="#section-7.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.3">
            <p id="section-7.2-2.3.1">the CWT is valid according to the <code>nbf</code> and <code>exp</code> claims, if present;<a href="#section-7.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.4">
            <p id="section-7.2-2.4.1">a public key under the control of the Holder is present in the <code>cnf</code> claim;<a href="#section-7.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.5">
            <p id="section-7.2-2.5.1">the hash algorithm in the <code>sd_alg</code> header parameter in the protected headers is supported by the Holder;<a href="#section-7.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.6">
            <p id="section-7.2-2.6.1">if a <code>cnonce</code> is present, it was provided by the Holder to this Issuer and is still fresh;<a href="#section-7.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.7">
            <p id="section-7.2-2.7.1">there are no unblinded claims about the subject that violate its privacy policies;<a href="#section-7.2-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.8">
            <p id="section-7.2-2.8.1">every blinded claim hash (some of which may be nested as in <a href="#nesting" class="auto internal xref">Section 13.2</a>) has a corresponding Salted Disclosed Claim, and vice versa;<a href="#section-7.2-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-2.9">
            <p id="section-7.2-2.9.1">all the Salted Disclosed Claims are correct in their unblinded context in the payload.<a href="#section-7.2-2.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.2-3">The following informative CDDL is provided to describe the syntax for SD-CWT issuance. A complete CDDL schema is in <a href="#cddl" class="auto internal xref">Appendix A</a>.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-7.2-4">
<pre>
sd-cwt-issued = #6.18([
   protected: bstr .cbor sd-protected,
   sd-unprotected,
   payload: bstr .cbor sd-payload,
   signature: bstr
])

sd-protected = {
   &amp;(typ: 16) ^ =&gt; "application/sd+cwt" / TBD11,
   &amp;(alg: 1) ^ =&gt; int,
   &amp;(sd_alg: TBD2) ^ =&gt; int,        ; -16 for sha-256
   ? &amp;(sd_aead: TBD7) ^ =&gt; uint .size 2
   * key =&gt; any
}

sd-unprotected = {
   ? &amp;(sd_claims: TBD1) ^ =&gt; salted-array,
   ? &amp;(sd_encrypted_claims: TBD6) ^ =&gt; encrypted-array,
   ? &amp;(sd_cose_encrypted_claims: TBD8) ^ =&gt; cose-encrypted-array,
   * key =&gt; any
}

sd-payload = {
    ; standard claims
      &amp;(iss: 1) ^ =&gt; tstr, ; "https://issuer.example"
    ? &amp;(sub: 2) ^ =&gt; tstr, ; "https://device.example"
    ? &amp;(aud: 3) ^ =&gt; tstr, ; "https://verifier.example/app"
    ? &amp;(exp: 4) ^ =&gt; int,  ; 1883000000
    ? &amp;(nbf: 5) ^ =&gt; int,  ; 1683000000
    ? &amp;(iat: 6) ^ =&gt; int,  ; 1683000000
    ? &amp;(cti: 7) ^ =&gt; bstr,
      &amp;(cnf: 8) ^ =&gt; { * key =&gt; any }, ; key confirmation
    ? &amp;(cnonce: 39) ^ =&gt; bstr,
    ;
    ? &amp;(redacted_claim_keys: REDACTED_KEYS) ^ =&gt; [ * bstr ],
    * key =&gt; any
}
</pre><a href="#section-7.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sd-cwt-presentation">
<section id="section-8">
      <h2 id="name-sd-cwt-presentation">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-sd-cwt-presentation" class="section-name selfRef">SD-CWT Presentation</a>
      </h2>
<p id="section-8-1">When a Holder presents an SD-CWT to a Verifier, it can disclose none, some, or all of its blinded claims.
If the Holder wishes to disclose any blinded claims, it includes that subset of its Salted Disclosed Claims in the <code>sd_claims</code> header parameter of the unprotected header.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">An SD-CWT presentation to a Verifier has the same syntax as an SD-CWT issued to a Holder, except the Holder chooses the subset of disclosures included in the <code>sd_claims</code> header parameter.
Since the unprotected header is not included in the signature, it will contain all the Salted Disclosed Claims when sent from the Issuer to the Holder.
When sent from the Holder to the Verifier, the unprotected header will contain none, some, or all of these Claims.
Finally, the SD-CWT used for presentation to a Verifier is included in a key binding token, as discussed in the next section.<a href="#section-8-2" class="pilcrow">¶</a></p>
<div id="kbt">
<section id="section-8.1">
        <h3 id="name-creating-a-key-binding-toke">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-creating-a-key-binding-toke" class="section-name selfRef">Creating a Key Binding Token</a>
        </h3>
<p id="section-8.1-1">Regardless if it discloses any claims, the Holder sends the Verifier a unique Holder key binding (SD-KBT) <a href="#kbt" class="auto internal xref">Section 8.1</a> for every presentation of an SD-CWT to a different Verifier.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">An SD-KBT is itself a type of CWT, signed using the private key corresponding to the key in the <code>cnf</code> claim in the presented SD-CWT.
The SD-KBT contains the SD-CWT, including the Holder's choice of presented disclosures, in the <code>kcwt</code> protected header field in the SD-KBT.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">The Holder is conceptually both the subject and the issuer of the Key Binding Token.
Therefore, the <code>sub</code> and <code>iss</code> of an SD-KBT are implied from the <code>cnf</code> claim in the included SD-CWT, and are ignored for validation purposes if they are present.
(Profiles of this specification <span class="bcp14">MAY</span> define additional semantics.)<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">The <code>aud</code> claim <span class="bcp14">MUST</span> be included and <span class="bcp14">MUST</span> correspond to the Verifier.
The SD-KBT payload <span class="bcp14">MUST</span> contain the <code>iat</code> (issued at) claim.
The protected header of the SD-KBT <span class="bcp14">MUST</span> include the <code>typ</code> header parameter with the value <code>application/sd+kbt</code> or an uint value of TBD12.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5">The SD-KBT provides the following assurances to the Verifier:<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-6.1">
            <p id="section-8.1-6.1.1">the Holder of the SD-CWT controls the confirmation method chosen by the Issuer;<a href="#section-8.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-6.2">
            <p id="section-8.1-6.2.1">the Holder's disclosures have not been tampered with since confirmation occurred;<a href="#section-8.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-6.3">
            <p id="section-8.1-6.3.1">the Holder intended to address the SD-CWT to the Verifier specified in the audience (<code>aud</code>) claim;<a href="#section-8.1-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-6.4">
            <p id="section-8.1-6.4.1">the Holder's disclosure is linked to the creation time (<code>iat</code>) of the key binding.<a href="#section-8.1-6.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-7">The SD-KBT prevents an attacker from copying and pasting disclosures, or from adding or removing disclosures without detection.
Confirmation is established according to <span>[<a href="#RFC8747" class="cite xref">RFC8747</a>]</span>, using the <code>cnf</code> claim in the payload of the SD-CWT.<a href="#section-8.1-7" class="pilcrow">¶</a></p>
<p id="section-8.1-8">The Holder signs the SD-KBT using the key specified in the <code>cnf</code> claim in the SD-CWT. This proves possession of the Holder's private key.<a href="#section-8.1-8" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-8.1-9">
<pre>
kbt-cwt = #6.18([
   protected: bstr .cbor kbt-protected,
   kbt-unprotected,
   payload: bstr .cbor kbt-payload,
   signature: bstr
])

kbt-protected = {
   &amp;(typ: 16) ^ =&gt; "application/kb+cwt" / TBD12,
   &amp;(alg: 1) ^ =&gt; int,
   &amp;(kcwt: 13) ^ =&gt; sd-cwt-issued,
   * key =&gt; any
}

kbt-unprotected = {
   * key =&gt; any
}

kbt-payload = {
      &amp;(aud: 3) ^ =&gt; tstr, ; "https://verifier.example/app"
    ? &amp;(exp: 4) ^ =&gt; int,  ; 1883000000
    ? &amp;(nbf: 5) ^ =&gt; int,  ; 1683000000
      &amp;(iat: 6) ^ =&gt; int,  ; 1683000000
    ? &amp;(cnonce: 39) ^ =&gt; bstr,
    * key =&gt; any
}
</pre><a href="#section-8.1-9" class="pilcrow">¶</a>
</div>
<p id="section-8.1-10">The SD-KBT payload <span class="bcp14">MAY</span> include a <code>cnonce</code> claim.
If included, the <code>cnonce</code> is a <code>bstr</code> and <span class="bcp14">MUST</span> be treated as opaque to the Holder.
All other claims are <span class="bcp14">OPTIONAL</span> in an SD-KBT.<a href="#section-8.1-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sd-kbt-and-sd-cwt-verifier-validation">
<section id="section-9">
      <h2 id="name-sd-kbt-and-sd-cwt-verifier-">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-sd-kbt-and-sd-cwt-verifier-" class="section-name selfRef">SD-KBT and SD-CWT Verifier Validation</a>
      </h2>
<p id="section-9-1">The exact order of the following steps <span class="bcp14">MAY</span> be changed, as long as all checks are performed before deciding if an SD-CWT is valid.
First the Verifier must open the protected headers of the SD-KBT and find the issuer SD-CWT present in the <code>kcwt</code> field.
Next, the Verifier must validate the SD-CWT as described in <span><a href="https://rfc-editor.org/rfc/rfc8392#section-7.2" class="relref">Section 7.2</a> of [<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.
The Verifier extracts the confirmation key from the <code>cnf</code> claim in the SD-CWT payload.
Using the confirmation key, the Verifier validates the SD-KBT as described in <span><a href="https://rfc-editor.org/rfc/rfc8392#section-7.2" class="relref">Section 7.2</a> of [<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Finally, the Verifier <span class="bcp14">MUST</span> extract and decode the disclosed claims from the <code>sd_claims</code> header parameter in the unprotected header of the SD-CWT.
The decoded <code>sd_claims</code> are converted to an intermediate data structure called a Digest To Disclosed Claim Map that is used to transform the Presented Disclosed Claims Set into a Validated Disclosed Claims Set.
The Verifier <span class="bcp14">MUST</span> compute the hash of each Salted Disclosed Claim (<code>salted</code>), in order to match each disclosed value to each entry of the Presented Disclosed Claims Set.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">One possible concrete representation of the intermediate data structure for the Digest To Disclosed Claim Map could be:<a href="#section-9-3" class="pilcrow">¶</a></p>
<div class="lang-cddl-ish sourcecode" id="section-9-4">
<pre>
{
  &amp;(digested-salted-disclosed-claim) =&gt; salted
}
</pre><a href="#section-9-4" class="pilcrow">¶</a>
</div>
<p id="section-9-5">The Verifier constructs an empty cbor map called the Validated Disclosed Claims Set, and initializes it with all mandatory to disclose claims from the verified Presented Disclosed Claims Set.
Next, the Verifier performs a breadth first or depth first traversal of the Presented Disclosed Claims Set and Validated Disclosed Claims Set, using the Digest To Disclosed Claim Map to insert claims into the Validated Disclosed Claims Set when they appear in the Presented Disclosed Claims Set.
By performing these steps, the recipient can cryptographically verify the integrity of the protected claims and verify they have not been tampered with.
If there remain unused claims in the Digest To Disclosed Claim Map at the end of this procedure the SD-CWT <span class="bcp14">MUST</span> be considered invalid.<a href="#section-9-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9-6.1">
          <p id="section-9-6.1.1">Note: A verifier <span class="bcp14">MUST</span> be prepared to process disclosures in any order. When disclosures are nested, a disclosed value could appear before the disclosure of its parent.<a href="#section-9-6.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-9-7">A verifier <span class="bcp14">MUST</span> reject the SD-CWT if the audience claim in either the SD-CWT or the SD-KBT contains a value that does not correspond to the intended recipient.<a href="#section-9-7" class="pilcrow">¶</a></p>
<p id="section-9-8">Otherwise, the SD-CWT is considered valid, and the Validated Disclosed Claims Set is now a CWT Claims Set with no claims marked for redaction.
Further validation logic can be applied to the Validated Disclosed Claims Set, just as it might be applied to a validated CWT Claims Set.<a href="#section-9-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="decoys">
<section id="section-10">
      <h2 id="name-decoy-digests">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-decoy-digests" class="section-name selfRef">Decoy Digests</a>
      </h2>
<p id="section-10-1"><strong>TODO</strong><a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encrypted-disclosures">
<section id="section-11">
      <h2 id="name-encrypted-disclosures">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-encrypted-disclosures" class="section-name selfRef">Encrypted Disclosures</a>
      </h2>
<p id="section-11-1">Some uses of SD-CWT involve verifiers that have internal structure.
In these cases, encrypted disclosures allow more fine-grained disclosure inside a single presentation.<a href="#section-11-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11-2.1">
          <p id="section-11-2.1.1">In the Remote Attestation Procedures (RATS) architecture <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, an SD-CWT is a RATS conceptual message that represents evidence.
Different evidence claims could be processed by different attesters within the same Verifier.
For example, one SD-KBT could include an SD-CWT with one set of claims about the workload, and one set of claims about the platform.
It would be desirable to have each RATS appraiser see a different subset of disclosures in the SD-CWT / SD-KBT.<a href="#section-11-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11-3.1">
          <p id="section-11-3.1.1">In the Messaging Layer Security (MLS) protocol <span>[<a href="#RFC9420" class="cite xref">RFC9420</a>]</span>, an SD-CWT credential <span>[<a href="#I-D.mahy-mls-sd-cwt-credential" class="cite xref">I-D.mahy-mls-sd-cwt-credential</a>]</span> could present one subset of its disclosures to the MLS Distribution Service, and a different subset of those disclosures to the other members of the MLS group.<a href="#section-11-3.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-11-4">The entire SD-CWT is included in the protected header of the SD-KBT, which secured the entire issuer signed SD-CWT including its unprotected headers that include its disclosures.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">When encrypted disclosures are present, they <span class="bcp14">MUST</span> be in the unprotected headers of the issuer signed SD-CWT, before the SD-KBT can be generated by the holder.<a href="#section-11-5" class="pilcrow">¶</a></p>
<p id="section-11-6">The verifier of the key binding token might not be able to decrypt encrypted disclosures and <span class="bcp14">MAY</span> decide to forward them to an inner verifier that can decrypt them.<a href="#section-11-6" class="pilcrow">¶</a></p>
<div id="aead">
<section id="section-11.1">
        <h3 id="name-aead-encrypted-disclosures">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-aead-encrypted-disclosures" class="section-name selfRef">AEAD Encrypted Disclosures</a>
        </h3>
<p id="section-11.1-1">This section defines two new COSE Header Parameters.
If present in the protected headers, the first header parameter (<code>sd_aead</code>) specifies an IANA registered Authenticated Encryption with Additional Data (AEAD) algorithm <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>]</span>.
The second header parameter (<code>sd_encrypted_claims</code>) contains a list of AEAD encrypted disclosures.
Taking the first example disclosure from above:<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-11.1-2">
<pre>
        &lt;&lt;[
            /salt/   h'bae611067bb823486797da1ebbb52f83',
            /value/  "ABCD-123456",
            /claim/  501   / inspector_license_number /
        ]&gt;&gt;,
</pre><a href="#section-11.1-2" class="pilcrow">¶</a>
</div>
<p id="section-11.1-3">The corresponding bstr is encrypted with an AEAD algorithm <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>]</span>.
If present, the algorithm of the <code>sd_aead</code> protected header field is used, or AEAD_AES_128_GCM if no algorithm was specified. The bstr is encrypted with a unique, random 16-octet nonce.
The nonce (<code>nonce</code>), and the resulting <code>ciphertext</code> and <code>mac</code> are put in an array.
The resulting array is placed in the <code>sd_encrypted_claims</code> header parameter in the unprotected headers of the SD-CWT.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11.1-4.1">
            <p id="section-11.1-4.1.1">The encryption mechanism in this section uses the AEAD algorithm directly instead of COSE encryption, because AEAD is more broadly applicable to some of the other protocols in which encrypted disclosures might be used.<a href="#section-11.1-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="lang-cbor-diag sourcecode" id="section-11.1-5">
<pre>
/ sd_encrypted_claims / 19 : [ / encrypted disclosures /
    [
        / nonce /      h'95d0040fe650e5baf51c907c31be15dc',
        / ciphertext / h'208cda279ca86444681503830469b705
                         89654084156c9e65ca02f9ac40cd62b5
                         a2470d',
        / mac /        h'1c6e732977453ab2cacbfd578bd238c0'
    ],
    ...
]
</pre><a href="#section-11.1-5" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11.1-6.1">
            <p id="section-11.1-6.1.1">In the example above, the key in hex is <code>a061c27a3273721e210d031863ad81b6</code>.<a href="#section-11.1-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.1-7">The blinded claim hash is still over the unencrypted disclosure.
The receiver of an encrypted disclosure locates the appropriate key by looking up the mac.
If the verifier is able to decrypt and verify an encrypted disclosure, the decrypted disclosure is then processed as if it were in the <code>sd_claims</code> header parameter in the unprotected headers of the SD-CWT.<a href="#section-11.1-7" class="pilcrow">¶</a></p>
<p id="section-11.1-8">Details of key management are left to the specific protocols that make use of encrypted disclosures.<a href="#section-11.1-8" class="pilcrow">¶</a></p>
<p id="section-11.1-9">The CDDL for encrypted disclosures is below.<a href="#section-11.1-9" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-11.1-10">
<pre>
encrypted-array = [ +encrypted ]
encrypted = [
  bstr .size 16,     ; 128-bit nonce
  bstr,              ; the ciphertext output of a bstr-encoded-salted
                     ;   with a matching salt
  bstr               ; the corresponding MAC
]
;bstr-encoded-salted = bstr .cbor salted
</pre><a href="#section-11.1-10" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11.1-11.1">
            <p id="section-11.1-11.1.1">Note: Because the algorithm is in a registry that contains only AEAD algorithms, an attacker cannot replace the algorithm or the message, without a decryption verification failure.<a href="#section-11.1-11.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="cose-encrypted">
<section id="section-11.2">
        <h3 id="name-cose-encrypted-disclosures">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-cose-encrypted-disclosures" class="section-name selfRef">COSE Encrypted Disclosures</a>
        </h3>
<p id="section-11.2-1">This section defines the new COSE Header Parameter (<code>sd_cose_encrypted_claims</code>) that contains a list of tagged COSE_Encrypt0 or COSE_Encrypt encrypted disclosures, following the rules defined in <span>[<a href="#RFC9502" class="cite xref">RFC9502</a>]</span>.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2-2">Its contents have the same semantics as the AEAD encrypted disclosures in the previous section.<a href="#section-11.2-2" class="pilcrow">¶</a></p>
<p id="section-11.2-3">Taking the bstr encoding of the example disclosure in the previous section as the payload, the key and nonce from the previous section, and encrypting with COSE_Encrypt0 using the COSE A128GCM algorithm, yields the following COSE encrypted disclosure.<a href="#section-11.2-3" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-11.2-4">
<pre>
/ sd_cose_encrypted_claims / 21 : [
    /COSE_Encrypt0/  16([
      /protected/ {
        /alg/ 1: 1, /A128GCM/
        /IV/  5: h'95d0040fe650e5baf51c907c31be15dc'
      },
      /unprotected/ {},
      /ciphertext/ h'f5e33642feca31cacb5325db179663e8
                     540336178526f0803c0b13b17e3eb2f9
                     e3c323087a0345c76c163d300b1b3346
                     49ce511302fd147b2ab125297cf540cf
                     4f9e'
    ]),
    ...
]
</pre><a href="#section-11.2-4" class="pilcrow">¶</a>
</div>
<p id="section-11.2-5">The CDDL for COSE encrypted disclosures is below:<a href="#section-11.2-5" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-11.2-6">
<pre>
cose-encrypted-array = [ +cose-encrypted ]
cose-encrypted = COSE_Encrypt0_Tagged / COSE_Encrypt_Tagged
</pre><a href="#section-11.2-6" class="pilcrow">¶</a>
</div>
<p id="section-11.2-7">The IANA COSE Algorithms registry contains deprecated and unsafe algorithms.
Implementations using COSE encrypted disclosures <span class="bcp14">MUST</span> select only fully-specified signature algorithms, authenticated encryption (AEAD) algorithms, and <span class="bcp14">SHOULD</span> preferably use algorithms that have a "Yes" in the "Recommended" column of the IANA COSE Algorithms registry.<a href="#section-11.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cred-types">
<section id="section-12">
      <h2 id="name-credential-types">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-credential-types" class="section-name selfRef">Credential Types</a>
      </h2>
<p id="section-12-1">This specification defines the CWT claim <code>vct</code> (for Verifiable Credential Type).
The <code>vct</code> value is an identifier for the type of the SD-CWT Claims Set.
Like the <code>typ</code> header parameter <span>[<a href="#RFC9596" class="cite xref">RFC9596</a>]</span>, its value can be either a string or an integer.
For size reasons, it is <span class="bcp14">RECOMMENDED</span> that the numeric representation be used.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">If its value is a string, it is a case-sensitive StringOrURI, as defined in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.
In this case, the <code>vct</code> string <span class="bcp14">MUST</span> either be registered in the
IANA "Verifiable Credential Type Identifiers" registry
established in <a href="#vct-registry" class="auto internal xref">Section 15.7</a>,
or be a Collision-Resistant Name, as defined in Section 2 of <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">If its value is an integer, it is either a value in the range 0-64999 registered in
the IANA "Verifiable Credential Type Identifiers" registry
established in <a href="#vct-registry" class="auto internal xref">Section 15.7</a>
or an  Experimental Use value in the range 65000-65535,
which is not to be used in operational deployments.<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">This claim is defined for COSE-based verifiable credentials, similar to the JOSE-based verifiable credentials claim (<code>vct</code>) described in Section 3.2.2.1.1 of <span>[<a href="#I-D.draft-ietf-oauth-sd-jwt-vc" class="cite xref">I-D.draft-ietf-oauth-sd-jwt-vc</a>]</span>.<a href="#section-12-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="examples">
<section id="section-13">
      <h2 id="name-examples">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<div id="minimal-spanning-example">
<section id="section-13.1">
        <h3 id="name-minimal-spanning-example">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-minimal-spanning-example" class="section-name selfRef">Minimal Spanning Example</a>
        </h3>
<p id="section-13.1-1">The following example contains claims needed to demonstrate redaction of key-value pairs and array elements.<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<span id="name-an-edn-example"></span><div id="example-edn">
<figure id="figure-6">
          <div class="breakable lang-cbor-diag sourcecode" id="section-13.1-2.1">
<pre>
/ cose-sign1 / 18( / sd_kbt / [
  / KBT protected / &lt;&lt; {
    / alg /    1:  -7, / ES256 /
    / typ /   16:  "application/kb+cwt",
    / kcwt /  13:  18([  / issuer SD-CWT /
      / CWT protected / &lt;&lt; {
        / alg /    1  : -35, / ES384 /
        / typ /    16 : "application/sd+cwt",
        / kid /    4  : 'https://issuer.example/cwt-key3',
        / sd_alg / 18 : -16  / SHA256 /
      } &gt;&gt;,
      / CWT unprotected / {
        / sd_claims / 17 : [ / these are the disclosures /
            &lt;&lt;[
                /salt/   h'bae611067bb823486797da1ebbb52f83',
                /value/  "ABCD-123456",
                /claim/  501   / inspector_license_number /
            ]&gt;&gt;,
            &lt;&lt;[
                /salt/   h'8de86a012b3043ae6e4457b9e1aaab80',
                /value/  1549560720   / inspected 7-Feb-2019 /
            ]&gt;&gt;,
            &lt;&lt;[
                /salt/   h'ec615c3035d5a4ff2f5ae29ded683c8e',
                /value/  "ca",
                /claim/  "region"   / region=California /
            ]&gt;&gt;,
        ]
      }
      / CWT payload / &lt;&lt; {
        / iss / 1   : "https://issuer.example",
        / sub / 2   : "https://device.example",
        / exp / 4   : 1725330600,  /2024-09-03T02:30:00+00:00Z/
        / nbf / 5   : 1725243900,  /2024-09-02T02:25:00+00:00Z/
        / iat / 6   : 1725244200,  /2024-09-02T02:30:00+00:00Z/
        / cnf / 8   : {
          / cose key / 1 : {
            / kty /  1: 2,  / EC2   /
            / crv / -1: 1,  / P-256 /
            / x /   -2: h'8554eb275dcd6fbd1c7ac641aa2c90d9
                          2022fd0d3024b5af18c7cc61ad527a2d',
            / y /   -3: h'4dc7ae2c677e96d0cc82597655ce92d5
                          503f54293d87875d1e79ce4770194343'
          }
        },
        /most_recent_inspection_passed/ 500: true,
        / redacted_claim_keys / simple(59) : [
            / redacted inspector_license_number /
            h'3fc9748e00684e6442641e58ea965468
              085024da253ed46b507ae56d4c204434'
        ],
        /inspection_dates/ 502 : [
            / redacted inspection date 7-Feb-2019 /
            60(h'f468b68dd7432030d7f33a8783acb3a4
                 d6afc215bbc184dce8831c64b539f335'),
            / redacted inspection date 4-Feb-2021 /
            60(h'0839dcbdd9ed55c8aac3e573ccf59c81
                 0fa8d9f6ec551cb9737621faf3584e1f'),
            1674004740,   / 2023-01-17T17:19:00 /
        ],
        / inspection_location / 503 : {
            "country" : "us",            / United States /
            / redacted_claim_keys / simple(59) : [
                / redacted region /
                h'2ff24f519a1bdfc66292263de2415a36
                  6b9a4302d2a9f36b9791f8eab1867513'
                / redacted postal_code /
                h'f907645d118184af56331cb07b7b8c31
                  826ac7d18d051bcec37a3a8afb8581c3'
          ]
        }
      } &gt;&gt;,
      / CWT signature / h'9280a520b8686183bf72cd07c714e603
                          ff0975b357975a1391de51a248d554e1
                          b93d0d101edb6bf11a4a98aa9714d823
                          c84d1d6c438e5d733a4f67c16e1ff030
                          ae3f4b1c546ecc9e9add168da97e32e1
                          c5b8de5b873c9572ecb9f219399c5a9f'
    ])
     / end of issuer SD-CWT /
  } &gt;&gt;,     / end of KBT protected header /
  / KBT unprotected / {},
  / KBT payload / &lt;&lt; {
    / cnonce / 39    : h'8c0f5f523b95bea44a9a48c649240803',
    / aud    /  3    : "https://verifier.example/app",
    / iat    /  6    : 1725244237, / 2024-09-02T02:30:37+00:00Z /
  } &gt;&gt;,      / end of KBT payload /
  / KBT signature / h'18889767bd8f2faf18dc6a99571724d7
                      b1051ff1c1b694d3bb2e304891b3b8bd
                      a36b133e9ab920fe8a8a45b7d41deba0
                      44c226f87d8b663c5f049d445594aec5'
])   / end of kbt /
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-an-edn-example" class="selfRef">An EDN Example</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="nesting">
<section id="section-13.2">
        <h3 id="name-nested-example">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-nested-example" class="section-name selfRef">Nested Example</a>
        </h3>
<p id="section-13.2-1">Instead of the structure from the previous example, imagine that the payload contains an inspection history log with the following structure. It could be blinded at multiple levels of the claims set hierarchy.<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-13.2-2">
<pre>
{
    / iss / 1  : "https://issuer.example",
    / sub / 2  : "https://device.example",
    / exp / 4  : 1725330600, /2024-09-02T19:30:00Z/
    / nbf / 5  : 1725243840, /2024-09-01T19:25:00Z/
    / iat / 6  : 1725244200, /2024-09-01T19:30:00Z/
    / cnf / 8  : { ... },
    504: [                      / inspection history log /
        {
            500: True,          / inspection passed /
            502: 1549560720,    / 2019-02-07T17:32:00 /
            501: "DCBA-101777", / inspector license /
            503: {
                1: "us",        / United States /
                2: "co",        / region=Colorado /
                3: "80302"      / postcode /
            }
        },
        {
            500: True,          / inspection passed /
            502: 1612560720,    / 2021-02-04T20:14:00 /
            501: "EFGH-789012", / inspector license /
            503: {
                1: "us",        / United States /
                2: "nv",        / region=Nevada /
                3: "89155"      / postcode /
            }
        },
        {
            500: True,          / inspection passed /
            502: 17183928,      / 2023-01-17T17:19:00 /
            501: "ABCD-123456", / inspector license /
            503: {
                1: "us",        / United States /
                2: "ca",        / region=California /
                3: "94188"      / postcode /
            }
        },
    ]
}
</pre><a href="#section-13.2-2" class="pilcrow">¶</a>
</div>
<p id="section-13.2-3">For example, looking at the nested disclosures below, the first disclosure unblinds the entire January 2023 inspection record.
However, when the record is disclosed, the inspector license number and inspection location are redacted inside the record.
The next disclosure unblinds the inspector_license_number, and the next
disclosure unblinds the inspection location record, but the region and postcode claims inside the location record are also individually blinded.
The fourth disclosure unblinds the inspection region.<a href="#section-13.2-3" class="pilcrow">¶</a></p>
<p id="section-13.2-4">The fifth disclosure unblinds the earliest inspection record, and the last disclosure unblinds the inspector_license_number for that record.<a href="#section-13.2-4" class="pilcrow">¶</a></p>
<p id="section-13.2-5">Verifiers start unblinding claims for which they have blinded claim hashes. They continue descending until there are no blinded claim hashes at any level of the hierarchy for which they have a corresponding disclosure.<a href="#section-13.2-5" class="pilcrow">¶</a></p>
<div class="breakable lang-cbor-diag sourcecode" id="section-13.2-6">
<pre>
/ sd_claims / 17 : [ / these are the disclosures /
    &lt;&lt;[
        /salt/   h'2e9a833949c163ce845813c258a8f13c',
        /value/  {
                     500: true,
                     502: 17183928,
                     simple(59): [
                       h'3fc9748e00684e6442641e58ea965468
                         085024da253ed46b507ae56d4c204434',
                       h'a5124745703ea9023bf92a2028ba4547
                         b830ce9705161eaad56729cab8e1d807'
                     ]
                 }   / inspection 17-Jan-2023 /
    ]&gt;&gt;,
    &lt;&lt;[
        /salt/   h'bae611067bb823486797da1ebbb52f83',
        /value/  "ABCD-123456",
        /claim/  501   / inspector_license_number /
    ]&gt;&gt;,
    &lt;&lt;[
        /salt/   h'd5c7494eb16a8ff11fba507cbc7c816b',
        /value/  {
                     1: "us",
                     simple(59): [
                       h'3bf93977377099c66997303ddbce67b4
                         ca7ee95d2c8cf2b8b45f451362493460',
                       h'231e125d192de099e91bc59e2ae914f0
                         c891cbc3329b7fea70a3aa636c87a0a4'
                     ]
                 },
        /claim/  503   / San Francisco location /
    ]&gt;&gt;,
    &lt;&lt;[
        /salt/   h'52da9de5dc61b33775f9348b991d3d78',
        /value/  "ca",
        /claim/  2   / region=California /
    ]&gt;&gt;,
    &lt;&lt;[
        /salt/   h'9adcf14141f8607a44a130a4b341e162',
        /value/  {
                     500: true,
                     502: 1549560720,
                     simple(59): [
                       h'94d61c995d4fa25ad4d3cc4752f6ffaf
                         9e67f7f0b4836c8252a9ad23c20499f5',
                       h'4ff0ecad5f767923582febd69714f3f8
                         0cb00f58390a0825bc402febfa3548bf'
                     ]
                 }   / inspection 7-Feb-2019 /
    ]&gt;&gt;,
    &lt;&lt;[
        /salt/   h'591eb2081b05be2dcbb6f8459cc0fe51',
        /value/  "DCBA-101777",
        /claim/  501   / inspector_license_number /
    ]&gt;&gt;,
    &lt;&lt;[
        /salt/   h'95b006410a1b6908997eed7d2a10f958',
        /value/  {
                     1: "us",
                     simple(59): [
                       h'2bc86e391ec9b663de195ae9680bf614
                         21666bc9073b1ebaf80c77be3adb379f',
                       h'e11c93b44fb150a73212edec5bde46d3
                         d7db23d0d43bfd6a465f82ee8cf72503'
                     ]
                 },
        /claim/  503   / Denver location /
    ]&gt;&gt;,
]
</pre><a href="#section-13.2-6" class="pilcrow">¶</a>
</div>
<p id="section-13.2-7">After applying the disclosures of the nested structure above, the disclosed Claims Set visible to the verifier would look like the following:<a href="#section-13.2-7" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="section-13.2-8">
<pre>
{
    / iss / 1  : "https://issuer.example",
    / sub / 2  : "https://device.example",
    / exp / 4  : 1725330600, /2024-09-02T19:30:00Z/
    / nbf / 5  : 1725243840, /2024-09-01T19:25:00Z/
    / iat / 6  : 1725244200, /2024-09-01T19:30:00Z/
    / cnf / 8  : { ... },
    504: [                      / inspection history log /
        {
            500: True,          / inspection passed /
            502: 1549560720,    / 2019-02-07T17:32:00 /
            501: "DCBA-101777", / inspector license /
            503: {
                1: "us"         / United States /
            }
        },
        {
            500: True,          / inspection passed /
            502: 17183928,      / 2023-01-17T17:19:00 /
            501: "ABCD-123456", / inspector license /
            503: {
                1: "us",        / United States /
                2: "ca"         / region=California /
            }
        },
    ]
}
</pre><a href="#section-13.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-14">
      <h2 id="name-security-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-14-1">Security considerations from COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span> and CWT <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> apply to this specification.<a href="#section-14-1" class="pilcrow">¶</a></p>
<div id="transparency">
<section id="section-14.1">
        <h3 id="name-transparency">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-transparency" class="section-name selfRef">Transparency</a>
        </h3>
<p id="section-14.1-1">Verification of an SD-CWT requires that the verifier have access to a verification key (public key) associated with the issuer.
Compromise of the issuer's signing key would enable an attacker to forge credentials for any subject associated with the issuer.
Certificate transparency, as described in <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>, or key transparency, as described in <span>[<a href="#I-D.draft-ietf-keytrans-protocol" class="cite xref">I-D.draft-ietf-keytrans-protocol</a>]</span>, can enable the observation of incorrectly issued certificates or fraudulent bindings between verification keys and issuer identifiers.
Issuers choose which claims to include in an SD-CWT, and whether they are mandatory to disclose, including self-asserted claims such as "iss".
All mandatory to disclose data elements are visible to the verifier as part of verification. Some of these elements reveal information about the issuer, such as key or certificate thumbprints, supported digital signature algorithms, and operational windows that can be inferred from analysis of timestamps.<a href="#section-14.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="correlation">
<section id="section-14.2">
        <h3 id="name-correlation">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-correlation" class="section-name selfRef">Correlation</a>
        </h3>
<p id="section-14.2-1">Presentations of the same SD-CWT to multiple verifiers can be correlated by matching on the signature component of the COSE_Sign1.
Signature based linkability can be mitigated by leveraging batch issuance of single-use tokens, at a credential management complexity cost.
Any claim value with sufficiently low "anonymity set" can be used to track the subject.
For example, a high precision issuance time might match the issuance of only a few credentials for a given issuer, and as such, any presentation of a credential issued at that time can be determined to be associated with the set of credentials issued at that time, for those subjects.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-types">
<section id="section-14.3">
        <h3 id="name-credential-types-2">
<a href="#section-14.3" class="section-number selfRef">14.3. </a><a href="#name-credential-types-2" class="section-name selfRef">Credential Types</a>
        </h3>
<p id="section-14.3-1">The mandatory- and optional-to-disclose data elements in an SD-CWT are credential type specific.
Several distinct credential types might be applicable to a given use case.
Issuers <span class="bcp14">MUST</span> perform a privacy and confidentiality assessment regarding each credential type they intend to issue prior to issuance.<a href="#section-14.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="determinism-augmentation">
<section id="section-14.4">
        <h3 id="name-determinism-augmentation">
<a href="#section-14.4" class="section-number selfRef">14.4. </a><a href="#name-determinism-augmentation" class="section-name selfRef">Determinism &amp; Augmentation</a>
        </h3>
<p id="section-14.4-1">It is possible to encode additional information through the choices made during the serialization stage of producing an SD-CWT, for example, by adjusting the order of CBOR map keys, or by choosing different numeric encodings for certain data elements.
<span>[<a href="#I-D.draft-ietf-cbor-cde" class="cite xref">I-D.draft-ietf-cbor-cde</a>]</span> provides guidance for constructing application profiles that constrain serialization optionality beyond CBOR Common Deterministic Encoding rulesets (CDE).
The construction of such profiles has a significant impact on the privacy properties of a credential type.<a href="#section-14.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="threat-model">
<section id="section-14.5">
        <h3 id="name-threat-model">
<a href="#section-14.5" class="section-number selfRef">14.5. </a><a href="#name-threat-model" class="section-name selfRef">Threat Model</a>
        </h3>
<p id="section-14.5-1">Each use case will have a unique threat model that <span class="bcp14">MUST</span> be considered before the applicability of SD-CWT-based credential types can be determined.
This section provides a non-exhaustive list of topics to be considered when developing a threat model for applying SD-CWT to a given use case.<a href="#section-14.5-1" class="pilcrow">¶</a></p>
<p id="section-14.5-2">Has there been a t-closeness, k-anonymity, and l-diversity assessment (see <span>[<a href="#t-Closeness" class="cite xref">t-Closeness</a>]</span>) assuming compromise of the one or more issuers, verifiers or holders, for all relevant credential types?<a href="#section-14.5-2" class="pilcrow">¶</a></p>
<p id="section-14.5-3">How many issuers exist for the credential type?
Is the size of the set of issuers growing or shrinking over time?
For a given credential type, will subjects be able to hold instances of the same credential type from multiple issuers, or just a single issuer?
Does the credential type require or offer the ability to disclose a globally unique identifier?
Does the credential type require high precision time or other claims that have sufficient entropy such that they can serve as a unique fingerprint for a specific subject?
Does the credential type contain Personally Identifiable Information (PII), or other sensitive information that might have value in a market?<a href="#section-14.5-3" class="pilcrow">¶</a></p>
<p id="section-14.5-4">How many verifiers exist for the credential type?
Is the size of the set of verifiers growing or shrinking over time?
Are the verifiers a superset, subset, or disjoint set of the issuers or subjects?
Are there any legally required reporting or disclosure requirements associated with the verifiers?
Is there reason to believe that a verifier's historic data will be aggregated and analyzed?
Assuming multiple verifiers are simultaneously compromised, what knowledge regarding subjects can be inferred from analyzing the resulting dataset?<a href="#section-14.5-4" class="pilcrow">¶</a></p>
<p id="section-14.5-5">How many subjects exist for the credential type?
Is the size of the set of subjects growing or shrinking over time?
Does the credential type require specific hardware, or algorithms that limit the set of possible subjects to owners of specific devices or subscribers to specific services?<a href="#section-14.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="random-numbers">
<section id="section-14.6">
        <h3 id="name-random-numbers">
<a href="#section-14.6" class="section-number selfRef">14.6. </a><a href="#name-random-numbers" class="section-name selfRef">Random Numbers</a>
        </h3>
<p id="section-14.6-1">Each salt used to protect disclosed claims <span class="bcp14">MUST</span> be generated independently from the salts of other claims. The salts <span class="bcp14">MUST</span> be generated from a source of entropy that is acceptable to the issuer.
Poor choice of salts can lead to brute force attacks that can reveal redacted claims.<a href="#section-14.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="binding-the-kbt-and-the-cwt">
<section id="section-14.7">
        <h3 id="name-binding-the-kbt-and-the-cwt">
<a href="#section-14.7" class="section-number selfRef">14.7. </a><a href="#name-binding-the-kbt-and-the-cwt" class="section-name selfRef">Binding the KBT and the CWT</a>
        </h3>
<p id="section-14.7-1">The issuer claim in the SD-CWT is self-asserted by the issuer.<a href="#section-14.7-1" class="pilcrow">¶</a></p>
<p id="section-14.7-2">Because confirmation is mandatory, the subject claim of an SD-CWT, when present, is always related directly to the confirmation claim.
There might be many subject claims and many confirmation keys that identify the same entity or that are controlled by the same entity, while the identifiers and keys are distinct values.
Reusing an identifier or key enables correlation, but <span class="bcp14">MUST</span> be evaluated in terms of the confidential and privacy constraints associated with the credential type.
Conceptually, the Holder is both the issuer and the subject of the SD-KBT, even if the issuer or subject claims are not present.
If they are present, they are self-asserted by the Holder.
All three are represented by the confirmation (public) key in the SD-CWT.<a href="#section-14.7-2" class="pilcrow">¶</a></p>
<p id="section-14.7-3">As with any self-assigned identifiers, Verifiers need to take care to verify that the SD-KBT issuer and subject claims match the subject in the SD-KBT, and are a valid representation of the Holder and correspond to the Holder's confirmation key.
Extra care should be taken in case the SD-CWT subject claim is redacted.
Likewise, Holders and Verifiers <span class="bcp14">MUST</span> verify that the issuer claim of the SD-CWT corresponds to the Issuer and the key described in the protected header of the SD-CWT.<a href="#section-14.7-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="covert-channels">
<section id="section-14.8">
        <h3 id="name-covert-channels">
<a href="#section-14.8" class="section-number selfRef">14.8. </a><a href="#name-covert-channels" class="section-name selfRef">Covert Channels</a>
        </h3>
<p id="section-14.8-1">Any data element that is supplied by the issuer, and that appears random to the holder might be used to produce a covert channel between the issuer and the verifier.
The ordering of claims, and precision of timestamps can also be used to produce a covert channel.
This is more of a concern for SD-CWT than typical CWTs, because the holder is usually considered to be aware of the issuer claims they are disclosing to a verifier.<a href="#section-14.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nested-disclosure-ordering">
<section id="section-14.9">
        <h3 id="name-nested-disclosure-ordering">
<a href="#section-14.9" class="section-number selfRef">14.9. </a><a href="#name-nested-disclosure-ordering" class="section-name selfRef">Nested Disclosure Ordering</a>
        </h3>
<p id="section-14.9-1">The Holder has flexibility in determining the order of nested disclosures when making presentations.
The order can be sorted, randomized, or optimized for performance based on the Holder's needs.
This ordering choice has no security impact on encrypted disclosures.
However, the order can affect the runtime of the verification process.<a href="#section-14.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="audience">
<section id="section-14.10">
        <h3 id="name-audience">
<a href="#section-14.10" class="section-number selfRef">14.10. </a><a href="#name-audience" class="section-name selfRef">Audience</a>
        </h3>
<p id="section-14.10-1">If the audience claim is present in both the SD-CWT and the SD-KBT, they are not required to be the same.
SD-CWTs with audience claims that do not correspond to the intended recipients <span class="bcp14">MUST</span> be rejected, to protect against accidental disclosure of sensitive data.<a href="#section-14.10-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-15">
      <h2 id="name-iana-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="cose-header-parameters">
<section id="section-15.1">
        <h3 id="name-cose-header-parameters">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-cose-header-parameters" class="section-name selfRef">COSE Header Parameters</a>
        </h3>
<p id="section-15.1-1">IANA is requested to add the following entries to the IANA "COSE Header Parameters" registry (https://www.iana.org/assignments/cose/cose.xhtml#header-parameters):<a href="#section-15.1-1" class="pilcrow">¶</a></p>
<div id="sdclaims">
<section id="section-15.1.1">
          <h4 id="name-sd_claims">
<a href="#section-15.1.1" class="section-number selfRef">15.1.1. </a><a href="#name-sd_claims" class="section-name selfRef">sd_claims</a>
          </h4>
<p id="section-15.1.1-1">The following completed registration template per RFC8152 is provided:<a href="#section-15.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1.1-2.1">
              <p id="section-15.1.1-2.1.1">Name: sd_claims<a href="#section-15.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.1-2.2">
              <p id="section-15.1.1-2.2.1">Label: TBD1 (requested assignment 17)<a href="#section-15.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.1-2.3">
              <p id="section-15.1.1-2.3.1">Value Type: bstr<a href="#section-15.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.1-2.4">
              <p id="section-15.1.1-2.4.1">Value Registry: (empty)<a href="#section-15.1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.1-2.5">
              <p id="section-15.1.1-2.5.1">Description: A list of selectively disclosed claims, which were originally redacted, then later disclosed at the discretion of the sender.<a href="#section-15.1.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.1-2.6">
              <p id="section-15.1.1-2.6.1">Reference: <a href="#sd-cwt-preparation" class="auto internal xref">Section 4</a> of this specification<a href="#section-15.1.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sdalg">
<section id="section-15.1.2">
          <h4 id="name-sd_alg">
<a href="#section-15.1.2" class="section-number selfRef">15.1.2. </a><a href="#name-sd_alg" class="section-name selfRef">sd_alg</a>
          </h4>
<p id="section-15.1.2-1">The following completed registration template per RFC8152 is provided:<a href="#section-15.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1.2-2.1">
              <p id="section-15.1.2-2.1.1">Name: sd_alg<a href="#section-15.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.2-2.2">
              <p id="section-15.1.2-2.2.1">Label: TBD2 (requested assignment 18)<a href="#section-15.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.2-2.3">
              <p id="section-15.1.2-2.3.1">Value Type: int<a href="#section-15.1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.2-2.4">
              <p id="section-15.1.2-2.4.1">Value Registry: IANA COSE Algorithms<a href="#section-15.1.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.2-2.5">
              <p id="section-15.1.2-2.5.1">Description: The hash algorithm used for redacting disclosures.<a href="#section-15.1.2-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.2-2.6">
              <p id="section-15.1.2-2.6.1">Reference: <a href="#sd-cwt-issuance" class="auto internal xref">Section 7</a> of this specification<a href="#section-15.1.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sdencryptedclaims">
<section id="section-15.1.3">
          <h4 id="name-sd_encrypted_claims">
<a href="#section-15.1.3" class="section-number selfRef">15.1.3. </a><a href="#name-sd_encrypted_claims" class="section-name selfRef">sd_encrypted_claims</a>
          </h4>
<p id="section-15.1.3-1">The following completed registration template per RFC8152 is provided:<a href="#section-15.1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1.3-2.1">
              <p id="section-15.1.3-2.1.1">Name: sd_encrypted_claims<a href="#section-15.1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.3-2.2">
              <p id="section-15.1.3-2.2.1">Label: TBD6 (requested assignment 19)<a href="#section-15.1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.3-2.3">
              <p id="section-15.1.3-2.3.1">Value Type: bstr<a href="#section-15.1.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.3-2.4">
              <p id="section-15.1.3-2.4.1">Value Registry: (empty)<a href="#section-15.1.3-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.3-2.5">
              <p id="section-15.1.3-2.5.1">Description: A list of AEAD encrypted selectively disclosed claims, which were originally redacted, then later disclosed at the discretion of the sender.<a href="#section-15.1.3-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.3-2.6">
              <p id="section-15.1.3-2.6.1">Reference: <a href="#aead" class="auto internal xref">Section 11.1</a> of this specification<a href="#section-15.1.3-2.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sdaead">
<section id="section-15.1.4">
          <h4 id="name-sd_aead">
<a href="#section-15.1.4" class="section-number selfRef">15.1.4. </a><a href="#name-sd_aead" class="section-name selfRef">sd_aead</a>
          </h4>
<p id="section-15.1.4-1">The following completed registration template per RFC8152 is provided:<a href="#section-15.1.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1.4-2.1">
              <p id="section-15.1.4-2.1.1">Name: sd_aead<a href="#section-15.1.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.4-2.2">
              <p id="section-15.1.4-2.2.1">Label: TBD7 (requested assignment 20)<a href="#section-15.1.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.4-2.3">
              <p id="section-15.1.4-2.3.1">Value Type: int<a href="#section-15.1.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.4-2.4">
              <p id="section-15.1.4-2.4.1">Value Registry: IANA AEAD Algorithm number<a href="#section-15.1.4-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.4-2.5">
              <p id="section-15.1.4-2.5.1">Description: The AEAD algorithm used for encrypting disclosures.<a href="#section-15.1.4-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.4-2.6">
              <p id="section-15.1.4-2.6.1">Reference: <a href="#aead" class="auto internal xref">Section 11.1</a> of this specification<a href="#section-15.1.4-2.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sdcoseencryptedclaims">
<section id="section-15.1.5">
          <h4 id="name-sd_cose_encrypted_claims">
<a href="#section-15.1.5" class="section-number selfRef">15.1.5. </a><a href="#name-sd_cose_encrypted_claims" class="section-name selfRef">sd_cose_encrypted_claims</a>
          </h4>
<p id="section-15.1.5-1">The following completed registration template per RFC8152 is provided:<a href="#section-15.1.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1.5-2.1">
              <p id="section-15.1.5-2.1.1">Name: sd_cose_encrypted_claims<a href="#section-15.1.5-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.5-2.2">
              <p id="section-15.1.5-2.2.1">Label: TBD8 (requested assignment 21)<a href="#section-15.1.5-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.5-2.3">
              <p id="section-15.1.5-2.3.1">Value Type: bstr<a href="#section-15.1.5-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.5-2.4">
              <p id="section-15.1.5-2.4.1">Value Registry: (empty)<a href="#section-15.1.5-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.5-2.5">
              <p id="section-15.1.5-2.5.1">Description: A list of COSE encrypted selectively disclosed claims, which were originally redacted, then later disclosed at the discretion of the sender.<a href="#section-15.1.5-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.5-2.6">
              <p id="section-15.1.5-2.6.1">Reference: <a href="#cose-encrypted" class="auto internal xref">Section 11.2</a> of this specification<a href="#section-15.1.5-2.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="simple59">
<section id="section-15.2">
        <h3 id="name-cbor-simple-values">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-cbor-simple-values" class="section-name selfRef">CBOR Simple Values</a>
        </h3>
<p id="section-15.2-1">IANA is requested to add the following entry to the IANA "CBOR Simple Values" registry (https://www.iana.org/assignments/cbor-simple-values):<a href="#section-15.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.2-2.1">
            <p id="section-15.2-2.1.1">Value: TBD4 (requested assignment 59)<a href="#section-15.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.2-2.2">
            <p id="section-15.2-2.2.1">Semantics: This value as a map key indicates that the claim value is an array of redacted claim keys at the same level as the map key.<a href="#section-15.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.2-2.3">
            <p id="section-15.2-2.3.1">Specification Document(s): <a href="#blinded-claims" class="auto internal xref">Section 6.1</a> of this specification<a href="#section-15.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="cbor-tags">
<section id="section-15.3">
        <h3 id="name-cbor-tags">
<a href="#section-15.3" class="section-number selfRef">15.3. </a><a href="#name-cbor-tags" class="section-name selfRef">CBOR Tags</a>
        </h3>
<p id="section-15.3-1">IANA is requested to add the following entries to the IANA "CBOR Tags" registry (https://www.iana.org/assignments/cbor-tags/cbor-tags.xhtml):<a href="#section-15.3-1" class="pilcrow">¶</a></p>
<div id="to-be-redacted-tag">
<section id="section-15.3.1">
          <h4 id="name-to-be-redacted-tag">
<a href="#section-15.3.1" class="section-number selfRef">15.3.1. </a><a href="#name-to-be-redacted-tag" class="section-name selfRef">To Be Redacted Tag</a>
          </h4>
<p id="section-15.3.1-1">The array claim element, or map key and value inside the "To be redacted" tag is intended to be redacted using selective disclosure.<a href="#section-15.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.3.1-2.1">
              <p id="section-15.3.1-2.1.1">Tag: TBD3 (requested assignment 58)<a href="#section-15.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.3.1-2.2">
              <p id="section-15.3.1-2.2.1">Data Item: (any)<a href="#section-15.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.3.1-2.3">
              <p id="section-15.3.1-2.3.1">Semantics: An array claim element, or map key and value intended to be redacted.<a href="#section-15.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.3.1-2.4">
              <p id="section-15.3.1-2.4.1">Specification Document(s): <a href="#blinded-claims" class="auto internal xref">Section 6.1</a> of this specification<a href="#section-15.3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="redacted-claim-element-tag">
<section id="section-15.3.2">
          <h4 id="name-redacted-claim-element-tag">
<a href="#section-15.3.2" class="section-number selfRef">15.3.2. </a><a href="#name-redacted-claim-element-tag" class="section-name selfRef">Redacted Claim Element Tag</a>
          </h4>
<p id="section-15.3.2-1">The byte string inside the tag is a selective disclosure redacted claim element of an array.<a href="#section-15.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.3.2-2.1">
              <p id="section-15.3.2-2.1.1">Tag: TBD5 (requested assignment 60)<a href="#section-15.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.3.2-2.2">
              <p id="section-15.3.2-2.2.1">Data Item: byte string<a href="#section-15.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.3.2-2.3">
              <p id="section-15.3.2-2.3.1">Semantics: A selective disclosure redacted (array) claim element.<a href="#section-15.3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.3.2-2.4">
              <p id="section-15.3.2-2.4.1">Specification Document(s): <a href="#blinded-claims" class="auto internal xref">Section 6.1</a> of this specification<a href="#section-15.3.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="cbor-web-token-cwt-claims">
<section id="section-15.4">
        <h3 id="name-cbor-web-token-cwt-claims">
<a href="#section-15.4" class="section-number selfRef">15.4. </a><a href="#name-cbor-web-token-cwt-claims" class="section-name selfRef">CBOR Web Token (CWT) Claims</a>
        </h3>
<p id="section-15.4-1">IANA is requested to add the following entry to the IANA "CWT Claims" registry (https://www.iana.org/assignments/cwt/cwt.xhtml):<a href="#section-15.4-1" class="pilcrow">¶</a></p>
<div id="vct">
<section id="section-15.4.1">
          <h4 id="name-vct">
<a href="#section-15.4.1" class="section-number selfRef">15.4.1. </a><a href="#name-vct" class="section-name selfRef">vct</a>
          </h4>
<p id="section-15.4.1-1">The following completed registration template per RFC8392 is provided:<a href="#section-15.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.4.1-2.1">
              <p id="section-15.4.1-2.1.1">Claim Name: vct<a href="#section-15.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.4.1-2.2">
              <p id="section-15.4.1-2.2.1">Claim Description: Verifiable credential type<a href="#section-15.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.4.1-2.3">
              <p id="section-15.4.1-2.3.1">JWT Claim Name: vct<a href="#section-15.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.4.1-2.4">
              <p id="section-15.4.1-2.4.1">Claim Key: TBD6 (request assignment 11)<a href="#section-15.4.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.4.1-2.5">
              <p id="section-15.4.1-2.5.1">Claim Value Type(s): bstr<a href="#section-15.4.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.4.1-2.6">
              <p id="section-15.4.1-2.6.1">Change Controller: IETF<a href="#section-15.4.1-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.4.1-2.7">
              <p id="section-15.4.1-2.7.1">Specification Document(s): <a href="#cred-types" class="auto internal xref">Section 12</a> of this specification<a href="#section-15.4.1-2.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="media-types">
<section id="section-15.5">
        <h3 id="name-media-types">
<a href="#section-15.5" class="section-number selfRef">15.5. </a><a href="#name-media-types" class="section-name selfRef">Media Types</a>
        </h3>
<p id="section-15.5-1">IANA is requested to add the following entries to the IANA "Media Types" registry (https://www.iana.org/assignments/media-types/media-types.xhtml):<a href="#section-15.5-1" class="pilcrow">¶</a></p>
<div id="applicationsdcwt">
<section id="section-15.5.1">
          <h4 id="name-application-sdcwt">
<a href="#section-15.5.1" class="section-number selfRef">15.5.1. </a><a href="#name-application-sdcwt" class="section-name selfRef">application/sd+cwt</a>
          </h4>
<p id="section-15.5.1-1">The following completed registration template is provided:<a href="#section-15.5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.5.1-2.1">
              <p id="section-15.5.1-2.1.1">Type name: application<a href="#section-15.5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.2">
              <p id="section-15.5.1-2.2.1">Subtype name: sd+cwt<a href="#section-15.5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.3">
              <p id="section-15.5.1-2.3.1">Required parameters: n/a<a href="#section-15.5.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.4">
              <p id="section-15.5.1-2.4.1">Optional parameters: n/a<a href="#section-15.5.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.5">
              <p id="section-15.5.1-2.5.1">Encoding considerations: binary<a href="#section-15.5.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.6">
              <p id="section-15.5.1-2.6.1">Security considerations: <a href="#security" class="auto internal xref">Section 14</a> of this specification and <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span><a href="#section-15.5.1-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.7">
              <p id="section-15.5.1-2.7.1">Interoperability considerations: n/a<a href="#section-15.5.1-2.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.8">
              <p id="section-15.5.1-2.8.1">Published specification: <a href="#sd-cwt-definition" class="auto internal xref">Section 6</a> of this specification<a href="#section-15.5.1-2.8.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.9">
              <p id="section-15.5.1-2.9.1">Applications that use this media type: TBD<a href="#section-15.5.1-2.9.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.10">
              <p id="section-15.5.1-2.10.1">Fragment identifier considerations: n/a<a href="#section-15.5.1-2.10.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.11">
              <p id="section-15.5.1-2.11.1">Additional information:<a href="#section-15.5.1-2.11.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.5.1-2.11.2.1">
                  <p id="section-15.5.1-2.11.2.1.1">Magic number(s): n/a<a href="#section-15.5.1-2.11.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-15.5.1-2.11.2.2">
                  <p id="section-15.5.1-2.11.2.2.1">File extension(s): n/a<a href="#section-15.5.1-2.11.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-15.5.1-2.11.2.3">
                  <p id="section-15.5.1-2.11.2.3.1">Macintosh file type code(s): n/a<a href="#section-15.5.1-2.11.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-15.5.1-2.12">
              <p id="section-15.5.1-2.12.1">Person &amp; email address to contact for further information:
  SPICE WG mailing list (spice@ietf.org) or
  IETF Security Area (saag@ietf.org)<a href="#section-15.5.1-2.12.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.13">
              <p id="section-15.5.1-2.13.1">Intended usage: COMMON<a href="#section-15.5.1-2.13.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.14">
              <p id="section-15.5.1-2.14.1">Restrictions on usage: none<a href="#section-15.5.1-2.14.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.15">
              <p id="section-15.5.1-2.15.1">Author: See Author's Addresses section<a href="#section-15.5.1-2.15.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.16">
              <p id="section-15.5.1-2.16.1">Change controller: IETF<a href="#section-15.5.1-2.16.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.1-2.17">
              <p id="section-15.5.1-2.17.1">Provisional registration?  No<a href="#section-15.5.1-2.17.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="applicationkbcwt">
<section id="section-15.5.2">
          <h4 id="name-application-kbcwt">
<a href="#section-15.5.2" class="section-number selfRef">15.5.2. </a><a href="#name-application-kbcwt" class="section-name selfRef">application/kb+cwt</a>
          </h4>
<p id="section-15.5.2-1">The following completed registration template is provided:<a href="#section-15.5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.5.2-2.1">
              <p id="section-15.5.2-2.1.1">Type name: application<a href="#section-15.5.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.2">
              <p id="section-15.5.2-2.2.1">Subtype name: kb+cwt<a href="#section-15.5.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.3">
              <p id="section-15.5.2-2.3.1">Required parameters: n/a<a href="#section-15.5.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.4">
              <p id="section-15.5.2-2.4.1">Optional parameters: n/a<a href="#section-15.5.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.5">
              <p id="section-15.5.2-2.5.1">Encoding considerations: binary<a href="#section-15.5.2-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.6">
              <p id="section-15.5.2-2.6.1">Security considerations: <a href="#security" class="auto internal xref">Section 14</a> of this specification and <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span><a href="#section-15.5.2-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.7">
              <p id="section-15.5.2-2.7.1">Interoperability considerations: n/a<a href="#section-15.5.2-2.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.8">
              <p id="section-15.5.2-2.8.1">Published specification: <a href="#kbt" class="auto internal xref">Section 8.1</a> of this specification<a href="#section-15.5.2-2.8.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.9">
              <p id="section-15.5.2-2.9.1">Applications that use this media type: TBD<a href="#section-15.5.2-2.9.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.10">
              <p id="section-15.5.2-2.10.1">Fragment identifier considerations: n/a<a href="#section-15.5.2-2.10.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.11">
              <p id="section-15.5.2-2.11.1">Additional information:<a href="#section-15.5.2-2.11.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.5.2-2.11.2.1">
                  <p id="section-15.5.2-2.11.2.1.1">Magic number(s): n/a<a href="#section-15.5.2-2.11.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-15.5.2-2.11.2.2">
                  <p id="section-15.5.2-2.11.2.2.1">File extension(s): n/a<a href="#section-15.5.2-2.11.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-15.5.2-2.11.2.3">
                  <p id="section-15.5.2-2.11.2.3.1">Macintosh file type code(s): n/a<a href="#section-15.5.2-2.11.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-15.5.2-2.12">
              <p id="section-15.5.2-2.12.1">Person &amp; email address to contact for further information:
  SPICE WG mailing list (spice@ietf.org) or
  IETF Security Area (saag@ietf.org)<a href="#section-15.5.2-2.12.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.13">
              <p id="section-15.5.2-2.13.1">Intended usage: COMMON<a href="#section-15.5.2-2.13.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.14">
              <p id="section-15.5.2-2.14.1">Restrictions on usage: none<a href="#section-15.5.2-2.14.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.15">
              <p id="section-15.5.2-2.15.1">Author: See Author's Addresses section<a href="#section-15.5.2-2.15.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.16">
              <p id="section-15.5.2-2.16.1">Change controller: IETF<a href="#section-15.5.2-2.16.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.5.2-2.17">
              <p id="section-15.5.2-2.17.1">Provisional registration?  No<a href="#section-15.5.2-2.17.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="content-formats">
<section id="section-15.6">
        <h3 id="name-content-formats">
<a href="#section-15.6" class="section-number selfRef">15.6. </a><a href="#name-content-formats" class="section-name selfRef">Content-Formats</a>
        </h3>
<p id="section-15.6-1">IANA is requested to register the following entries in the "CoAP Content-Formats" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group <span>[<a href="#IANA.core-parameters" class="cite xref">IANA.core-parameters</a>]</span>:<a href="#section-15.6-1" class="pilcrow">¶</a></p>
<span id="name-new-coap-content-formats"></span><table class="left" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-new-coap-content-formats" class="selfRef">New CoAP Content Formats</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Content-Type</th>
              <th class="text-left" rowspan="1" colspan="1">Content Coding</th>
              <th class="text-left" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">application/sd+cwt</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">TBD11</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#sd-cwt-definition" class="auto internal xref">Section 6</a> of this specification</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">application/kb+cwt</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">TBD12</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#kbt" class="auto internal xref">Section 8.1</a> of this specification</td>
            </tr>
          </tbody>
        </table>
<p id="section-15.6-3">If possible, TBD11 and TBD12 should be assigned in the 256..9999 range.<a href="#section-15.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vct-registry">
<section id="section-15.7">
        <h3 id="name-verifiable-credential-type-">
<a href="#section-15.7" class="section-number selfRef">15.7. </a><a href="#name-verifiable-credential-type-" class="section-name selfRef">Verifiable Credential Type Identifiers</a>
        </h3>
<p id="section-15.7-1">This specification establishes the Verifiable Credential Type Identifiers registry, under the <a href="https://www.iana.org/assignments/cwt/cwt.xhtml">IANA "CBOR Web Token (CWT) Claims" group registry heading</a>.
It registers identifiers for the type of the SD-CWT Claims Set.<a href="#section-15.7-1" class="pilcrow">¶</a></p>
<p id="section-15.7-2">It enables short integers in the range 0-65535 to be used as <code>vct</code> claim values, similarly to how CoAP Content-Formats (<span><a href="https://rfc-editor.org/rfc/rfc7252#section-12.3" class="relref">Section 12.3</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>) enable short integers to be used as <code>typ</code> header parameter <span>[<a href="#RFC9596" class="cite xref">RFC9596</a>]</span> values.<a href="#section-15.7-2" class="pilcrow">¶</a></p>
<p id="section-15.7-3">The registration procedures for numbers in specific ranges are as described below:<a href="#section-15.7-3" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Range</th>
              <th class="text-left" rowspan="1" colspan="1">Registration Procedure </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0-9999</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">10000-64999</td>
              <td class="text-left" rowspan="1" colspan="1">First Come First Served</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">65000-65535</td>
              <td class="text-left" rowspan="1" colspan="1">Experimental Use (no operational use)</td>
            </tr>
          </tbody>
        </table>
<p id="section-15.7-5">Values in the Specification Required <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> range are registered
after a two-week review period on the spice-ext-review@ietf.org
mailing list, on the advice of one or more Designated Experts.
To allow for the allocation of values prior to publication
of the final version of a specification,
the Designated Experts may approve registration once they are satisfied
that the specification will be completed and published.
However, if the specification is not completed and published
in a timely manner, as determined by the Designated Experts,
the Designated Experts may request that IANA withdraw the registration.<a href="#section-15.7-5" class="pilcrow">¶</a></p>
<p id="section-15.7-6">Registration requests sent to the mailing list for review should use
an appropriate subject
(e.g., "Request to register VCT value").<a href="#section-15.7-6" class="pilcrow">¶</a></p>
<p id="section-15.7-7">Within the review period, the Designated Experts will either approve or deny
the registration request, communicating this decision to the review list and IANA.
Denials should include an explanation and, if applicable,
suggestions as to how to make the request successful.
The IANA escalation process is followed when the Designated Experts
are not responsive within 14 days.<a href="#section-15.7-7" class="pilcrow">¶</a></p>
<p id="section-15.7-8">Criteria that should be applied by the Designated Experts includes
determining whether the proposed registration duplicates existing functionality,
determining whether it is likely to be of general applicability
or whether it is useful only for a single application,
and whether the registration makes sense.<a href="#section-15.7-8" class="pilcrow">¶</a></p>
<p id="section-15.7-9">IANA must only accept registry updates from the Designated Experts and should direct
all requests for registration in the Specification Required range
to the review mailing list.<a href="#section-15.7-9" class="pilcrow">¶</a></p>
<p id="section-15.7-10">It is suggested that multiple Designated Experts be appointed who are able to
represent the perspectives of different applications using this specification,
in order to enable broadly-informed review of registration decisions.
In cases where a registration decision could be perceived as
creating a conflict of interest for a particular Expert,
that Expert should defer to the judgment of the other Experts.<a href="#section-15.7-10" class="pilcrow">¶</a></p>
<div id="registration-template">
<section id="section-15.7.1">
          <h4 id="name-registration-template">
<a href="#section-15.7.1" class="section-number selfRef">15.7.1. </a><a href="#name-registration-template" class="section-name selfRef">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-15.7.1-1">
            <dt id="section-15.7.1-1.1">Verifiable Credential Type Identifier String:</dt>
            <dd style="margin-left: 1.5em" id="section-15.7.1-1.2">
              <p id="section-15.7.1-1.2.1">String identifier for use as a JWT <code>vct</code> or CWT <code>vct</code> claim value.  It is a StringOrURI value.<a href="#section-15.7.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-15.7.1-1.3">Verifiable Credential Type Identifier Number:</dt>
            <dd style="margin-left: 1.5em" id="section-15.7.1-1.4">
              <p id="section-15.7.1-1.4.1">Integer in the range 0-64999 for use as a CWT <code>vct</code> claim value.  (Integers in the range 65000-65535 are not to be registered.)<a href="#section-15.7.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-15.7.1-1.5">Description:</dt>
            <dd style="margin-left: 1.5em" id="section-15.7.1-1.6">
              <p id="section-15.7.1-1.6.1">Brief description of the verifiable credential type<a href="#section-15.7.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-15.7.1-1.7">Change Controller:</dt>
            <dd style="margin-left: 1.5em" id="section-15.7.1-1.8">
              <p id="section-15.7.1-1.8.1">For IETF stream RFCs, use "IETF".
For others, give the name of the responsible party.
Other details (e.g., postal address, e-mail address, home page URI) may also be included.<a href="#section-15.7.1-1.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-15.7.1-1.9">Specification Document(s):</dt>
            <dd style="margin-left: 1.5em" id="section-15.7.1-1.10">
              <p id="section-15.7.1-1.10.1">Reference to the document or documents that specify the values to be registered,
preferably including URLs that can be used to retrieve the documents.
An indication of the relevant sections may also be included, but is not required.<a href="#section-15.7.1-1.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="initial-registry-contents">
<section id="section-15.7.2">
          <h4 id="name-initial-registry-contents">
<a href="#section-15.7.2" class="section-number selfRef">15.7.2. </a><a href="#name-initial-registry-contents" class="section-name selfRef">Initial Registry Contents</a>
          </h4>
<p id="section-15.7.2-1">No initial values are provided for the registry.<a href="#section-15.7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-16">
      <h2 id="name-references">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-16.1">
        <h3 id="name-normative-references">
<a href="#section-16.1" class="section-number selfRef">16.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BCP205">[BCP205]</dt>
        <dd>
<div class="refInstance">Best Current Practice 205, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp205">https://www.rfc-editor.org/info/bcp205</a>&gt;</span>.<br><span>At the time of writing, this BCP comprises the following:</span>
</div>
<div class="refInstance" id="RFC7942">
            <span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7942">https://www.rfc-editor.org/info/rfc7942</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cbor-edn-literals">[I-D.ietf-cbor-edn-literals]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"CBOR Extended Diagnostic Notation (EDN)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cbor-edn-literals-17</span>, <time datetime="2025-05-12" class="refDate">12 May 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-literals-17">https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-literals-17</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.core-parameters">[IANA.core-parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/core-parameters">https://www.iana.org/assignments/core-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5116">https://www.rfc-editor.org/rfc/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8747">https://www.rfc-editor.org/rfc/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9053">https://www.rfc-editor.org/rfc/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9502">[RFC9502]</dt>
        <dd>
<span class="refAuthor">Britto, W.</span>, <span class="refAuthor">Hegde, S.</span>, <span class="refAuthor">Kaneriya, P.</span>, <span class="refAuthor">Shetty, R.</span>, <span class="refAuthor">Bonica, R.</span>, and <span class="refAuthor">P. Psenak</span>, <span class="refTitle">"IGP Flexible Algorithm in IP Networks"</span>, <span class="seriesInfo">RFC 9502</span>, <span class="seriesInfo">DOI 10.17487/RFC9502</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9502">https://www.rfc-editor.org/rfc/rfc9502</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9528">[RFC9528]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="seriesInfo">RFC 9528</span>, <span class="seriesInfo">DOI 10.17487/RFC9528</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9528">https://www.rfc-editor.org/rfc/rfc9528</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9596">[RFC9596]</dt>
        <dd>
<span class="refAuthor">Jones, M.B.</span> and <span class="refAuthor">O. Steele</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE) "typ" (type) Header Parameter"</span>, <span class="seriesInfo">RFC 9596</span>, <span class="seriesInfo">DOI 10.17487/RFC9596</span>, <time datetime="2024-06" class="refDate">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9596">https://www.rfc-editor.org/rfc/rfc9596</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9679">[RFC9679]</dt>
      <dd>
<span class="refAuthor">Isobe, K.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">O. Steele</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE) Key Thumbprint"</span>, <span class="seriesInfo">RFC 9679</span>, <span class="seriesInfo">DOI 10.17487/RFC9679</span>, <time datetime="2024-12" class="refDate">December 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9679">https://www.rfc-editor.org/rfc/rfc9679</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-16.2">
        <h3 id="name-informative-references">
<a href="#section-16.2" class="section-number selfRef">16.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.draft-ietf-cbor-cde">[I-D.draft-ietf-cbor-cde]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"CBOR Common Deterministic Encoding (CDE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cbor-cde-11</span>, <time datetime="2025-05-12" class="refDate">12 May 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-cde-11">https://datatracker.ietf.org/doc/html/draft-ietf-cbor-cde-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-keytrans-protocol">[I-D.draft-ietf-keytrans-protocol]</dt>
        <dd>
<span class="refAuthor">McMillion, B.</span> and <span class="refAuthor">F. Linker</span>, <span class="refTitle">"Key Transparency Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-keytrans-protocol-01</span>, <time datetime="2025-06-04" class="refDate">4 June 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-keytrans-protocol-01">https://datatracker.ietf.org/doc/html/draft-ietf-keytrans-protocol-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-oauth-sd-jwt-vc">[I-D.draft-ietf-oauth-sd-jwt-vc]</dt>
        <dd>
<span class="refAuthor">Terbu, O.</span>, <span class="refAuthor">Fett, D.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"SD-JWT-based Verifiable Credentials (SD-JWT VC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-sd-jwt-vc-09</span>, <time datetime="2025-05-28" class="refDate">28 May 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-sd-jwt-vc-09">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-sd-jwt-vc-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-oauth-selective-disclosure-jwt">[I-D.draft-ietf-oauth-selective-disclosure-jwt]</dt>
        <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Yasuda, K.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"Selective Disclosure for JWTs (SD-JWT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-selective-disclosure-jwt-22</span>, <time datetime="2025-05-29" class="refDate">29 May 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-22">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-22</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-httpbis-unprompted-auth">[I-D.ietf-httpbis-unprompted-auth]</dt>
        <dd>
<span class="refAuthor">Schinazi, D.</span>, <span class="refAuthor">Oliver, D.</span>, and <span class="refAuthor">J. Hoyland</span>, <span class="refTitle">"The Concealed HTTP Authentication Scheme"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-unprompted-auth-12</span>, <time datetime="2024-09-19" class="refDate">19 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-unprompted-auth-12">https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-unprompted-auth-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mahy-mls-sd-cwt-credential">[I-D.mahy-mls-sd-cwt-credential]</dt>
        <dd>
<span class="refAuthor">Mahy, R.</span>, <span class="refTitle">"Messaging Layer Security credentials using Selective Disclosure CBOR Web Tokens"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mahy-mls-sd-cwt-credential-00</span>, <time datetime="2025-03-02" class="refDate">2 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-mahy-mls-sd-cwt-credential-00">https://datatracker.ietf.org/doc/html/draft-mahy-mls-sd-cwt-credential-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.Core.Parameters">[IANA.Core.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Parameters"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.iana.org/assignments/core-parameters">https://www.iana.org/assignments/core-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.CWT">[IANA.CWT]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"CBOR Web Token (CWT) Claims"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.iana.org/assignments/cwt">https://www.iana.org/assignments/cwt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9162">[RFC9162]</dt>
        <dd>
<span class="refAuthor">Laurie, B.</span>, <span class="refAuthor">Messeri, E.</span>, and <span class="refAuthor">R. Stradling</span>, <span class="refTitle">"Certificate Transparency Version 2.0"</span>, <span class="seriesInfo">RFC 9162</span>, <span class="seriesInfo">DOI 10.17487/RFC9162</span>, <time datetime="2021-12" class="refDate">December 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9162">https://www.rfc-editor.org/rfc/rfc9162</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9334">https://www.rfc-editor.org/rfc/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9420">[RFC9420]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Beurdouche, B.</span>, <span class="refAuthor">Robert, R.</span>, <span class="refAuthor">Millican, J.</span>, <span class="refAuthor">Omara, E.</span>, and <span class="refAuthor">K. Cohn-Gordon</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Protocol"</span>, <span class="seriesInfo">RFC 9420</span>, <span class="seriesInfo">DOI 10.17487/RFC9420</span>, <time datetime="2023-07" class="refDate">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9420">https://www.rfc-editor.org/rfc/rfc9420</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="t-Closeness">[t-Closeness]</dt>
      <dd>
<span class="refTitle">"t-Closeness: Privacy Beyond k-Anonymity and l-Diversity"</span>, <time datetime="2007-06-04" class="refDate">4 June 2007</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/4221659">https://ieeexplore.ieee.org/document/4221659</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="cddl">
<section id="appendix-A">
      <h2 id="name-complete-cddl-schema">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-complete-cddl-schema" class="section-name selfRef">Complete CDDL Schema</a>
      </h2>
<span id="name-a-complete-cddl-description"></span><div id="cddl-schema">
<figure id="figure-7">
        <div class="breakable lang-cddl sourcecode" id="appendix-A-1.1">
<pre>
sd-cwt-types = sd-cwt-issued / kbt-cwt

sd-cwt-issued = #6.18([
   protected: bstr .cbor sd-protected,
   sd-unprotected,
   payload: bstr .cbor sd-payload,
   signature: bstr
])

kbt-cwt = #6.18([
   protected: bstr .cbor kbt-protected,
   kbt-unprotected,
   payload: bstr .cbor kbt-payload,
   signature: bstr
])

sd-protected = {
   &amp;(typ: 16) ^ =&gt; "application/sd+cwt" / TBD11,
   &amp;(alg: 1) ^ =&gt; int,
   &amp;(sd_alg: TBD2) ^ =&gt; int,        ; -16 for sha-256
   ? &amp;(sd_aead: TBD7) ^ =&gt; uint .size 2
   * key =&gt; any
}

kbt-protected = {
   &amp;(typ: 16) ^ =&gt; "application/kb+cwt" / TBD12,
   &amp;(alg: 1) ^ =&gt; int,
   &amp;(kcwt: 13) ^ =&gt; sd-cwt-issued,
   * key =&gt; any
}

sd-unprotected = {
   ? &amp;(sd_claims: TBD1) ^ =&gt; salted-array,
   ? &amp;(sd_encrypted_claims: TBD6) ^ =&gt; encrypted-array,
   ? &amp;(sd_cose_encrypted_claims: TBD8) ^ =&gt; cose-encrypted-array,
   * key =&gt; any
}

kbt-unprotected = {
   * key =&gt; any
}

sd-payload = {
    ; standard claims
      &amp;(iss: 1) ^ =&gt; tstr, ; "https://issuer.example"
    ? &amp;(sub: 2) ^ =&gt; tstr, ; "https://device.example"
    ? &amp;(aud: 3) ^ =&gt; tstr, ; "https://verifier.example/app"
    ? &amp;(exp: 4) ^ =&gt; int,  ; 1883000000
    ? &amp;(nbf: 5) ^ =&gt; int,  ; 1683000000
    ? &amp;(iat: 6) ^ =&gt; int,  ; 1683000000
    ? &amp;(cti: 7) ^ =&gt; bstr,
      &amp;(cnf: 8) ^ =&gt; { * key =&gt; any }, ; key confirmation
    ? &amp;(cnonce: 39) ^ =&gt; bstr,
    ;
    ? &amp;(redacted_claim_keys: REDACTED_KEYS) ^ =&gt; [ * bstr ],
    * key =&gt; any
}

kbt-payload = {
      &amp;(aud: 3) ^ =&gt; tstr, ; "https://verifier.example/app"
    ? &amp;(exp: 4) ^ =&gt; int,  ; 1883000000
    ? &amp;(nbf: 5) ^ =&gt; int,  ; 1683000000
      &amp;(iat: 6) ^ =&gt; int,  ; 1683000000
    ? &amp;(cnonce: 39) ^ =&gt; bstr,
    * key =&gt; any
}

salted-array = [ +bstr .cbor salted ]
salted = salted-claim / salted-element / decoy
salted-claim = [
  bstr .size 16,     ; 128-bit salt
  any,               ; claim value
  (int / text)       ; claim name
]
salted-element = [
  bstr .size 16,     ; 128-bit salt
  any                ; claim value
]
decoy = [
  bstr .size 16      ; 128-bit salt
]
;bstr-encoded-salted = bstr .cbor salted

encrypted-array = [ +encrypted ]
encrypted = [
  bstr .size 16,     ; 128-bit nonce
  bstr,              ; the ciphertext output of a bstr-encoded-salted
                     ;   with a matching salt
  bstr               ; the corresponding MAC
]

cose-encrypted-array = [ +cose-encrypted ]
cose-encrypted = COSE_Encrypt0_Tagged / COSE_Encrypt_Tagged

COSE_Encrypt0_Tagged = #6.16(COSE_Encrypt0)
COSE_Encrypt_Tagged = #6.96(COSE_Encrypt)

COSE_Encrypt0 = [
    Headers,
    ciphertext : bstr / nil,
]

COSE_Encrypt = [
    Headers,
    ciphertext : bstr / nil,
    recipients : [+COSE_recipient]
]

COSE_recipient = [
    Headers,
    ciphertext : bstr / nil,
    ? recipients : [+COSE_recipient]
]

Headers = (
    protected : empty_or_serialized_map,
    unprotected : header_map
)
header_map = {
    * key =&gt; any
}
empty_or_serialized_map = bstr .cbor header_map / bstr .size 0

key = int / text
TBD1 = 17
TBD2 = 18
TBD6 = 19
TBD7 = 20
TBD8 = 21

;TBD3 = 58;  CBOR tag wrapping to-be-redacted keys or elements

TBD11 = 298
TBD12 = 299

; REDACTED_KEYS is to be used in CDDL payloads that are meant to
; convey that a map key is redacted.
REDACTED_KEYS = #7.59  ; #7.&lt;TBD4&gt;
;TBD4 = 59          ; for CBOR simple value 59

; redacted_claim_element is to be used in CDDL payloads that contain
; array elements that are meant to be redacted.
redacted_claim_element = #6.60( bstr .size 16 )  ; #6.&lt;TBD5&gt;(bstr)
;TBD5 = 60; CBOR tag wrapping redacted_claim_element

</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-a-complete-cddl-description" class="selfRef">A complete CDDL description of SD-CWT</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="comparison-to-sd-jwt">
<section id="appendix-B">
      <h2 id="name-comparison-to-sd-jwt">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-comparison-to-sd-jwt" class="section-name selfRef">Comparison to SD-JWT</a>
      </h2>
<p id="appendix-B-1">SD-CWT is modeled after SD-JWT, with adjustments to align with conventions in CBOR, COSE, and CWT.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="media-types-1">
<section id="appendix-B.1">
        <h3 id="name-media-types-2">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-media-types-2" class="section-name selfRef">Media Types</a>
        </h3>
<p id="appendix-B.1-1">The COSE equivalent of <code>application/sd-jwt</code> is <code>application/sd+cwt</code>.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">The COSE equivalent of <code>application/kb+jwt</code> is <code>application/kb+cwt</code>.<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<p id="appendix-B.1-3">No COSE equivalent of the "+sd-jwt" media type suffix is presently defined.<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redaction-claims">
<section id="appendix-B.2">
        <h3 id="name-redaction-claims">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-redaction-claims" class="section-name selfRef">Redaction Claims</a>
        </h3>
<p id="appendix-B.2-1">The COSE equivalent of <code>_sd</code> is a CBOR Simple Value (requested assignment 59). The following value is an array of the redacted claim keys.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">The COSE equivalent of <code>...</code> is a CBOR tag (requested assignment 60) of the digested salted claim.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2-3">In SD-CWT, the order of the fields in a disclosure is salt, value, key.
In SD-JWT the order of fields in a disclosure is salt, key, value.
This choice ensures that the second element in the CBOR array is always the value, which makes parsing faster and more efficient in strongly-typed programming languages.<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuance">
<section id="appendix-B.3">
        <h3 id="name-issuance">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-issuance" class="section-name selfRef">Issuance</a>
        </h3>
<p id="appendix-B.3-1">The issuance process for SD-CWT is similar to SD-JWT, with the exception that a confirmation claim is <span class="bcp14">REQUIRED</span>.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation">
<section id="appendix-B.4">
        <h3 id="name-presentation">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-presentation" class="section-name selfRef">Presentation</a>
        </h3>
<p id="appendix-B.4-1">The presentation process for SD-CWT is similar to SD-JWT, except that a Key Binding Token is <span class="bcp14">REQUIRED</span>.
The Key Binding Token then includes the issued SD-CWT, including the Holder-selected disclosures.
Because the entire SD-CWT is included as a claim in the SD-KBT, the disclosures are covered by the Holder's signature in the SD-KBT, but not by the Issuer's signature in the SD-CWT.<a href="#appendix-B.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validation">
<section id="appendix-B.5">
        <h3 id="name-validation">
<a href="#appendix-B.5" class="section-number selfRef">B.5. </a><a href="#name-validation" class="section-name selfRef">Validation</a>
        </h3>
<p id="appendix-B.5-1">The validation process for SD-CWT is similar to SD-JWT, however, JSON Objects are replaced with CBOR Maps, which can contain integer keys and CBOR Tags.<a href="#appendix-B.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="keys-used-in-the-examples">
<section id="appendix-C">
      <h2 id="name-keys-used-in-the-examples">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-keys-used-in-the-examples" class="section-name selfRef">Keys Used in the Examples</a>
      </h2>
<div id="subject-holder">
<section id="appendix-C.1">
        <h3 id="name-subject-holder">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-subject-holder" class="section-name selfRef">Subject / Holder</a>
        </h3>
<p id="appendix-C.1-1">Holder COSE key pair in EDN format<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="appendix-C.1-2">
<pre>
{
  /kty/  1 : 2, /EC/
  /alg/  3 : -9, /ESP256/
  /crv/ -1 : 1, /P-256/
  /x/   -2 : h'8554eb275dcd6fbd1c7ac641aa2c90d9
               2022fd0d3024b5af18c7cc61ad527a2d',
  /y/   -3 : h'4dc7ae2c677e96d0cc82597655ce92d5
               503f54293d87875d1e79ce4770194343',
  /d/   -4 : h'5759a86e59bb3b002dde467da4b52f3d
               06e6c2cd439456cf0485b9b864294ce5'
}
</pre><a href="#appendix-C.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-3">The fields necessary for the COSE Key Thumbprint <span>[<a href="#RFC9679" class="cite xref">RFC9679</a>]</span>
in EDN format:<a href="#appendix-C.1-3" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="appendix-C.1-4">
<pre>
{
  /kty/  1 : 2, /EC/
  /crv/ -1 : 1, /P-256/
  /x/   -2 : h'8554eb275dcd6fbd1c7ac641aa2c90d9
               2022fd0d3024b5af18c7cc61ad527a2d',
  /y/   -3 : h'4dc7ae2c677e96d0cc82597655ce92d5
               503f54293d87875d1e79ce4770194343'
}
</pre><a href="#appendix-C.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-5">The same map in CBOR pretty printing<a href="#appendix-C.1-5" class="pilcrow">¶</a></p>
<div class="lang-cbor-pretty sourcecode" id="appendix-C.1-6">
<pre>
A4                                      # map(4)
   01                                   # unsigned(1)
   02                                   # unsigned(2)
   20                                   # negative(0)
   01                                   # unsigned(1)
   21                                   # negative(1)
   58 20                                # bytes(32)
      8554EB275DCD6FBD1C7AC641AA2C90D92022FD0D3024B5AF18C7CC61AD527A2D
   22                                   # negative(2)
   58 20                                # bytes(32)
      4DC7AE2C677E96D0CC82597655CE92D5503F54293D87875D1E79CE4770194343
</pre><a href="#appendix-C.1-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-7">The COSE thumbprint (in hexadecimal)--SHA256 hash of the thumbprint fields:<a href="#appendix-C.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-8">
<pre>
8343d73cdfcb81f2c7cd11a5f317be8eb34e4807ec8c9ceb282495cffdf037e0
</pre><a href="#appendix-C.1-8" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-9">Holder key pair in JWK format<a href="#appendix-C.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-10">
<pre>
{
  "kty": "EC",
  "alg": "ES256",
  "kid": "WRQ2RbY5RYJCIxfDQL9agl9fFSCYVu4Xocqb6zerc1M",
  "crv": "P-256",
  "x": "hVTrJ13Nb70cesZBqiyQ2SAi_Q0wJLWvGMfMYa1Sei0",
  "y": "TceuLGd-ltDMgll2Vc6S1VA_VCk9h4ddHnnOR3AZQ0M",
  "d": "V1moblm7OwAt3kZ9pLUvPQbmws1DlFbPBIW5uGQpTOU"
}
</pre><a href="#appendix-C.1-10" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-11">Input to Holder public JWK thumbprint (ignore line breaks)<a href="#appendix-C.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-12">
<pre>
{"crv":"P-256","kty":"EC","x":"hVTrJ13Nb70cesZBqiyQ2SAi_Q0wJLWvGMfMYa1S
ei0","y":"TceuLGd-ltDMgll2Vc6S1VA_VCk9h4ddHnnOR3AZQ0M"}
</pre><a href="#appendix-C.1-12" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-13">SHA-256 of the Holder public JWK input string (in hex)<a href="#appendix-C.1-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-14">
<pre>
59143645b6394582422317c340bf5a825f5f15209856ee17a1ca9beb37ab7353
</pre><a href="#appendix-C.1-14" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-15">Holder public JWK thumbprint<a href="#appendix-C.1-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-16">
<pre>
WRQ2RbY5RYJCIxfDQL9agl9fFSCYVu4Xocqb6zerc1M
</pre><a href="#appendix-C.1-16" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-17">Holder public key in PEM format<a href="#appendix-C.1-17" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-18">
<pre>
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhVTrJ13Nb70cesZBqiyQ2SAi/Q0w
JLWvGMfMYa1Sei1Nx64sZ36W0MyCWXZVzpLVUD9UKT2Hh10eec5HcBlDQw==
-----END PUBLIC KEY-----
</pre><a href="#appendix-C.1-18" class="pilcrow">¶</a>
</div>
<p id="appendix-C.1-19">Holder private key in PEM format<a href="#appendix-C.1-19" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-20">
<pre>
-----BEGIN PRIVATE KEY-----
MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgV1moblm7OwAt3kZ9
pLUvPQbmws1DlFbPBIW5uGQpTOWhRANCAASFVOsnXc1vvRx6xkGqLJDZICL9DTAk
ta8Yx8xhrVJ6LU3HrixnfpbQzIJZdlXOktVQP1QpPYeHXR55zkdwGUND
-----END PRIVATE KEY-----
</pre><a href="#appendix-C.1-20" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="issuer">
<section id="appendix-C.2">
        <h3 id="name-issuer">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-issuer" class="section-name selfRef">Issuer</a>
        </h3>
<p id="appendix-C.2-1">Issuer COSE key pair in Extended Diagnostic Notation (EDN)<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="appendix-C.2-2">
<pre>
{
  /kty/  1 : 2, /EC/
  /kid/  2 : "https://issuer.example/cwk3.cbor",
  /alg/  3 : -51, /ESP384/
  /crv/ -1 : 2, /P-384/
  /x/   -2 : h'c31798b0c7885fa3528fbf877e5b4c3a6dc67a5a5dc6b307
               b728c3725926f2abe5fb4964cd91e3948a5493f6ebb6cbbf',
  /y/   -3 : h'8f6c7ec761691cad374c4daa9387453f18058ece58eb0a8e
               84a055a31fb7f9214b27509522c159e764f8711e11609554',
  /d/   -4 : h'71c54d2221937ea612db1221f0d3ddf771c9381c4e3be41d
               5aa0a89d685f09cfef74c4bbf104783fd57e87ab227d074c'
}
</pre><a href="#appendix-C.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-3">The fields necessary for the COSE Key Thumbprint <span>[<a href="#RFC9679" class="cite xref">RFC9679</a>]</span>
in EDN format:<a href="#appendix-C.2-3" class="pilcrow">¶</a></p>
<div class="lang-cbor-diag sourcecode" id="appendix-C.2-4">
<pre>
{
  /kty/  1 : 2, /EC/
  /crv/ -1 : 2, /P-384/
  /x/   -2 : h'c31798b0c7885fa3528fbf877e5b4c3a6dc67a5a5dc6b307
               b728c3725926f2abe5fb4964cd91e3948a5493f6ebb6cbbf',
  /y/   -3 : h'8f6c7ec761691cad374c4daa9387453f18058ece58eb0a8e
               84a055a31fb7f9214b27509522c159e764f8711e11609554'
}
</pre><a href="#appendix-C.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-5">The same map in CBOR pretty printing<a href="#appendix-C.2-5" class="pilcrow">¶</a></p>
<div class="lang-cbor-pretty sourcecode" id="appendix-C.2-6">
<pre>
A4                                      # map(5)
   01                                   # unsigned(1)
   02                                   # unsigned(2)
   20                                   # negative(0)
   02                                   # unsigned(2)
   21                                   # negative(1)
   58 30                                # bytes(48)
      C31798B0C7885FA3528FBF877E5B4C3A6DC67A5A5DC6B307
      B728C3725926F2ABE5FB4964CD91E3948A5493F6EBB6CBBF
   22                                   # negative(2)
   58 30                                # bytes(48)
      8F6C7EC761691CAD374C4DAA9387453F18058ECE58EB0A8E
      84A055A31FB7F9214B27509522C159E764F8711E11609554
</pre><a href="#appendix-C.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-7">The COSE thumbprint (in hexadecimal)--SHA256 hash of the thumbprint fields:<a href="#appendix-C.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-8">
<pre>
554550a611c9807b3462cfec4a690a1119bc43b571da1219782133f5fd6dbcb0
</pre><a href="#appendix-C.2-8" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-9">Issuer key pair in JWK format<a href="#appendix-C.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-10">
<pre>
{
"kty": "EC",
"alg": "ES384",
"kid": "https://issuer.example/cwk3.cbor",
"crv": "P-384",
"x":"wxeYsMeIX6NSj7-HfltMOm3GelpdxrMHtyjDclkm8qvl-0lkzZHjlIpUk_brtsu_",
"y":"j2x-x2FpHK03TE2qk4dFPxgFjs5Y6wqOhKBVox-3-SFLJ1CVIsFZ52T4cR4RYJVU",
"d":"ccVNIiGTfqYS2xIh8NPd93HJOBxOO-QdWqConWhfCc_vdMS78QR4P9V-h6sifQdM"
}
</pre><a href="#appendix-C.2-10" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-11">Input to Issuer JWK thumbprint (ignore line breaks)<a href="#appendix-C.2-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-12">
<pre>
{"crv":"P-384","kty":"EC","x":"wxeYsMeIX6NSj7-HfltMOm3GelpdxrMHtyjDclkm
8qvl-0lkzZHjlIpUk_brtsu_","y":"j2x-x2FpHK03TE2qk4dFPxgFjs5Y6wqOhKBVox-3
-SFLJ1CVIsFZ52T4cR4RYJVU"}
</pre><a href="#appendix-C.2-12" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-13">SHA-256 of the Issuer JWK input string (in hex)<a href="#appendix-C.2-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-14">
<pre>
18d4ddb7065d945357e3972dee76af4eddc7c285fb42efcfa900c6a4f8437850
</pre><a href="#appendix-C.2-14" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-15">Issuer JWK thumbprint<a href="#appendix-C.2-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-16">
<pre>
GNTdtwZdlFNX45ct7navTt3HwoX7Qu_PqQDGpPhDeFA
</pre><a href="#appendix-C.2-16" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-17">Issuer public key in PEM format<a href="#appendix-C.2-17" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-18">
<pre>
-----BEGIN PUBLIC KEY-----
MHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEwxeYsMeIX6NSj7+HfltMOm3GelpdxrMH
tyjDclkm8qvl+0lkzZHjlIpUk/brtsu/j2x+x2FpHK03TE2qk4dFPxgFjs5Y6wqO
hKBVox+3+SFLJ1CVIsFZ52T4cR4RYJVU
-----END PUBLIC KEY-----
</pre><a href="#appendix-C.2-18" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-19">Issuer private key in PEM format<a href="#appendix-C.2-19" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-20">
<pre>
-----BEGIN PRIVATE KEY-----
MIG2AgEAMBAGByqGSM49AgEGBSuBBAAiBIGeMIGbAgEBBDBxxU0iIZN+phLbEiHw
0933cck4HE475B1aoKidaF8Jz+90xLvxBHg/1X6HqyJ9B0yhZANiAATDF5iwx4hf
o1KPv4d+W0w6bcZ6Wl3Gswe3KMNyWSbyq+X7SWTNkeOUilST9uu2y7+PbH7HYWkc
rTdMTaqTh0U/GAWOzljrCo6EoFWjH7f5IUsnUJUiwVnnZPhxHhFglVQ=
-----END PRIVATE KEY-----
</pre><a href="#appendix-C.2-20" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="implementation-status">
<section id="appendix-D">
      <h2 id="name-implementation-status">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="appendix-D-1">Note to the RFC Editor: Please remove this section as well as references to <span>[<a href="#BCP205" class="cite xref">BCP205</a>]</span> before AUTH48.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">This section records the status of known implementations of the protocol defined by this specification at the time of posting of this Internet-Draft, and is based on a proposal described in <span>[<a href="#BCP205" class="cite xref">BCP205</a>]</span>.
The description of implementations in this section is intended to assist the IETF in its decision processes in progressing drafts to RFCs.
Please note that the listing of any individual implementation here does not imply endorsement by the IETF.
Furthermore, no effort has been made to verify the information presented here that was supplied by IETF contributors.
This is not intended as, and must not be construed to be, a catalog of available implementations or their features.
Readers are advised to note that other implementations may exist.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">According to <span>[<a href="#BCP205" class="cite xref">BCP205</a>]</span>, "This will allow reviewers and working groups to assign due consideration to documents that have the benefit of running code, which may serve as evidence of valuable experimentation and feedback that have made the implemented protocols more mature.
It is up to the individual working groups to use this information as they see fit".<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<div id="transmute-prototype">
<section id="appendix-D.1">
        <h3 id="name-transmute-prototype">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-transmute-prototype" class="section-name selfRef">Transmute Prototype</a>
        </h3>
<p id="appendix-D.1-1">Organization: Transmute Industries Inc<a href="#appendix-D.1-1" class="pilcrow">¶</a></p>
<p id="appendix-D.1-2">Name: <a href="https://github.com/transmute-industries/sd-cwt">github.com/transmute-industries/sd-cwt</a><a href="#appendix-D.1-2" class="pilcrow">¶</a></p>
<p id="appendix-D.1-3">Description: An open-source implementation of this specification.<a href="#appendix-D.1-3" class="pilcrow">¶</a></p>
<p id="appendix-D.1-4">Maturity: Prototype<a href="#appendix-D.1-4" class="pilcrow">¶</a></p>
<p id="appendix-D.1-5">Coverage: The current version ('main') implements functionality similar to that described in this specification, and will be revised, with breaking changes to support the generation of example data to support this specification.<a href="#appendix-D.1-5" class="pilcrow">¶</a></p>
<p id="appendix-D.1-6">License: Apache-2.0<a href="#appendix-D.1-6" class="pilcrow">¶</a></p>
<p id="appendix-D.1-7">Implementation Experience: No interop testing has been done yet. The code works as a proof of concept, but is not yet production ready.<a href="#appendix-D.1-7" class="pilcrow">¶</a></p>
<p id="appendix-D.1-8">Contact: Orie Steele (orie@transmute.industries)<a href="#appendix-D.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rust-prototype">
<section id="appendix-D.2">
        <h3 id="name-rust-prototype">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-rust-prototype" class="section-name selfRef">Rust Prototype</a>
        </h3>
<p id="appendix-D.2-1">Organization: SimpleLogin<a href="#appendix-D.2-1" class="pilcrow">¶</a></p>
<p id="appendix-D.2-2">Name: <a href="https://github.com/beltram/esdicawt">github.com/beltram/esdicawt</a><a href="#appendix-D.2-2" class="pilcrow">¶</a></p>
<p id="appendix-D.2-3">Description: An open-source Rust implementation of this specification in Rust.<a href="#appendix-D.2-3" class="pilcrow">¶</a></p>
<p id="appendix-D.2-4">Maturity: Prototype<a href="#appendix-D.2-4" class="pilcrow">¶</a></p>
<p id="appendix-D.2-5">Coverage: The current version is close to the spec with the exception of <code>redacted_claim_keys</code> using a CBOR SimpleValue as label instead of a tagged key. Not all of the verifications have been implemented yet.<a href="#appendix-D.2-5" class="pilcrow">¶</a></p>
<p id="appendix-D.2-6">License: Apache-2.0<a href="#appendix-D.2-6" class="pilcrow">¶</a></p>
<p id="appendix-D.2-7">Implementation Experience: No interop testing has been done yet. The code works as a proof of concept, but is not yet production ready.<a href="#appendix-D.2-7" class="pilcrow">¶</a></p>
<p id="appendix-D.2-8">Contact: Beltram Maldant (beltram.ietf.spice@pm.me)<a href="#appendix-D.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="document-history">
<section id="appendix-E">
      <h2 id="name-document-history">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-E-1">Note: RFC Editor, please remove this entire section on publication.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<div id="draft-ietf-spice-sd-cwt-04">
<section id="appendix-E.1">
        <h3 id="name-draft-ietf-spice-sd-cwt-04">
<a href="#appendix-E.1" class="section-number selfRef">E.1. </a><a href="#name-draft-ietf-spice-sd-cwt-04" class="section-name selfRef">draft-ietf-spice-sd-cwt-04</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-E.1-1.1">
            <p id="appendix-E.1-1.1.1">use CBOR simple value 59 for the redacted_key_claims<a href="#appendix-E.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.1-1.2">
            <p id="appendix-E.1-1.2.1">add description of decoy digests <strong>TODO</strong><a href="#appendix-E.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.1-1.3">
            <p id="appendix-E.1-1.3.1">provide test vectors <strong>TODO</strong><a href="#appendix-E.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.1-1.4">
            <p id="appendix-E.1-1.4.1">add AEAD and COSE encrypted disclosures<a href="#appendix-E.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.1-1.5">
            <p id="appendix-E.1-1.5.1">Applied clarifications and corrections suggested by Mike Jones.<a href="#appendix-E.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.1-1.6">
            <p id="appendix-E.1-1.6.1">Created Verifiable Credential Type Identifiers registry.<a href="#appendix-E.1-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-spice-sd-cwt-03">
<section id="appendix-E.2">
        <h3 id="name-draft-ietf-spice-sd-cwt-03">
<a href="#appendix-E.2" class="section-number selfRef">E.2. </a><a href="#name-draft-ietf-spice-sd-cwt-03" class="section-name selfRef">draft-ietf-spice-sd-cwt-03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-E.2-1.1">
            <p id="appendix-E.2-1.1.1">remove bstr encoding from sd_claims array (but not the individual disclosures)<a href="#appendix-E.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-1.2">
            <p id="appendix-E.2-1.2.1">clarify which claims are optional/mandatory<a href="#appendix-E.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-1.3">
            <p id="appendix-E.2-1.3.1">correct that an SD-CWT may have zero redacted claims<a href="#appendix-E.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-1.4">
            <p id="appendix-E.2-1.4.1">improve the walkthrough of computing a disclosure<a href="#appendix-E.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-1.5">
            <p id="appendix-E.2-1.5.1">clarify that duplicate map keys are not allowed, and how tagged keys are represented.<a href="#appendix-E.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-1.6">
            <p id="appendix-E.2-1.6.1">added security considerations section (#42) and text about privacy and linkability risks (#43)<a href="#appendix-E.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-1.7">
            <p id="appendix-E.2-1.7.1">register SD-CWT and SD-KBT as content formats in CoAP registry (#39)<a href="#appendix-E.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-1.8">
            <p id="appendix-E.2-1.8.1">updated media types registrations to have more useful contacts (#44)<a href="#appendix-E.2-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-1.9">
            <p id="appendix-E.2-1.9.1">build most of the values (signatures/salts/hashes/dates) in the examples automatically using a script that implements SD-CWT<a href="#appendix-E.2-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-1.10">
            <p id="appendix-E.2-1.10.1">regenerate all examples with correct signatures<a href="#appendix-E.2-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-1.11">
            <p id="appendix-E.2-1.11.1">add nested example<a href="#appendix-E.2-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.2-1.12">
            <p id="appendix-E.2-1.12.1">add optional encrypted disclosures<a href="#appendix-E.2-1.12.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-spice-sd-cwt-02">
<section id="appendix-E.3">
        <h3 id="name-draft-ietf-spice-sd-cwt-02">
<a href="#appendix-E.3" class="section-number selfRef">E.3. </a><a href="#name-draft-ietf-spice-sd-cwt-02" class="section-name selfRef">draft-ietf-spice-sd-cwt-02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-E.3-1.1">
            <p id="appendix-E.3-1.1.1">KBT now includes the entire SD-CWT in the Confirmation Key CWT (<code>kcwt</code>) existing COSE protected header. Has algorithm now specified in new <code>sd_alg</code> COSE protected header. No more <code>sd_hash</code> claim. (PR #34, 32)<a href="#appendix-E.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.3-1.2">
            <p id="appendix-E.3-1.2.1">Introduced tags for redacted and to-be-redacted claim keys and elements. (PR#31, 28)<a href="#appendix-E.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.3-1.3">
            <p id="appendix-E.3-1.3.1">Updated example to be a generic inspection certificate. (PR#33)<a href="#appendix-E.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.3-1.4">
            <p id="appendix-E.3-1.4.1">Add section saying SD-CWT updates the CWT spec (RFC8392). (PR#29)<a href="#appendix-E.3-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-spice-sd-cwt-01">
<section id="appendix-E.4">
        <h3 id="name-draft-ietf-spice-sd-cwt-01">
<a href="#appendix-E.4" class="section-number selfRef">E.4. </a><a href="#name-draft-ietf-spice-sd-cwt-01" class="section-name selfRef">draft-ietf-spice-sd-cwt-01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-E.4-1.1">
            <p id="appendix-E.4-1.1.1">Added Overview section<a href="#appendix-E.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.4-1.2">
            <p id="appendix-E.4-1.2.1">Rewrote the main normative section<a href="#appendix-E.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.4-1.3">
            <p id="appendix-E.4-1.3.1">Made redacted_claim_keys use an unlikely to collide claim key integer<a href="#appendix-E.4-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.4-1.4">
            <p id="appendix-E.4-1.4.1">Make cnonce optional (it now says <span class="bcp14">SHOULD</span>)<a href="#appendix-E.4-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.4-1.5">
            <p id="appendix-E.4-1.5.1">Made most standard claims optional.<a href="#appendix-E.4-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.4-1.6">
            <p id="appendix-E.4-1.6.1">Consistently avoid use of bare term "key" - to make crypto keys and map keys clear<a href="#appendix-E.4-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.4-1.7">
            <p id="appendix-E.4-1.7.1">Make clear issued SD-CWT can contain zero or more redactions; presented SD-CWT can disclose zero, some, or all redacted claims.<a href="#appendix-E.4-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.4-1.8">
            <p id="appendix-E.4-1.8.1">Clarified use of sd_hash for issuer to holder case._<a href="#appendix-E.4-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.4-1.9">
            <p id="appendix-E.4-1.9.1">Lots of editorial cleanup<a href="#appendix-E.4-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.4-1.10">
            <p id="appendix-E.4-1.10.1">Added Rohan as an author and Brian Campbell to Acknowledgements<a href="#appendix-E.4-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.4-1.11">
            <p id="appendix-E.4-1.11.1">Updated implementation status section to be BCP205-compatible<a href="#appendix-E.4-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-E.4-1.12">
            <p id="appendix-E.4-1.12.1">Updated draft metadata<a href="#appendix-E.4-1.12.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-ietf-spice-sd-cwt-00">
<section id="appendix-E.5">
        <h3 id="name-draft-ietf-spice-sd-cwt-00">
<a href="#appendix-E.5" class="section-number selfRef">E.5. </a><a href="#name-draft-ietf-spice-sd-cwt-00" class="section-name selfRef">draft-ietf-spice-sd-cwt-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-E.5-1.1">
            <p id="appendix-E.5-1.1.1">Initial working group version based on draft-prorock-spice-cose-sd-cwt-01.<a href="#appendix-E.5-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-F">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-F-1">The authors would like to thank those that have worked on similar items for
providing selective disclosure mechanisms in JSON, especially:
Brent Zundel, Roy Williams, Tobias Looker, Kristina Yasuda, Daniel Fett,
Brian Campbell, Oliver Terbu, and Michael B. Jones.<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<p id="appendix-F-2">The authors would like to thank the following individuals for their contributions to this specification:
Michael B. Jones.<a href="#appendix-F-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-G">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Prorock</span></div>
<div dir="auto" class="left"><span class="org">mesur.io</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mprorock@mesur.io" class="email">mprorock@mesur.io</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Orie Steele</span></div>
<div dir="auto" class="left"><span class="org">Transmute</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:orie@transmute.industries" class="email">orie@transmute.industries</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div dir="auto" class="left"><span class="street-address">Rheinstrasse 75</span></div>
<div dir="auto" class="left">
<span class="postal-code">64295</span> <span class="locality">Darmstadt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@ietf.contact" class="email">henk.birkholz@ietf.contact</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rohan Mahy</span></div>
<div dir="auto" class="left"><span class="org">Rohan Mahy Consulting Services</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rohan.ietf@gmail.com" class="email">rohan.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
